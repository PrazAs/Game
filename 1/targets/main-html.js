/** Cooked with Flambe, https://getflambe.com */
'use strict';(function(){function o(a,b){function c(){}c.prototype=a;var d=new c,f;for(f in b)d[f]=b[f];b.toString!==Object.prototype.toString&&(d.toString=b.toString);return d}function Wb(a){return a instanceof Array?function(){return y.iter(a)}:"function"==typeof a.iterator?w(a,a.iterator):a.iterator}function w(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=$b++);var c;null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__];null==c&&(c=function(){return c.method.apply(c.scope,
arguments)},c.scope=a,c.method=b,a.hx__closures__[b.__id__]=c);return c}var e={},m=function(){return E.__string_rec(this,"")},$=function(a,b){b=b.split("u").join("");this.r=RegExp(a,b)};e.EReg=$;$.__name__=!0;$.prototype={match:function(a){this.r.global&&(this.r.lastIndex=0);this.r.m=this.r.exec(a);this.r.s=a;return null!=this.r.m},matched:function(a){if(null!=this.r.m&&0<=a&&a<this.r.m.length)return this.r.m[a];throw"EReg::matched";},matchedPos:function(){if(null==this.r.m)throw"No string matched";
return{pos:this.r.m.index,len:this.r.m[0].length}},__class__:$};var y=function(){};e.HxOverrides=y;y.__name__=!0;y.cca=function(a,b){var c=a.charCodeAt(b);return c!=c?void 0:c};y.substr=function(a,b,c){if(null!=b&&0!=b&&null!=c&&0>c)return"";null==c&&(c=a.length);0>b?(b=a.length+b,0>b&&(b=0)):0>c&&(c=a.length+c-b);return a.substr(b,c)};y.remove=function(a,b){var c=a.indexOf(b);if(-1==c)return!1;a.splice(c,1);return!0};y.iter=function(a){return{cur:0,arr:a,hasNext:function(){return this.cur<this.arr.length},
next:function(){return this.arr[this.cur++]}}};var Ga=function(){};e.Lambda=Ga;Ga.__name__=!0;Ga.array=function(a){for(var b=[],a=Wb(a)();a.hasNext();){var c=a.next();b.push(c)}return b};Ga.count=function(a,b){var c=0;if(null==b)for(var d=Wb(a)();d.hasNext();)d.next(),c++;else for(d=Wb(a)();d.hasNext();){var f=d.next();b(f)&&c++}return c};var Kb=function(){};e.IMap=Kb;Kb.__name__=!0;Math.__name__=!0;var ta=function(){};e.Reflect=ta;ta.__name__=!0;ta.field=function(a,b){try{return a[b]}catch(c){return null}};
var z=function(){};e.Std=z;z.__name__=!0;z.is=function(a,b){return E.__instanceof(a,b)};z.instance=function(a,b){return a instanceof b?a:null};z.string=function(a){return E.__string_rec(a,"")};z["int"]=function(a){return a|0};z.parseInt=function(a){var b=parseInt(a,10);if(0==b&&(120==y.cca(a,1)||88==y.cca(a,1)))b=parseInt(a);return isNaN(b)?null:b};var mb=function(){};e.StringTools=mb;mb.__name__=!0;mb.startsWith=function(a,b){return a.length>=b.length&&y.substr(a,0,b.length)==b};var Ha=function(){};
e.Type=Ha;Ha.__name__=!0;Ha.getClass=function(a){return null==a?null:a instanceof Array&&null==a.__enum__?Array:a.__class__};Ha.resolveClass=function(a){a=e[a];return null==a||!a.__name__?null:a};Ha.resolveEnum=function(a){a=e[a];return null==a||!a.__ename__?null:a};var Y=function(){};e["flambe.util.Disposable"]=Y;Y.__name__=!0;Y.prototype={__class__:Y};var r=function(){this._flags=0;this.owner=this.next=null};e["flambe.Component"]=r;r.__name__=!0;r.__interfaces__=[Y];r.prototype={onAdded:function(){},
onRemoved:function(){},onStart:function(){},onStop:function(){},onUpdate:function(){},dispose:function(){null!=this.owner&&this.owner.remove(this)},get_name:function(){return null},__class__:r};var n=function(){this.parent=this.firstChild=this.next=this.firstComponent=null;this._compMap={}};e["flambe.Entity"]=n;n.__name__=!0;n.__interfaces__=[Y];n.prototype={add:function(a){null!=a.owner&&a.owner.remove(a);var b=a.get_name(),c=this._compMap[b];null!=c&&this.remove(c);this._compMap[b]=a;b=null;for(c=
this.firstComponent;null!=c;)b=c,c=c.next;null!=b?b.next=a:this.firstComponent=a;a.owner=this;a.next=null;a.onAdded();return this},remove:function(a){for(var b=null,c=this.firstComponent;null!=c;){var d=c.next;if(c==a)return null==b?this.firstComponent=d:(b.owner=this,b.next=d),delete this._compMap[c.get_name()],0!=(c._flags&1)&&(c.onStop(),c._flags&=-2),c.onRemoved(),c.owner=null,c.next=null,!0;b=c;c=d}return!1},addChild:function(a,b){null==b&&(b=!0);null!=a.parent&&a.parent.removeChild(a);a.parent=
this;if(b){for(var c=null,d=this.firstChild;null!=d;)c=d,d=d.next;null!=c?c.next=a:this.firstChild=a}else a.next=this.firstChild,this.firstChild=a;return this},removeChild:function(a){for(var b=null,c=this.firstChild;null!=c;){var d=c.next;if(c==a){null==b?this.firstChild=d:b.next=d;c.parent=null;c.next=null;break}b=c;c=d}},disposeChildren:function(){for(;null!=this.firstChild;)this.firstChild.dispose()},dispose:function(){for(null!=this.parent&&this.parent.removeChild(this);null!=this.firstComponent;)this.firstComponent.dispose();
this.disposeChildren()},__class__:n};var Lb=function(){};e["flambe.util.PackageLog"]=Lb;Lb.__name__=!0;var nb=function(){};e["flambe.platform.Platform"]=nb;nb.__name__=!0;nb.prototype={__class__:nb};var aa=function(){};e["flambe.platform.html.HtmlPlatform"]=aa;aa.__name__=!0;aa.__interfaces__=[nb];aa.prototype={init:function(){var a=this;k.fixAndroidMath();var b=null;try{b=window.flambe.canvas}catch(c){}b.setAttribute("tabindex","0");b.style.outlineStyle="none";b.style.webkitTapHighlightColor="transparent";
b.setAttribute("moz-opaque","true");this._stage=new ia(b);this._pointer=new F;this._mouse=new Ia(this._pointer,b);this._renderer=this.createRenderer(b);this.mainLoop=new ja;this.musicPlaying=!1;this._canvas=b;this._container=b.parentElement;this._container.style.overflow="hidden";this._container.style.position="relative";this._container.style.msTouchAction="none";var d=0,f=function(c){if(!(1E3>c.timeStamp-d)){var f=b.getBoundingClientRect(),h=a.getX(c,f),f=a.getY(c,f);switch(c.type){case "mousedown":c.target==
b&&(c.preventDefault(),a._mouse.submitDown(h,f,c.button),b.focus());break;case "mousemove":a._mouse.submitMove(h,f);break;case "mouseup":a._mouse.submitUp(h,f,c.button);break;case "mousewheel":case "DOMMouseScroll":a._mouse.submitScroll(h,f,"mousewheel"==c.type?c.wheelDelta/40:-c.detail)&&c.preventDefault()}}};window.addEventListener("mousedown",f,!1);window.addEventListener("mousemove",f,!1);window.addEventListener("mouseup",f,!1);b.addEventListener("mousewheel",f,!1);b.addEventListener("DOMMouseScroll",
f,!1);b.addEventListener("contextmenu",function(a){a.preventDefault()},!1);var h="undefined"!=typeof window.ontouchstart,f="msMaxTouchPoints"in window.navigator&&1<window.navigator.msMaxTouchPoints;if(h||f){var Mb=new Ja(this._pointer,h?4:window.navigator.msMaxTouchPoints);this._touch=Mb;f=function(b){var c;c=h?b.changedTouches:[b];var f=b.target.getBoundingClientRect();d=b.timeStamp;switch(b.type){case "touchstart":case "MSPointerDown":case "pointerdown":b.preventDefault();k.SHOULD_HIDE_MOBILE_BROWSER&&
k.hideMobileBrowser();for(b=0;b<c.length;){var e=c[b];++b;var G=a.getX(e,f),g=a.getY(e,f);Mb.submitDown((h?e.identifier:e.pointerId)|0,G,g)}break;case "touchmove":case "MSPointerMove":case "pointermove":b.preventDefault();for(b=0;b<c.length;)e=c[b],++b,G=a.getX(e,f),g=a.getY(e,f),Mb.submitMove((h?e.identifier:e.pointerId)|0,G,g);break;case "touchend":case "touchcancel":case "MSPointerUp":case "pointerup":for(b=0;b<c.length;)e=c[b],++b,G=a.getX(e,f),g=a.getY(e,f),Mb.submitUp((h?e.identifier:e.pointerId)|
0,G,g)}};h?(b.addEventListener("touchstart",f,!1),b.addEventListener("touchmove",f,!1),b.addEventListener("touchend",f,!1),b.addEventListener("touchcancel",f,!1)):(b.addEventListener("MSPointerDown",f,!1),b.addEventListener("MSPointerMove",f,!1),b.addEventListener("MSPointerUp",f,!1))}else this._touch=new Ka;var e=window.onerror;window.onerror=function(a,b,c){i.uncaughtError.emit(a);return null!=e?e(a,b,c):!1};var La=k.loadExtension("hidden",window.document);null!=La.value?(f=function(){i.hidden.set__(ta.field(window.document,
La.field))},f(null),window.document.addEventListener(La.prefix+"visibilitychange",f,!1)):(f=function(a){i.hidden.set__("pagehide"==a.type)},window.addEventListener("pageshow",f,!1),window.addEventListener("pagehide",f,!1));i.hidden.get_changed().connect(function(b){b||(a._skipFrame=!0)});this._skipFrame=!1;this._lastUpdate=Date.now();var g=k.loadExtension("requestAnimationFrame").value;if(null!=g){var j=window.performance,l=null!=j&&k.polyfill("now",j);l?this._lastUpdate=j.now():null;var m=null,m=
function(c){a.update(l?j.now():c);g(m,b)};g(m,b)}else window.setInterval(function(){a.update(Date.now())},16);ua.info("Initialized HTML platform",["renderer",this._renderer.get_type()])},loadAssetPack:function(a){return(new p(this,a)).promise},getStage:function(){return this._stage},update:function(a){var b=(a-this._lastUpdate)/1E3;this._lastUpdate=a;i.hidden._value||(this._skipFrame?this._skipFrame=!1:(this.mainLoop.update(b),this.mainLoop.render(this._renderer)))},getPointer:function(){return this._pointer},
getRenderer:function(){return this._renderer},getX:function(a,b){return(a.clientX-b.left)*this._stage.get_width()/b.width},getY:function(a,b){return(a.clientY-b.top)*this._stage.get_height()/b.height},createRenderer:function(a){try{var b=Nb.getContextWebGL(a,{alpha:!1,depth:!1,failIfMajorPerformanceCaveat:!0});if(null!=b)if(k.detectSlowDriver(b))null;else return new Ma(this._stage,b)}catch(c){}return new ka(a)},__class__:aa};var H=function(a,b){this._value=a;this._changed=null!=b?new va(b):null};
e["flambe.util.Value"]=H;H.__name__=!0;H.prototype={watch:function(a){a(this._value,this._value);return this.get_changed().connect(a)},set__:function(a){var b=this._value;a!=b&&(this._value=a,null!=this._changed&&this._changed.emit(a,b));return a},get_changed:function(){null==this._changed&&(this._changed=new va);return this._changed},__class__:H};var la=function(a,b){this._next=null;this._signal=a;this._listener=b;this.stayInList=!0};e["flambe.util.SignalConnection"]=la;la.__name__=!0;la.__interfaces__=
[Y];la.prototype={once:function(){this.stayInList=!1;return this},dispose:function(){null!=this._signal&&(this._signal.disconnect(this),this._signal=null)},__class__:la};var A=function(a){this._head=null!=a?new la(this,a):null;this._deferredTasks=null};e["flambe.util.SignalBase"]=A;A.__name__=!0;A.prototype={connectImpl:function(a,b){var c=this,d=new la(this,a);this._head==A.DISPATCHING_SENTINEL?this.defer(function(){c.listAdd(d,b)}):this.listAdd(d,b);return d},disconnect:function(a){var b=this;this._head==
A.DISPATCHING_SENTINEL?this.defer(function(){b.listRemove(a)}):this.listRemove(a)},defer:function(a){for(var b=null,c=this._deferredTasks;null!=c;)b=c,c=c.next;a=new ob(a);null!=b?b.next=a:this._deferredTasks=a},willEmit:function(){var a=this._head;this._head=A.DISPATCHING_SENTINEL;return a},didEmit:function(a){this._head=a;a=this._deferredTasks;for(this._deferredTasks=null;null!=a;)a.fn(),a=a.next},listAdd:function(a,b){if(b)a._next=this._head,this._head=a;else{for(var c=null,d=this._head;null!=
d;)c=d,d=d._next;null!=c?c._next=a:this._head=a}},listRemove:function(a){for(var b=null,c=this._head;null!=c;){if(c==a){a=c._next;null==b?this._head=a:b._next=a;break}b=c;c=c._next}},__class__:A};var va=function(a){A.call(this,a)};e["flambe.util.Signal2"]=va;va.__name__=!0;va.__super__=A;va.prototype=o(A.prototype,{connect:function(a,b){null==b&&(b=!1);return this.connectImpl(a,b)},emit:function(a,b){var c=this;this._head==A.DISPATCHING_SENTINEL?this.defer(function(){c.emitImpl(a,b)}):this.emitImpl(a,
b)},emitImpl:function(a,b){for(var c=this.willEmit(),d=c;null!=d;)d._listener(a,b),d.stayInList||d.dispose(),d=d._next;this.didEmit(c)},__class__:va});var t=function(a){A.call(this,a)};e["flambe.util.Signal1"]=t;t.__name__=!0;t.__super__=A;t.prototype=o(A.prototype,{connect:function(a,b){null==b&&(b=!1);return this.connectImpl(a,b)},emit:function(a){var b=this;this._head==A.DISPATCHING_SENTINEL?this.defer(function(){b.emitImpl(a)}):this.emitImpl(a)},emitImpl:function(a){for(var b=this.willEmit(),
c=b;null!=c;)c._listener(a),c.stayInList||c.dispose(),c=c._next;this.didEmit(b)},__class__:t});var v=function(a,b){this._behavior=null;H.call(this,a,b)};e["flambe.animation.AnimatedFloat"]=v;v.__name__=!0;v.__super__=H;v.prototype=o(H.prototype,{set__:function(a){this._behavior=null;return H.prototype.set__.call(this,a)},update:function(a){null!=this._behavior&&(H.prototype.set__.call(this,this._behavior.update(a)),this._behavior.isComplete()&&(this._behavior=null))},__class__:v});var i=function(){};
e["flambe.System"]=i;i.__name__=!0;i.init=function(){i._calledInit||(i._platform.init(),i._calledInit=!0)};var ua=function(){};e["flambe.Log"]=ua;ua.__name__=!0;ua.info=function(){null};ua.__super__=Lb;ua.prototype=o(Lb.prototype,{__class__:ua});var pb=function(){this._realDt=0};e["flambe.SpeedAdjuster"]=pb;pb.__name__=!0;pb.__super__=r;pb.prototype=o(r.prototype,{get_name:function(){return"SpeedAdjuster_8"},onUpdate:function(a){0<this._realDt&&(a=this._realDt,this._realDt=0);this.scale.update(a)},
__class__:pb});var Ob=function(){};e["flambe.animation.Behavior"]=Ob;Ob.__name__=!0;Ob.prototype={__class__:Ob};var da=function(){};e["flambe.asset.Asset"]=da;da.__name__=!0;da.__interfaces__=[Y];da.prototype={__class__:da};var g=e["flambe.asset.AssetFormat"]={__ename__:!0,__constructs__:"WEBP,JXR,PNG,JPG,GIF,DDS,PVR,PKM,MP3,M4A,OPUS,OGG,WAV,Data".split(",")};g.WEBP=["WEBP",0];g.WEBP.toString=m;g.WEBP.__enum__=g;g.JXR=["JXR",1];g.JXR.toString=m;g.JXR.__enum__=g;g.PNG=["PNG",2];g.PNG.toString=m;g.PNG.__enum__=
g;g.JPG=["JPG",3];g.JPG.toString=m;g.JPG.__enum__=g;g.GIF=["GIF",4];g.GIF.toString=m;g.GIF.__enum__=g;g.DDS=["DDS",5];g.DDS.toString=m;g.DDS.__enum__=g;g.PVR=["PVR",6];g.PVR.toString=m;g.PVR.__enum__=g;g.PKM=["PKM",7];g.PKM.toString=m;g.PKM.__enum__=g;g.MP3=["MP3",8];g.MP3.toString=m;g.MP3.__enum__=g;g.M4A=["M4A",9];g.M4A.toString=m;g.M4A.__enum__=g;g.OPUS=["OPUS",10];g.OPUS.toString=m;g.OPUS.__enum__=g;g.OGG=["OGG",11];g.OGG.toString=m;g.OGG.__enum__=g;g.WAV=["WAV",12];g.WAV.toString=m;g.WAV.__enum__=
g;g.Data=["Data",13];g.Data.toString=m;g.Data.__enum__=g;var qb=function(a,b,c,d){this.name=a;this.url=b;this.format=c;this.bytes=d};e["flambe.asset.AssetEntry"]=qb;qb.__name__=!0;qb.prototype={__class__:qb};var Na=function(){};e["flambe.asset.AssetPack"]=Na;Na.__name__=!0;Na.__interfaces__=[Y];Na.prototype={__class__:Na};var Oa=function(){};e["flambe.asset.File"]=Oa;Oa.__name__=!0;Oa.__interfaces__=[da];Oa.prototype={__class__:Oa};var N=function(){this._localBase=this._remoteBase=null;this._entries=
[]};e["flambe.asset.Manifest"]=N;N.__name__=!0;N.fromAssets=function(a,b){null==b&&(b=!0);var c=ta.field(Pb.getType(N).assets[0],a);if(null==c){if(b)throw B.withFields("Missing asset pack",["name",a]);return null}var d=new N;d.set_localBase("assets");for(var f=0;f<c.length;){var h=c[f];++f;var e=h.name,G=a+"/"+e+"?v="+z.string(h.md5),La=N.inferFormat(e);La!=g.Data&&(e=B.removeFileExtension(e));d.add(e,G,h.bytes,La)}return d};N.inferFormat=function(a){a=B.getUrlExtension(a);if(null!=a)switch(a.toLowerCase()){case "gif":return g.GIF;
case "jpg":case "jpeg":return g.JPG;case "jxr":case "wdp":return g.JXR;case "png":return g.PNG;case "webp":return g.WEBP;case "dds":return g.DDS;case "pvr":return g.PVR;case "pkm":return g.PKM;case "m4a":return g.M4A;case "mp3":return g.MP3;case "ogg":return g.OGG;case "opus":return g.OPUS;case "wav":return g.WAV}else null;return g.Data};N.prototype={add:function(a,b,c,d){null==c&&(c=0);null==d&&(d=N.inferFormat(b));a=new qb(a,b,d,c);this._entries.push(a);return a},iterator:function(){return y.iter(this._entries)},
getFullURL:function(a){var b;b=null!=this.get_remoteBase()&&N._supportsCrossOrigin?this.get_remoteBase():this.get_localBase();return null!=b?B.joinPath(b,a.url):a.url},get_localBase:function(){return this._localBase},set_localBase:function(a){null!=a&&Qb.that(!mb.startsWith(a,"http://")&&!mb.startsWith(a,"https://"),"localBase must be a path on the same domain, NOT starting with http(s)://",null);return this._localBase=a},get_remoteBase:function(){return this._remoteBase},__class__:N};var u=e["flambe.display.BlendMode"]=
{__ename__:!0,__constructs__:"Normal,Add,Multiply,Screen,Mask,Copy".split(",")};u.Normal=["Normal",0];u.Normal.toString=m;u.Normal.__enum__=u;u.Add=["Add",1];u.Add.toString=m;u.Add.__enum__=u;u.Multiply=["Multiply",2];u.Multiply.toString=m;u.Multiply.__enum__=u;u.Screen=["Screen",3];u.Screen.toString=m;u.Screen.__enum__=u;u.Mask=["Mask",4];u.Mask.toString=m;u.Mask.__enum__=u;u.Copy=["Copy",5];u.Copy.toString=m;u.Copy.__enum__=u;var Pa=function(a,b){null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b};
e["flambe.math.Point"]=Pa;Pa.__name__=!0;Pa.prototype={__class__:Pa};var j=function(){this.blendMode=this.scissor=null;var a=this;r.call(this);this._flags|=54;this._localMatrix=new T;var b=function(){a._flags|=24};this.x=new v(0,b);this.y=new v(0,b);this.rotation=new v(0,b);this.scaleX=new v(1,b);this.scaleY=new v(1,b);this.anchorX=new v(0,b);this.anchorY=new v(0,b);this.alpha=new v(1)};e["flambe.display.Sprite"]=j;j.__name__=!0;j.hitTest=function(a,b,c){var d=a._compMap.Sprite_4;if(null!=d){if(6!=
(d._flags&6))return null;d.getLocalMatrix().inverseTransform(b,c,j._scratchPoint)&&(b=j._scratchPoint.x,c=j._scratchPoint.y);var f=d.scissor;if(null!=f&&!f.contains(b,c))return null}a=j.hitTestBackwards(a.firstChild,b,c);return null!=a?a:null!=d&&d.containsLocal(b,c)?d:null};j.getBounds=function(a,b){null==b&&(b=new ma);b.set(1.79769313486231E308,1.79769313486231E308,-1.79769313486231E308,-1.79769313486231E308);j.getBoundsImpl(a,null,b);b.width-=b.x;b.height-=b.y;return b};j.render=function(a,b){var c=
a._compMap.Sprite_4;if(null!=c){var d=c.alpha._value;if(0==(c._flags&2)||0>=d)return;b.save();1>d&&b.multiplyAlpha(d);null!=c.blendMode&&b.setBlendMode(c.blendMode);var d=c.getLocalMatrix(),f=d.m02,h=d.m12;0!=(c._flags&32)&&(f=Math.round(f),h=Math.round(h));b.transform(d.m00,d.m10,d.m01,d.m11,f,h);d=c.scissor;null!=d&&b.applyScissor(d.x,d.y,d.width,d.height);c.draw(b)}d=a._compMap.Director_7;if(null!=d){d=d.occludedScenes;for(f=0;f<d.length;)h=d[f],++f,j.render(h,b)}for(d=a.firstChild;null!=d;)f=
d.next,j.render(d,b),d=f;null!=c&&b.restore()};j.hitTestBackwards=function(a,b,c){if(null!=a){var d=j.hitTestBackwards(a.next,b,c);return null!=d?d:j.hitTest(a,b,c)}return null};j.getBoundsImpl=function(a,b,c){var d=a._compMap.Sprite_4;if(null!=d){var b=null!=b?T.multiply(b,d.getLocalMatrix()):d.getLocalMatrix(),f=d.getNaturalWidth(),d=d.getNaturalHeight();0<f&&0<d&&(j.extendRect(b,0,0,c),j.extendRect(b,f,0,c),j.extendRect(b,f,d,c),j.extendRect(b,0,d,c))}f=a._compMap.Director_7;if(null!=f)for(var f=
f.occludedScenes,d=0,h=f.length;d<h;)j.getBoundsImpl(f[d],b,c),++d;for(a=a.firstChild;null!=a;)f=a.next,j.getBoundsImpl(a,b,c),a=f};j.extendRect=function(a,b,c,d){a=a.transform(b,c,j._scratchPoint);b=a.x;c=a.y;b<d.x&&(d.x=b);c<d.y&&(d.y=c);b>d.width&&(d.width=b);c>d.height&&(d.height=c)};j.__super__=r;j.prototype=o(r.prototype,{get_name:function(){return"Sprite_4"},getNaturalWidth:function(){return 0},getNaturalHeight:function(){return 0},containsLocal:function(a,b){return 0<=a&&a<this.getNaturalWidth()&&
0<=b&&b<this.getNaturalHeight()},getLocalMatrix:function(){0!=(this._flags&8)&&(this._flags&=-9,this._localMatrix.compose(this.x._value,this.y._value,this.scaleX._value,this.scaleY._value,3.141592653589793*this.rotation._value/180),this._localMatrix.translate(-this.anchorX._value,-this.anchorY._value));return this._localMatrix},setAnchor:function(a,b){this.anchorX.set__(a);this.anchorY.set__(b);return this},setXY:function(a,b){this.x.set__(a);this.y.set__(b);return this},onAdded:function(){0!=(this._flags&
64)&&this.connectHover()},onRemoved:function(){null!=this._hoverConnection&&(this._hoverConnection.dispose(),this._hoverConnection=null)},onUpdate:function(a){this.x.update(a);this.y.update(a);this.rotation.update(a);this.scaleX.update(a);this.scaleY.update(a);this.alpha.update(a);this.anchorX.update(a);this.anchorY.update(a)},draw:function(){},getParentSprite:function(){if(null==this.owner)return null;for(var a=this.owner.parent;null!=a;){var b=a._compMap.Sprite_4;if(null!=b)return b;a=a.parent}return null},
get_pointerDown:function(){null==this._pointerDown&&(this._pointerDown=new t);return this._pointerDown},get_pointerUp:function(){null==this._pointerUp&&(this._pointerUp=new t);return this._pointerUp},connectHover:function(){var a=this;null==this._hoverConnection&&(this._hoverConnection=i._platform.getPointer().move.connect(function(b){for(var c=b.hit;null!=c;){if(c==a)return;c=c.getParentSprite()}null!=a._pointerOut&&0!=(a._flags&64)&&a._pointerOut.emit(b);a._flags&=-65;a._hoverConnection.dispose();
a._hoverConnection=null}))},set_visible:function(a){this._flags=rb.set(this._flags,2,a);return a},onPointerDown:function(a){this.onHover(a);null!=this._pointerDown&&this._pointerDown.emit(a)},onPointerMove:function(a){this.onHover(a);null!=this._pointerMove&&this._pointerMove.emit(a)},onHover:function(a){if(0==(this._flags&64)&&(this._flags|=64,null!=this._pointerIn||null!=this._pointerOut))null!=this._pointerIn&&this._pointerIn.emit(a),this.connectHover()},onPointerUp:function(a){switch(a.source[1]){case 1:null!=
this._pointerOut&&0!=(this._flags&64)&&this._pointerOut.emit(a),this._flags&=-65,null!=this._hoverConnection&&(this._hoverConnection.dispose(),this._hoverConnection=null)}null!=this._pointerUp&&this._pointerUp.emit(a)},__class__:j});var wa=function(a,b,c){j.call(this);this.color=a;this.width=new v(b);this.height=new v(c)};e["flambe.display.FillSprite"]=wa;wa.__name__=!0;wa.__super__=j;wa.prototype=o(j.prototype,{draw:function(a){a.fillRect(this.color,0,0,this.width._value,this.height._value)},getNaturalWidth:function(){return this.width._value},
getNaturalHeight:function(){return this.height._value},onUpdate:function(a){j.prototype.onUpdate.call(this,a);this.width.update(a);this.height.update(a)},__class__:wa});var Qa=function(a){this._kernings=null;this.xOffset=this.yOffset=this.xAdvance=0;this.page=null;this.x=this.y=this.width=this.height=0;this.charCode=a};e["flambe.display.Glyph"]=Qa;Qa.__name__=!0;Qa.prototype={draw:function(a,b,c){0<this.width&&a.drawSubTexture(this.page,b+this.xOffset,c+this.yOffset,this.x,this.y,this.width,this.height)},
getKerning:function(a){return null!=this._kernings?z["int"](this._kernings.get(a)):0},setKerning:function(a,b){null==this._kernings&&(this._kernings=new Z);this._kernings.set(a,b)},__class__:Qa};var na=function(a,b){this.name=b;this._pack=a;this._file=a.getFile(b+".fnt");this.reload()};e["flambe.display.Font"]=na;na.__name__=!0;na.prototype={layoutText:function(a,b,c,d,f){null==f&&(f=0);null==d&&(d=0);null==c&&(c=0);null==b&&(b=I.Left);return new ea(this,a,b,c,d,f)},reload:function(){this._glyphs=
new Z;this._glyphs.set(na.NEWLINE.charCode,na.NEWLINE);for(var a=new oa(this._file.toString()),b=new Z,c=this.name.lastIndexOf("/"),c=0<=c?y.substr(this.name,0,c+1):"",d=a.keywords();d.hasNext();)switch(d.next()){case "info":for(var f=a.pairs();f.hasNext();){var h=f.next();switch(h.key){case "size":this.size=h.getInt()}}break;case "common":for(f=a.pairs();f.hasNext();)switch(h=f.next(),h.key){case "lineHeight":this.lineHeight=h.getInt()}break;case "page":for(var f=0,h=null,e=a.pairs();e.hasNext();){var G=
e.next();switch(G.key){case "id":f=G.getInt();break;case "file":h=G.getString()}}h=this._pack.getTexture(c+B.removeFileExtension(h));b.set(f,h);break;case "char":f=null;for(h=a.pairs();h.hasNext();)switch(e=h.next(),e.key){case "id":f=new Qa(e.getInt());break;case "x":f.x=e.getInt();break;case "y":f.y=e.getInt();break;case "width":f.width=e.getInt();break;case "height":f.height=e.getInt();break;case "page":e=e.getInt();f.page=b.get(e);break;case "xoffset":f.xOffset=e.getInt();break;case "yoffset":f.yOffset=
e.getInt();break;case "xadvance":f.xAdvance=e.getInt()}this._glyphs.set(f.charCode,f);break;case "kerning":f=null;e=h=0;for(G=a.pairs();G.hasNext();){var g=G.next();switch(g.key){case "first":f=this._glyphs.get(g.getInt());break;case "second":h=g.getInt();break;case "amount":e=g.getInt()}}null!=f&&0!=e&&f.setKerning(h,e)}},__class__:na};var I=e["flambe.display.TextAlign"]={__ename__:!0,__constructs__:["Left","Center","Right"]};I.Left=["Left",0];I.Left.toString=m;I.Left.__enum__=I;I.Center=["Center",
1];I.Center.toString=m;I.Center.__enum__=I;I.Right=["Right",2];I.Right.toString=m;I.Right.__enum__=I;var ea=function(a,b,c,d,f,h){this.lines=0;var e=this;this._font=a;this._glyphs=[];this._offsets=[];this._lineOffset=Math.round(a.lineHeight+h);this.bounds=new ma;for(var G=[],h=b.length,g=0;g<h;){var i=g++,i=b.charCodeAt(i),i=a._glyphs.get(i);null!=i?this._glyphs.push(i):null}for(var b=-1,j=0,k=0,a=a._glyphs.get(10),h=function(){e.bounds.width=O.max(e.bounds.width,j);e.bounds.height+=k;G[e.lines]=
j;k=j=0;++e.lines},g=0;g<this._glyphs.length;){i=this._glyphs[g];this._offsets[g]=Math.round(j);var l=0<d&&j+i.width>d;l||i==a?(l&&(0<=b?(this._glyphs[b]=a,j=this._offsets[b],g=b):this._glyphs.splice(g,0,a)),b=-1,k=this._lineOffset,h()):(32==i.charCode&&(b=g),j+=i.xAdvance+f,k=O.max(k,i.height+i.yOffset),g+1<this._glyphs.length&&(j+=i.getKerning(this._glyphs[g+1].charCode)));++g}h();f=0;a=ea.getAlignOffset(c,G[0],d);b=1.79769313486231E308;h=-1.79769313486231E308;i=g=0;for(l=this._glyphs.length;i<
l;){var m=this._glyphs[i];10==m.charCode&&(f+=this._lineOffset,++g,a=ea.getAlignOffset(c,G[g],d));this._offsets[i]+=a;var n=f+m.yOffset;b<n||(b=n);h=O.max(h,n+m.height);++i}this.bounds.x=ea.getAlignOffset(c,this.bounds.width,d);this.bounds.y=b;this.bounds.height=h-b};e["flambe.display.TextLayout"]=ea;ea.__name__=!0;ea.getAlignOffset=function(a,b,c){switch(a[1]){case 0:return 0;case 2:return c-b;case 1:return Math.round((c-b)/2)}};ea.prototype={draw:function(a){for(var b=0,c=0,d=this._glyphs.length;c<
d;){var f=this._glyphs[c];10==f.charCode?b+=this._lineOffset:f.draw(a,this._offsets[c],b);++c}},__class__:ea};var oa=function(a){this._configText=a;this._keywordPattern=new $("([A-Za-z]+)(.*)","");this._pairPattern=new $('([A-Za-z]+)=("[^"]*"|[^\\s]+)',"")};e["flambe.display._Font.ConfigParser"]=oa;oa.__name__=!0;oa.advance=function(a,b){var c=b.matchedPos();return y.substr(a,c.pos+c.len,a.length)};oa.prototype={keywords:function(){var a=this,b=this._configText;return{next:function(){b=oa.advance(b,
a._keywordPattern);a._pairText=a._keywordPattern.matched(2);return a._keywordPattern.matched(1)},hasNext:function(){return a._keywordPattern.match(b)}}},pairs:function(){var a=this,b=this._pairText;return{next:function(){b=oa.advance(b,a._pairPattern);return new sb(a._pairPattern.matched(1),a._pairPattern.matched(2))},hasNext:function(){return a._pairPattern.match(b)}}},__class__:oa};var sb=function(a,b){this.key=a;this._value=b};e["flambe.display._Font.ConfigPair"]=sb;sb.__name__=!0;sb.prototype=
{getInt:function(){return z.parseInt(this._value)},getString:function(){return 34!=this._value.charCodeAt(0)?null:y.substr(this._value,1,this._value.length-2)},__class__:sb};var tb=function(){};e["flambe.display.Graphics"]=tb;tb.__name__=!0;tb.prototype={__class__:tb};var x=function(a){j.call(this);this.texture=a};e["flambe.display.ImageSprite"]=x;x.__name__=!0;x.__super__=j;x.prototype=o(j.prototype,{draw:function(a){null!=this.texture&&a.drawTexture(this.texture,0,0)},getNaturalWidth:function(){return null!=
this.texture?this.texture.get_width():0},getNaturalHeight:function(){return null!=this.texture?this.texture.get_height():0},__class__:x});var ba=e["flambe.display.Orientation"]={__ename__:!0,__constructs__:["Portrait","Landscape"]};ba.Portrait=["Portrait",0];ba.Portrait.toString=m;ba.Portrait.__enum__=ba;ba.Landscape=["Landscape",1];ba.Landscape.toString=m;ba.Landscape.__enum__=ba;var Ra=function(){};e["flambe.display.Texture"]=Ra;Ra.__name__=!0;Ra.__interfaces__=[da];Ra.prototype={__class__:Ra};
var Rb=function(){};e["flambe.display.SubTexture"]=Rb;Rb.__name__=!0;Rb.__interfaces__=[Ra];var ca=function(a,b){null==b&&(b="");this._layout=null;var c=this;j.call(this);this._font=a;this._text=b;this._align=I.Left;this._flags|=128;var d=function(){c._flags|=128};this.wrapWidth=new v(0,d);this.letterSpacing=new v(0,d);this.lineSpacing=new v(0,d)};e["flambe.display.TextSprite"]=ca;ca.__name__=!0;ca.__super__=j;ca.prototype=o(j.prototype,{draw:function(a){this.updateLayout();this._layout.draw(a)},
getNaturalWidth:function(){this.updateLayout();return 0<this.wrapWidth._value?this.wrapWidth._value:this._layout.bounds.width},getNaturalHeight:function(){this.updateLayout();var a=this._layout.lines*(this._font.lineHeight+this.lineSpacing._value),b=this._layout.bounds.height;return a>b?a:b},containsLocal:function(a,b){this.updateLayout();return this._layout.bounds.contains(a,b)},set_text:function(a){a!=this._text&&(this._text=a,this._flags|=128);return a},set_align:function(a){a!=this._align&&(this._align=
a,this._flags|=128);return a},updateLayout:function(){0!=(this._flags&128)&&(this._flags&=-129,this._layout=this._font.layoutText(this._text,this._align,this.wrapWidth._value,this.letterSpacing._value,this.lineSpacing._value))},onUpdate:function(a){j.prototype.onUpdate.call(this,a);this.wrapWidth.update(a);this.letterSpacing.update(a);this.lineSpacing.update(a)},__class__:ca});var J=e["flambe.input.MouseButton"]={__ename__:!0,__constructs__:["Left","Middle","Right","Unknown"]};J.Left=["Left",0];J.Left.toString=
m;J.Left.__enum__=J;J.Middle=["Middle",1];J.Middle.toString=m;J.Middle.__enum__=J;J.Right=["Right",2];J.Right.toString=m;J.Right.__enum__=J;J.Unknown=function(a){a=["Unknown",3,a];a.__enum__=J;a.toString=m;return a};var U=e["flambe.input.MouseCursor"]={__ename__:!0,__constructs__:["Default","Button","None"]};U.Default=["Default",0];U.Default.toString=m;U.Default.__enum__=U;U.Button=["Button",1];U.Button.toString=m;U.Button.__enum__=U;U.None=["None",2];U.None.toString=m;U.None.__enum__=U;var ub=function(){this.init(0,
0,0,null)};e["flambe.input.MouseEvent"]=ub;ub.__name__=!0;ub.prototype={init:function(a,b,c,d){this.id=a;this.viewX=b;this.viewY=c;this.button=d},__class__:ub};var Sa=e["flambe.input.EventSource"]={__ename__:!0,__constructs__:["Mouse","Touch"]};Sa.Mouse=function(a){a=["Mouse",0,a];a.__enum__=Sa;a.toString=m;return a};Sa.Touch=function(a){a=["Touch",1,a];a.__enum__=Sa;a.toString=m;return a};var vb=function(){this.init(0,0,0,null,null)};e["flambe.input.PointerEvent"]=vb;vb.__name__=!0;vb.prototype=
{init:function(a,b,c,d,f){this.id=a;this.viewX=b;this.viewY=c;this.hit=d;this.source=f;this._stopped=!1},__class__:vb};var wb=function(a){this.id=a;this._source=Sa.Touch(this)};e["flambe.input.TouchPoint"]=wb;wb.__name__=!0;wb.prototype={init:function(a,b){this.viewX=a;this.viewY=b},__class__:wb};var O=function(){};e["flambe.math.FMath"]=O;O.__name__=!0;O.max=function(a,b){return a>b?a:b};O.min=function(a,b){return a<b?a:b};O.clamp=function(a,b,c){return a<b?b:a>c?c:a};var T=function(){this.identity()};
e["flambe.math.Matrix"]=T;T.__name__=!0;T.multiply=function(a,b,c){null==c&&(c=new T);var d=a.m00*b.m00+a.m01*b.m10,f=a.m00*b.m01+a.m01*b.m11,h=a.m00*b.m02+a.m01*b.m12+a.m02;c.m00=d;c.m01=f;c.m02=h;d=a.m10*b.m00+a.m11*b.m10;f=a.m10*b.m01+a.m11*b.m11;h=a.m10*b.m02+a.m11*b.m12+a.m12;c.m10=d;c.m11=f;c.m12=h;return c};T.prototype={set:function(a,b,c,d,f,h){this.m00=a;this.m01=c;this.m02=f;this.m10=b;this.m11=d;this.m12=h},identity:function(){this.set(1,0,0,1,0,0)},compose:function(a,b,c,d,f){var h=Math.sin(f),
f=Math.cos(f);this.set(f*c,h*c,-h*d,f*d,a,b)},translate:function(a,b){this.m02+=this.m00*a+this.m01*b;this.m12+=this.m11*b+this.m10*a},invert:function(){var a=this.determinant();if(0==a)return!1;this.set(this.m11/a,-this.m01/a,-this.m10/a,this.m00/a,(this.m01*this.m12-this.m11*this.m02)/a,(this.m10*this.m02-this.m00*this.m12)/a);return!0},transform:function(a,b,c){null==c&&(c=new Pa);c.x=a*this.m00+b*this.m01+this.m02;c.y=a*this.m10+b*this.m11+this.m12;return c},transformArray:function(a,b,c){for(var d=
0;d<b;){var f=a[d],h=a[d+1];c[d++]=f*this.m00+h*this.m01+this.m02;c[d++]=f*this.m10+h*this.m11+this.m12}},determinant:function(){return this.m00*this.m11-this.m01*this.m10},inverseTransform:function(a,b,c){var d=this.determinant();if(0==d)return!1;a-=this.m02;b-=this.m12;c.x=(a*this.m11-b*this.m01)/d;c.y=(b*this.m00-a*this.m10)/d;return!0},clone:function(a){null==a&&(a=new T);a.set(this.m00,this.m10,this.m01,this.m11,this.m02,this.m12);return a},__class__:T};var ma=function(a,b,c,d){null==d&&(d=0);
null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.set(a,b,c,d)};e["flambe.math.Rectangle"]=ma;ma.__name__=!0;ma.prototype={set:function(a,b,c,d){this.x=a;this.y=b;this.width=c;this.height=d},contains:function(a,b){a-=this.x;if(0<=this.width){if(0>a||a>this.width)return!1}else if(0<a||a<this.width)return!1;b-=this.y;if(0<=this.height){if(0>b||b>this.height)return!1}else if(0<b||b<this.height)return!1;return!0},clone:function(a){null==a&&(a=new ma);a.set(this.x,this.y,this.width,this.height);return a},
equals:function(a){return this.x==a.x&&this.y==a.y&&this.width==a.width&&this.height==a.height},__class__:ma};var C=function(){this._disposed=!1};e["flambe.platform.BasicAsset"]=C;C.__name__=!0;C.__interfaces__=[da];C.prototype={dispose:function(){this._disposed||(this._disposed=!0,this.onDisposed())},onDisposed:function(){null},__class__:C};var fa=function(a,b){var c=this;this.manifest=b;this._platform=a;this.promise=new Ta;this._bytesLoaded=new W;this._pack=new Ua(b,this);var d=Ga.array(b);if(0==
d.length)this.handleSuccess();else{for(var f=new W,h=0;h<d.length;){var e=d[h];++h;var g=f.get(e.name);null==g&&(g=[],f.set(e.name,g));g.push(e)}this._assetsRemaining=Ga.count(f);for(d=f.iterator();d.hasNext();)f=[d.next()],this.pickBestEntry(f[0],function(a){return function(d){if(null!=d){var f=b.getFullURL(d);try{c.loadEntry(f,d)}catch(h){c.handleError(d,"Unexpected error: "+z.string(h))}f=c.promise;f.set_total(f._total+d.bytes)}else d=a[0][0],fa.isAudio(d.format)?c.handleLoad(d,Q.getInstance()):
c.handleError(d,"Could not find a supported format to load")}}(f))}};e["flambe.platform.BasicAssetPackLoader"]=fa;fa.__name__=!0;fa.isAudio=function(a){switch(a[1]){case 8:case 9:case 10:case 11:case 12:return!0;default:return!1}};fa.prototype={onDisposed:function(){},pickBestEntry:function(a,b){this.getAssetFormats(function(c){for(var d=0;d<c.length;){var f=c[d];++d;for(var h=0;h<a.length;){var e=a[h];++h;if(e.format==f){b(e);return}}}b(null)})},loadEntry:function(){null},getAssetFormats:function(){null},
handleLoad:function(a,b){if(!this._pack.disposed){this.handleProgress(a,a.bytes);var c;switch(a.format[1]){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:c=this._pack.textures;break;case 8:case 9:case 10:case 11:case 12:c=this._pack.sounds;break;case 13:c=this._pack.files}c.set(a.name,b);this._assetsRemaining-=1;0==this._assetsRemaining&&this.handleSuccess()}},handleProgress:function(a,b){this._bytesLoaded.set(a.name,b);for(var c=0,d=this._bytesLoaded.iterator();d.hasNext();)var f=d.next(),
c=c+f;this.promise.set_progress(c)},handleSuccess:function(){this.promise.set_result(this._pack)},handleError:function(a,b){this.promise.error.emit(B.withFields(b,["url",a.url]))},handleTextureError:function(a){this.handleError(a,"Failed to create texture. Is the GPU context unavailable?")},__class__:fa};var Ua=function(a,b){this.disposed=!1;this._manifest=a;this.loader=b;this.textures=new W;this.sounds=new W;this.files=new W};e["flambe.platform._BasicAssetPackLoader.BasicAssetPack"]=Ua;Ua.__name__=
!0;Ua.__interfaces__=[Na];Ua.prototype={getTexture:function(a,b){null==b&&(b=!0);var c=this.textures.get(a);if(null==c&&b)throw B.withFields("Missing texture",["name",a]);return c},getSound:function(a,b){null==b&&(b=!0);var c=this.sounds.get(a);if(null==c&&b)throw B.withFields("Missing sound",["name",a]);return c},getFile:function(a,b){null==b&&(b=!0);var c=this.files.get(a);if(null==c&&b)throw B.withFields("Missing file",["name",a]);return c},dispose:function(){if(!this.disposed){this.disposed=!0;
for(var a=this.textures.iterator();a.hasNext();)a.next().dispose();this.textures=null;for(a=this.sounds.iterator();a.hasNext();)a.next().dispose();this.sounds=null;for(a=this.files.iterator();a.hasNext();)a.next().dispose();this.files=null;this.loader.onDisposed()}},__class__:Ua};var xa=function(a){this._disposed=!1;this._content=a};e["flambe.platform.BasicFile"]=xa;xa.__name__=!0;xa.__interfaces__=[Oa];xa.__super__=C;xa.prototype=o(C.prototype,{toString:function(){return this._content},onDisposed:function(){this._content=
null},__class__:xa});var Xb=function(){};e["flambe.subsystem.MouseSystem"]=Xb;Xb.__name__=!0;var P=function(a){this._pointer=a;this._source=Sa.Mouse(P._sharedEvent);this.down=new t;this.move=new t;this.up=new t;this.scroll=new t;this._y=this._x=0;this._cursor=U.Default;this._buttonStates=new Z};e["flambe.platform.BasicMouse"]=P;P.__name__=!0;P.__interfaces__=[Xb];P.prototype={submitDown:function(a,b,c){this._buttonStates.exists(c)||(this._buttonStates.set(c,!0),this.prepare(a,b,xb.toButton(c)),this._pointer.submitDown(a,
b,this._source),this.down.emit(P._sharedEvent))},submitMove:function(a,b){this.prepare(a,b,null);this._pointer.submitMove(a,b,this._source);this.move.emit(P._sharedEvent)},submitUp:function(a,b,c){this._buttonStates.exists(c)&&(this._buttonStates.remove(c),this.prepare(a,b,xb.toButton(c)),this._pointer.submitUp(a,b,this._source),this.up.emit(P._sharedEvent))},submitScroll:function(a,b,c){this._x=a;this._y=b;if(null==this.scroll._head)return!1;this.scroll.emit(c);return!0},prepare:function(a,b,c){this._x=
a;this._y=b;P._sharedEvent.init(P._sharedEvent.id+1,a,b,c)},__class__:P};var yb=function(){};e["flambe.subsystem.PointerSystem"]=yb;yb.__name__=!0;yb.prototype={__class__:yb};var F=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);null==a&&(a=0);this.down=new t;this.move=new t;this.up=new t;this._x=a;this._y=b;this._isDown=c};e["flambe.platform.BasicPointer"]=F;F.__name__=!0;F.__interfaces__=[yb];F.prototype={submitDown:function(a,b,c){if(!this._isDown){this.submitMove(a,b,c);this._isDown=!0;var d=[],
f=j.hitTest(i.root,a,b);if(null!=f){var h=f.owner;do{var e=h._compMap.Sprite_4;null!=e&&d.push(e);h=h.parent}while(null!=h)}this.prepare(a,b,f,c);for(a=0;a<d.length;)if(b=d[a],++a,b.onPointerDown(F._sharedEvent),F._sharedEvent._stopped)return;this.down.emit(F._sharedEvent)}},submitMove:function(a,b,c){if(!(a==this._x&&b==this._y)){var d=[],f=j.hitTest(i.root,a,b);if(null!=f){var h=f.owner;do{var e=h._compMap.Sprite_4;null!=e&&d.push(e);h=h.parent}while(null!=h)}this.prepare(a,b,f,c);for(a=0;a<d.length;)if(b=
d[a],++a,b.onPointerMove(F._sharedEvent),F._sharedEvent._stopped)return;this.move.emit(F._sharedEvent)}},submitUp:function(a,b,c){if(this._isDown){this.submitMove(a,b,c);this._isDown=!1;var d=[],f=j.hitTest(i.root,a,b);if(null!=f){var h=f.owner;do{var e=h._compMap.Sprite_4;null!=e&&d.push(e);h=h.parent}while(null!=h)}this.prepare(a,b,f,c);for(a=0;a<d.length;)if(b=d[a],++a,b.onPointerUp(F._sharedEvent),F._sharedEvent._stopped)return;this.up.emit(F._sharedEvent)}},prepare:function(a,b,c,d){this._x=
a;this._y=b;F._sharedEvent.init(F._sharedEvent.id+1,a,b,c,d)},__class__:F};var X=function(a,b,c){this._x=this._y=0;this._parent=null;this.rootX=this.rootY=0;this._disposed=!1;this.root=a;this._width=b;this._height=c};e["flambe.platform.BasicTexture"]=X;X.__name__=!0;X.__interfaces__=[Rb];X.__super__=C;X.prototype=o(C.prototype,{readPixels:function(a,b,c,d){return this.root.readPixels(this.rootX+a,this.rootY+b,c,d)},subTexture:function(a,b,c,d){c=this.root.createTexture(c,d);c._parent=this;c._x=a;
c._y=b;c.rootX=this.rootX+a;c.rootY=this.rootY+b;return c},onDisposed:function(){null==this._parent&&this.root.dispose()},get_width:function(){return this._width},get_height:function(){return this._height},__class__:X});var Sb=function(){};e["flambe.subsystem.TouchSystem"]=Sb;Sb.__name__=!0;var Ja=function(a,b){null==b&&(b=4);this._pointer=a;this._maxPoints=b;this._pointMap=new Z;this._points=[];this.down=new t;this.move=new t;this.up=new t};e["flambe.platform.BasicTouch"]=Ja;Ja.__name__=!0;Ja.__interfaces__=
[Sb];Ja.prototype={submitDown:function(a,b,c){if(!this._pointMap.exists(a)){var d=new wb(a);d.init(b,c);this._pointMap.set(a,d);this._points.push(d);null==this._pointerTouch&&(this._pointerTouch=d,this._pointer.submitDown(b,c,d._source));this.down.emit(d)}},submitMove:function(a,b,c){a=this._pointMap.get(a);null!=a&&(a.init(b,c),this._pointerTouch==a&&this._pointer.submitMove(b,c,a._source),this.move.emit(a))},submitUp:function(a,b,c){var d=this._pointMap.get(a);null!=d&&(d.init(b,c),this._pointMap.remove(a),
y.remove(this._points,d),this._pointerTouch==d&&(this._pointerTouch=null,this._pointer.submitUp(b,c,d._source)),this.up.emit(d))},__class__:Ja};var pa=function(){};e["flambe.sound.Sound"]=pa;pa.__name__=!0;pa.__interfaces__=[da];pa.prototype={__class__:pa};var Q=function(){this._disposed=!1;this._playback=new Va(this)};e["flambe.platform.DummySound"]=Q;Q.__name__=!0;Q.__interfaces__=[pa];Q.getInstance=function(){null==Q._instance&&(Q._instance=new Q);return Q._instance};Q.__super__=C;Q.prototype=
o(C.prototype,{play:function(){return this._playback},onDisposed:function(){},__class__:Q});var Wa=function(){};e["flambe.sound.Playback"]=Wa;Wa.__name__=!0;Wa.__interfaces__=[Y];var Va=function(a){this._sound=a;this.volume=new v(0);this._complete=new H(!0)};e["flambe.platform.DummyPlayback"]=Va;Va.__name__=!0;Va.__interfaces__=[Wa];Va.prototype={dispose:function(){},__class__:Va};var Ka=function(){this.down=new t;this.move=new t;this.up=new t};e["flambe.platform.DummyTouch"]=Ka;Ka.__name__=!0;Ka.__interfaces__=
[Sb];Ka.prototype={__class__:Ka};var ya=function(){this._entries=[]};e["flambe.platform.EventGroup"]=ya;ya.__name__=!0;ya.__interfaces__=[Y];ya.prototype={addListener:function(a,b,c){a.addEventListener(b,c,!1);this._entries.push(new zb(a,b,c))},addDisposingListener:function(a,b,c){var d=this;this.addListener(a,b,function(a){d.dispose();c(a)})},dispose:function(){for(var a=0,b=this._entries;a<b.length;){var c=b[a];++a;c.dispatcher.removeEventListener(c.type,c.listener,!1)}this._entries=[]},__class__:ya};
var zb=function(a,b,c){this.dispatcher=a;this.type=b;this.listener=c};e["flambe.platform._EventGroup.Entry"]=zb;zb.__name__=!0;zb.prototype={__class__:zb};var za=function(){};e["flambe.platform.InternalGraphics"]=za;za.__name__=!0;za.__interfaces__=[tb];za.prototype={__class__:za};var Ab=function(){};e["flambe.subsystem.RendererSystem"]=Ab;Ab.__name__=!0;Ab.prototype={__class__:Ab};var Aa=function(){};e["flambe.platform.InternalRenderer"]=Aa;Aa.__name__=!0;Aa.__interfaces__=[Ab];Aa.prototype={__class__:Aa};
var ja=function(){this._tickables=[]};e["flambe.platform.MainLoop"]=ja;ja.__name__=!0;ja.updateEntity=function(a,b){var c=a._compMap.SpeedAdjuster_8;if(null!=c&&(c._realDt=b,b*=c.scale._value,0>=b)){c.onUpdate(b);return}for(c=a.firstComponent;null!=c;){var d=c.next;0==(c._flags&1)&&(c._flags|=1,c.onStart());c.onUpdate(b);c=d}for(c=a.firstChild;null!=c;)d=c.next,ja.updateEntity(c,b),c=d};ja.prototype={update:function(a){if(!(0>=a)){1<a&&(a=1);for(var b=0;b<this._tickables.length;){var c=this._tickables[b];
null==c||c.update(a)?this._tickables.splice(b,1):++b}i.volume.update(a);ja.updateEntity(i.root,a)}},render:function(a){var b=a.graphics;null!=b&&(a.willRender(),j.render(i.root,b),a.didRender())},addTickable:function(a){this._tickables.push(a)},__class__:ja};var Bb=function(){};e["flambe.platform.MathUtil"]=Bb;Bb.__name__=!0;Bb.nextPowerOfTwo=function(a){for(var b=1;b<a;)b<<=1;return b};var xb=function(){};e["flambe.platform.MouseCodes"]=xb;xb.__name__=!0;xb.toButton=function(a){switch(a){case 0:return J.Left;
case 1:return J.Middle;case 2:return J.Right}return J.Unknown(a)};var Xa=function(){};e["flambe.platform.TextureRoot"]=Xa;Xa.__name__=!0;Xa.prototype={__class__:Xa};var Ya=function(){};e["flambe.platform.Tickable"]=Ya;Ya.__name__=!0;Ya.prototype={__class__:Ya};var Za=function(a,b){this._firstDraw=!1;this._canvasCtx=a.getContext("2d",{alpha:b})};e["flambe.platform.html.CanvasGraphics"]=Za;Za.__name__=!0;Za.__interfaces__=[za];Za.prototype={save:function(){this._canvasCtx.save()},transform:function(a,
b,c,d,f,h){this._canvasCtx.transform(a,b,c,d,f,h)},restore:function(){this._canvasCtx.restore()},drawTexture:function(a,b,c){this.drawSubTexture(a,b,c,0,0,a.get_width(),a.get_height())},drawSubTexture:function(a,b,c,d,f,h,e){this._firstDraw?(this._firstDraw=!1,this._canvasCtx.globalCompositeOperation="copy",this.drawSubTexture(a,b,c,d,f,h,e),this._canvasCtx.globalCompositeOperation="source-over"):this._canvasCtx.drawImage(a.root.image,a.rootX+d|0,a.rootY+f|0,h|0,e|0,b|0,c|0,h|0,e|0)},fillRect:function(a,
b,c,d,f){if(this._firstDraw)this._firstDraw=!1,this._canvasCtx.globalCompositeOperation="copy",this.fillRect(a,b,c,d,f),this._canvasCtx.globalCompositeOperation="source-over";else{for(a=(16777215&a).toString(16);6>a.length;)a="0"+z.string(a);this._canvasCtx.fillStyle="#"+z.string(a);this._canvasCtx.fillRect(b|0,c|0,d|0,f|0)}},multiplyAlpha:function(a){this._canvasCtx.globalAlpha*=a},setBlendMode:function(a){var b;switch(a[1]){case 0:b="source-over";break;case 1:b="lighter";break;case 2:b="multiply";
break;case 3:b="screen";break;case 4:b="destination-in";break;case 5:b="copy"}this._canvasCtx.globalCompositeOperation=b},applyScissor:function(a,b,c,d){this._canvasCtx.beginPath();this._canvasCtx.rect(a|0,b|0,c|0,d|0);this._canvasCtx.clip()},willRender:function(){this._firstDraw=!0},didRender:function(){},onResize:function(){},__class__:Za};var ka=function(a){this.graphics=new Za(a,!1);this._hasGPU=new H(!0)};e["flambe.platform.html.CanvasRenderer"]=ka;ka.__name__=!0;ka.__interfaces__=[Aa];ka.prototype=
{get_type:function(){return R.Canvas},createTextureFromImage:function(a){a=new Ba(ka.CANVAS_TEXTURES?k.createCanvas(a):a);return a.createTexture(a.width,a.height)},getCompressedTextureFormats:function(){return[]},createCompressedTexture:function(){return null},willRender:function(){this.graphics.willRender()},didRender:function(){this.graphics.didRender()},__class__:ka};var $a=function(a,b,c){X.call(this,a,b,c)};e["flambe.platform.html.CanvasTexture"]=$a;$a.__name__=!0;$a.__super__=X;$a.prototype=
o(X.prototype,{__class__:$a});var Ba=function(a){this._graphics=null;this._disposed=!1;this.image=a;this.width=a.width;this.height=a.height};e["flambe.platform.html.CanvasTextureRoot"]=Ba;Ba.__name__=!0;Ba.__interfaces__=[Xa];Ba.__super__=C;Ba.prototype=o(C.prototype,{createTexture:function(a,b){return new $a(this,a,b)},readPixels:function(a,b,c,d){a=this.getContext2d().getImageData(a,b,c,d).data;return qa.ofData(a)},getContext2d:function(){E.__instanceof(this.image,HTMLCanvasElement)||(this.image=
k.createCanvas(this.image));return this.image.getContext("2d")},onDisposed:function(){this._graphics=this.image=null},__class__:Ba});var p=function(a,b){fa.call(this,a,b)};e["flambe.platform.html.HtmlAssetPackLoader"]=p;p.__name__=!0;p.detectImageFormats=function(a){var b=[g.PNG,g.JPG,g.GIF],c=2,d;d=window.document.createElement("img");d.onload=d.onerror=function(){1==d.width&&b.unshift(g.WEBP);--c;0==c&&a(b)};d.src="data:image/webp;base64,UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==";var f;f=
window.document.createElement("img");f.onload=f.onerror=function(){1==f.width&&b.unshift(g.JXR);--c;0==c&&a(b)};f.src="data:image/vnd.ms-photo;base64,SUm8AQgAAAAFAAG8AQAQAAAASgAAAIC8BAABAAAAAQAAAIG8BAABAAAAAQAAAMC8BAABAAAAWgAAAMG8BAABAAAAHwAAAAAAAAAkw91vA07+S7GFPXd2jckNV01QSE9UTwAZAYBxAAAAABP/gAAEb/8AAQAAAQAAAA=="};p.detectAudioFormats=function(){var a;a=window.document.createElement("audio");if(null==a||null==w(a,a.canPlayType))return[];var b=new $("\\b(iPhone|iPod|iPad|Android|Windows Phone)\\b",
""),c=window.navigator.userAgent;if(!q.get_supported()&&b.match(c))return[];for(var b=[{format:g.M4A,mimeType:"audio/mp4; codecs=mp4a"},{format:g.MP3,mimeType:"audio/mpeg"},{format:g.OPUS,mimeType:"audio/ogg; codecs=opus"},{format:g.OGG,mimeType:"audio/ogg; codecs=vorbis"},{format:g.WAV,mimeType:"audio/wav"}],c=[],d=0;d<b.length;){var f=b[d];++d;var h="";try{h=a.canPlayType(f.mimeType)}catch(e){}""!=h&&c.push(f.format)}return c};p.supportsBlob=function(){if(p._detectBlobSupport){p._detectBlobSupport=
!1;if((new $("\\bSilk\\b","")).match(window.navigator.userAgent)||null==window.Blob)return!1;var a=new XMLHttpRequest;a.open("GET",".",!0);if(""!=a.responseType)return!1;a.responseType="blob";if("blob"!=a.responseType)return!1;p._URL=k.loadExtension("URL").value}return null!=p._URL&&null!=p._URL.createObjectURL};p.__super__=fa;p.prototype=o(fa.prototype,{loadEntry:function(a,b){var c=this;switch(b.format[1]){case 0:case 1:case 2:case 3:case 4:var d;d=window.document.createElement("img");var f=new ya;
f.addDisposingListener(d,"load",function(){p.supportsBlob()&&p._URL.revokeObjectURL(d.src);var a=c._platform.getRenderer().createTextureFromImage(d);null!=a?c.handleLoad(b,a):c.handleTextureError(b)});f.addDisposingListener(d,"error",function(){c.handleError(b,"Failed to load image")});p.supportsBlob()?this.download(a,b,"blob",function(a){d.src=p._URL.createObjectURL(a)}):d.src=a;break;case 5:case 6:case 7:this.download(a,b,"arraybuffer",function(){var a=c._platform.getRenderer().createCompressedTexture(b.format,
null);null!=a?c.handleLoad(b,a):c.handleTextureError(b)});break;case 8:case 9:case 10:case 11:case 12:if(q.get_supported())this.download(a,b,"arraybuffer",function(a){q.ctx.decodeAudioData(a,function(a){c.handleLoad(b,new q(a))},function(){c.handleLoad(b,Q.getInstance())})});else{var h;h=window.document.createElement("audio");h.preload="auto";var e=++p._mediaRefCount;null==p._mediaElements&&(p._mediaElements=new Z);p._mediaElements.set(e,h);f=new ya;f.addDisposingListener(h,"canplaythrough",function(){p._mediaElements.remove(e);
c.handleLoad(b,new Ca(h))});f.addDisposingListener(h,"error",function(){p._mediaElements.remove(e);var a=h.error.code;3==a||4==a?c.handleLoad(b,Q.getInstance()):c.handleError(b,"Failed to load audio: "+h.error.code)});f.addListener(h,"progress",function(){if(0<h.buffered.length&&0<h.duration){var a=h.buffered.end(0)/h.duration;c.handleProgress(b,a*b.bytes|0)}});h.src=a;h.load()}break;case 13:this.download(a,b,"text",function(a){c.handleLoad(b,new xa(a))})}},getAssetFormats:function(a){var b=this;
null==p._supportedFormats&&(p._supportedFormats=new Ta,p.detectImageFormats(function(a){p._supportedFormats.set_result(b._platform.getRenderer().getCompressedTextureFormats().concat(a).concat(p.detectAudioFormats()).concat([g.Data]))}));p._supportedFormats.get(a)},download:function(a,b,c,d){var f=this,h=null,e=null,g=0,i=!1,j=function(){i&&(i=!1,window.clearInterval(g))},k=3,l=function(){--k;return 0<=k?(e(),!0):!1},e=function(){j();null!=h&&h.abort();h=new XMLHttpRequest;h.open("GET",a,!0);h.responseType=
c;var e=0;h.onprogress=function(a){i||(i=!0,g=window.setInterval(function(){4!=h.readyState&&5E3<Date.now()-e&&!l()&&(j(),f.handleError(b,"Download stalled"))},1E3));e=Date.now();f.handleProgress(b,a.loaded)};h.onerror=function(){if(0!=h.status||!l())j(),f.handleError(b,"HTTP error "+h.status)};h.onload=function(){var a=h.response;null==a&&(a=h.responseText);j();d(a)};h.send()};e()},__class__:p});var Ia=function(a,b){P.call(this,a);this._canvas=b};e["flambe.platform.html.HtmlMouse"]=Ia;Ia.__name__=
!0;Ia.__super__=P;Ia.prototype=o(P.prototype,{__class__:Ia});var Ca=function(a){this._disposed=!1;this.audioElement=a};e["flambe.platform.html.HtmlSound"]=Ca;Ca.__name__=!0;Ca.__interfaces__=[pa];Ca.__super__=C;Ca.prototype=o(C.prototype,{play:function(a){null==a&&(a=1);return new ab(this,a,!1)},onDisposed:function(){this.audioElement=null},__class__:Ca});var ab=function(a,b,c){var d=this;this._sound=a;this._tickableAdded=!1;this._clonedElement=window.document.createElement("audio");this._clonedElement.loop=
c;this._clonedElement.src=a.audioElement.src;this.volume=new v(b,function(){d.updateVolume()});this.updateVolume();this._complete=new H(!1);this.playAudio();i.hidden._value&&this.set_paused(!0)};e["flambe.platform.html._HtmlSound.HtmlPlayback"]=ab;ab.__name__=!0;ab.__interfaces__=[Ya,Wa];ab.prototype={set_paused:function(a){this._clonedElement.paused!=a&&(a?this._clonedElement.pause():this.playAudio());return a},update:function(a){this.volume.update(a);this._complete.set__(this._clonedElement.ended);
return this._complete._value||this._clonedElement.paused?(this._tickableAdded=!1,this._volumeBinding.dispose(),this._hideBinding.dispose(),!0):!1},dispose:function(){this.set_paused(!0);this._complete.set__(!0)},playAudio:function(){var a=this;this._clonedElement.play();this._tickableAdded||(aa.instance.mainLoop.addTickable(this),this._tickableAdded=!0,this._volumeBinding=i.volume.get_changed().connect(function(){a.updateVolume()}),this._hideBinding=i.hidden.get_changed().connect(function(b){b?(a._wasPaused=
a._clonedElement.paused,a.set_paused(!0)):a.set_paused(a._wasPaused)}))},updateVolume:function(){this._clonedElement.volume=i.volume._value*this.volume._value},__class__:ab};var Cb=function(){};e["flambe.subsystem.StageSystem"]=Cb;Cb.__name__=!0;Cb.prototype={__class__:Cb};var ia=function(a){var b=this;this._canvas=a;this.resize=new V;this.scaleFactor=ia.computeScaleFactor();1!=this.scaleFactor&&(k.setVendorStyle(this._canvas,"transform-origin","top left"),k.setVendorStyle(this._canvas,"transform",
"scale("+1/this.scaleFactor+")"));k.SHOULD_HIDE_MOBILE_BROWSER&&(window.addEventListener("orientationchange",function(){k.callLater(w(b,b.hideMobileBrowser),200)},!1),this.hideMobileBrowser());window.addEventListener("resize",w(this,this.onWindowResize),!1);this.onWindowResize(null);this.orientation=new H(null);null!=window.orientation&&(window.addEventListener("orientationchange",w(this,this.onOrientationChange),!1),this.onOrientationChange(null));this.fullscreen=new H(!1);k.addVendorListener(window.document,
"fullscreenchange",function(){b.updateFullscreen()},!1);this.updateFullscreen()};e["flambe.platform.html.HtmlStage"]=ia;ia.__name__=!0;ia.__interfaces__=[Cb];ia.computeScaleFactor=function(){var a=window.devicePixelRatio;null==a&&(a=1);var b=window.document.createElement("canvas").getContext("2d"),b=k.loadExtension("backingStorePixelRatio",b).value;null==b&&(b=1);a/=b;b=window.screen.height;return 1136<a*window.screen.width||1136<a*b?1:a};ia.prototype={get_width:function(){return this._canvas.width},
get_height:function(){return this._canvas.height},onWindowResize:function(){var a=this._canvas.parentElement.getBoundingClientRect();this.resizeCanvas(a.width,a.height)},resizeCanvas:function(a,b){var c=this.scaleFactor*a,d=this.scaleFactor*b;if(this._canvas.width==c&&this._canvas.height==d)return!1;this._canvas.width=c|0;this._canvas.height=d|0;this.resize.emit();return!0},hideMobileBrowser:function(){var a=this,b=window.document.documentElement.style;b.height=window.innerHeight+100+"px";b.width=
window.innerWidth+"px";b.overflow="visible";k.callLater(function(){k.hideMobileBrowser();k.callLater(function(){b.height=window.innerHeight+"px";a.onWindowResize(null)},100)})},onOrientationChange:function(){this.orientation.set__(k.orientation(window.orientation))},updateFullscreen:function(){this.fullscreen.set__(!0==k.loadFirstExtension(["fullscreen","fullScreen","isFullScreen"],window.document).value)},__class__:ia};var k=function(){};e["flambe.platform.html.HtmlUtil"]=k;k.__name__=!0;k.callLater=
function(a,b){null==b&&(b=0);window.setTimeout(a,b)};k.hideMobileBrowser=function(){window.scrollTo(1,0)};k.loadExtension=function(a,b){null==b&&(b=window);var c=ta.field(b,a);if(null!=c)return{prefix:"",field:a,value:c};for(var c=a.charAt(0).toUpperCase()+y.substr(a,1,null),d=0,f=k.VENDOR_PREFIXES;d<f.length;){var h=f[d];++d;var e=h+c,g=ta.field(b,e);if(null!=g)return{prefix:h,field:e,value:g}}return{prefix:null,field:null,value:null}};k.loadFirstExtension=function(a,b){for(var c=0;c<a.length;){var d=
a[c];++c;d=k.loadExtension(d,b);if(null!=d.field)return d}return{prefix:null,field:null,value:null}};k.polyfill=function(a,b){null==b&&(b=window);var c=k.loadExtension(a,b).value;if(null==c)return!1;b[a]=c;return!0};k.setVendorStyle=function(a,b,c){for(var a=a.style,d=0,f=k.VENDOR_PREFIXES;d<f.length;){var h=f[d];++d;a.setProperty("-"+h+"-"+b,c)}a.setProperty(b,c)};k.addVendorListener=function(a,b,c,d){for(var f=0,h=k.VENDOR_PREFIXES;f<h.length;){var e=h[f];++f;a.addEventListener(e+b,c,d)}a.addEventListener(b,
c,d)};k.orientation=function(a){switch(a){case -90:case 90:return ba.Landscape;default:return ba.Portrait}};k.createEmptyCanvas=function(a,b){var c;c=window.document.createElement("canvas");c.width=a;c.height=b;return c};k.createCanvas=function(a){var b=k.createEmptyCanvas(a.width,a.height),c=b.getContext("2d");c.save();c.globalCompositeOperation="copy";c.drawImage(a,0,0);c.restore();return b};k.detectSlowDriver=function(a){if(0<=window.navigator.platform.indexOf("Win")&&null!=window.chrome){for(var b=
0,a=a.getSupportedExtensions();b<a.length;){var c=a[b];++b;if(0<=c.indexOf("WEBGL_compressed_texture"))return!1}return!0}return!1};k.fixAndroidMath=function(){if(0<=window.navigator.userAgent.indexOf("Linux; U; Android 4")){var a=Math.sin,b=Math.cos;Math.sin=function(b){return 0==b?0:a(b)};Math.cos=function(a){return 0==a?1:b(a)}}};var q=function(a){this._disposed=!1;this.buffer=a};e["flambe.platform.html.WebAudioSound"]=q;q.__name__=!0;q.__interfaces__=[pa];q.get_supported=function(){if(q._detectSupport){q._detectSupport=
!1;var a=k.loadExtension("AudioContext").value;null!=a&&(q.ctx=new a,q.gain=q.createGain(),q.gain.connect(q.ctx.destination),i.volume.watch(function(a){q.gain.gain.value=a}))}return null!=q.ctx};q.createGain=function(){return null!=q.ctx.createGain?q.ctx.createGain():q.ctx.createGainNode()};q.start=function(a,b){null!=a.start?a.start(b):a.noteOn(b)};q.__super__=C;q.prototype=o(C.prototype,{play:function(a){null==a&&(a=1);return new bb(this,a,!1)},get_duration:function(){return this.buffer.duration},
onDisposed:function(){this.buffer=null},__class__:q});var bb=function(a,b,c){var d=this;this._sound=a;this._head=q.gain;this._complete=new H(!1);this._sourceNode=q.ctx.createBufferSource();this._sourceNode.buffer=a.buffer;this._sourceNode.loop=c;this._sourceNode.onended=function(){d._complete.set__(!0)};q.start(this._sourceNode,0);this.playAudio();this.volume=new v(b,function(a){d.setVolume(a)});1!=b&&this.setVolume(b);i.hidden._value&&this.set_paused(!0)};e["flambe.platform.html._WebAudioSound.WebAudioPlayback"]=
bb;bb.__name__=!0;bb.__interfaces__=[Ya,Wa];bb.prototype={set_paused:function(a){a!=0<=this._pausedAt&&(a?(this._sourceNode.disconnect(),this._pausedAt=this.get_position()):this.playAudio());return a},get_position:function(){return this._complete._value?this._sound.get_duration():0<=this._pausedAt?this._pausedAt:(q.ctx.currentTime-this._startedAt)%this._sound.get_duration()},update:function(a){this.volume.update(a);3==this._sourceNode.playbackState&&this._complete.set__(!0);return this._complete._value||
0<=this._pausedAt?(this._tickableAdded=!1,this._hideBinding.dispose(),!0):!1},dispose:function(){this.set_paused(!0);this._complete.set__(!0)},setVolume:function(a){null==this._gainNode&&(this._gainNode=q.createGain(),this.insertNode(this._gainNode));this._gainNode.gain.value=a},insertNode:function(a){0<=this._pausedAt||(this._sourceNode.disconnect(),this._sourceNode.connect(a));a.connect(this._head);this._head=a},playAudio:function(){var a=this;this._sourceNode.connect(this._head);this._startedAt=
q.ctx.currentTime;this._pausedAt=-1;this._tickableAdded||(aa.instance.mainLoop.addTickable(this),this._tickableAdded=!0,this._hideBinding=i.hidden.get_changed().connect(function(b){b?(a._wasPaused=0<=a._pausedAt,a.set_paused(!0)):a.set_paused(a._wasPaused)}))},__class__:bb};var Db=function(a){this._quads=this._maxQuads=this._dataOffset=this._backbufferWidth=this._backbufferHeight=0;this._pendingSetScissor=!1;this._lastBlendMode=this._lastRenderTarget=this._lastShader=this._lastTexture=this._lastScissor=
this._currentBlendMode=this._currentShader=this._currentTexture=this._currentRenderTarget=null;this._gl=a;a.clearColor(0,0,0,0);a.enable(3042);a.pixelStorei(37441,1);this._vertexBuffer=a.createBuffer();a.bindBuffer(34962,this._vertexBuffer);this._quadIndexBuffer=a.createBuffer();a.bindBuffer(34963,this._quadIndexBuffer);this._drawTextureShader=new cb(a);this._drawPatternShader=new db(a);this._fillRectShader=new eb(a);this.resize(16)};e["flambe.platform.html.WebGLBatcher"]=Db;Db.__name__=!0;Db.prototype=
{resizeBackbuffer:function(a,b){this._gl.viewport(0,0,a,b);this._backbufferWidth=a;this._backbufferHeight=b},willRender:function(){},didRender:function(){this.flush()},bindTexture:function(a){this.flush();this._currentTexture=this._lastTexture=null;this._gl.bindTexture(3553,a)},deleteTexture:function(a){null!=this._lastTexture&&this._lastTexture.root==a&&(this.flush(),this._currentTexture=this._lastTexture=null);this._gl.deleteTexture(a.nativeTexture)},bindFramebuffer:function(a){a!=this._lastRenderTarget&&
(this.flush(),this.bindRenderTarget(a))},deleteFramebuffer:function(a){a==this._lastRenderTarget&&(this.flush(),this._currentRenderTarget=this._lastRenderTarget=null);this._gl.deleteFramebuffer(a.framebuffer)},prepareDrawTexture:function(a,b,c,d){d!=this._lastTexture&&(this.flush(),this._lastTexture=d);return this.prepareQuad(5,a,b,c,this._drawTextureShader)},prepareFillRect:function(a,b,c){return this.prepareQuad(6,a,b,c,this._fillRectShader)},prepareQuad:function(a,b,c,d,f){b!=this._lastRenderTarget&&
(this.flush(),this._lastRenderTarget=b);c!=this._lastBlendMode&&(this.flush(),this._lastBlendMode=c);f!=this._lastShader&&(this.flush(),this._lastShader=f);if(null!=d||null!=this._lastScissor)if(null==d||null==this._lastScissor||!this._lastScissor.equals(d))this.flush(),this._lastScissor=null!=d?d.clone(this._lastScissor):null,this._pendingSetScissor=!0;this._quads>=this._maxQuads&&this.resize(2*this._maxQuads);++this._quads;b=this._dataOffset;this._dataOffset+=4*a;return b},flush:function(){if(!(1>
this._quads)){this._lastRenderTarget!=this._currentRenderTarget&&this.bindRenderTarget(this._lastRenderTarget);if(this._lastBlendMode!=this._currentBlendMode){switch(this._lastBlendMode[1]){case 0:this._gl.blendFunc(1,771);break;case 1:this._gl.blendFunc(1,1);break;case 2:this._gl.blendFunc(774,771);break;case 3:this._gl.blendFunc(1,769);break;case 4:this._gl.blendFunc(0,770);break;case 5:this._gl.blendFunc(1,0)}this._currentBlendMode=this._lastBlendMode}this._pendingSetScissor&&(null!=this._lastScissor?
(this._gl.enable(3089),this._gl.scissor(this._lastScissor.x|0,this._lastScissor.y|0,this._lastScissor.width|0,this._lastScissor.height|0)):this._gl.disable(3089),this._pendingSetScissor=!1);this._lastTexture!=this._currentTexture&&(this._gl.bindTexture(3553,this._lastTexture.root.nativeTexture),this._currentTexture=this._lastTexture);this._lastShader!=this._currentShader&&(this._lastShader.useProgram(),this._lastShader.prepare(),this._currentShader=this._lastShader);if(this._lastShader==this._drawPatternShader){var a=
this._lastTexture,b=a.root;this._drawPatternShader.setRegion(a.rootX/b.width,a.rootY/b.height,a._width/b.width,a._height/b.height)}this._gl.bufferData(34962,this.data.subarray(0,this._dataOffset),35040);this._gl.drawElements(4,6*this._quads,5123,0);this._dataOffset=this._quads=0}},resize:function(a){this.flush();if(!(1024<a)){this._maxQuads=a;this.data=new Float32Array(24*a);this._gl.bufferData(34962,4*this.data.length,35040);for(var b=new Uint16Array(6*a),c=0;c<a;){var d=c++;b[6*d]=4*d;b[6*d+1]=
4*d+1;b[6*d+2]=4*d+2;b[6*d+3]=4*d+2;b[6*d+4]=4*d+3;b[6*d+5]=4*d}this._gl.bufferData(34963,b,35044)}},bindRenderTarget:function(a){null!=a?(this._gl.bindFramebuffer(36160,a.framebuffer),this._gl.viewport(0,0,a.width,a.height)):(this._gl.bindFramebuffer(36160,null),this._gl.viewport(0,0,this._backbufferWidth,this._backbufferHeight));this._lastRenderTarget=this._currentRenderTarget=a},__class__:Db};var S=function(a,b){this._inverseProjection=this._stateList=null;null==S._scratchQuadArray&&(S._scratchQuadArray=
new Float32Array(8));this._batcher=a;this._renderTarget=b};e["flambe.platform.html.WebGLGraphics"]=S;S.__name__=!0;S.__interfaces__=[za];S.prototype={save:function(){var a=this._stateList,b=this._stateList.next;null==b&&(b=new fb,b.prev=a,a.next=b);a.matrix.clone(b.matrix);b.alpha=a.alpha;b.blendMode=a.blendMode;b.scissor=null!=a.scissor?a.scissor.clone(b.scissor):null;this._stateList=b},transform:function(a,b,c,d,f,h){var e=this._stateList;S._scratchMatrix.set(a,b,c,d,f,h);T.multiply(e.matrix,S._scratchMatrix,
e.matrix)},restore:function(){this._stateList=this._stateList.prev},drawTexture:function(a,b,c){this.drawSubTexture(a,b,c,0,0,a.get_width(),a.get_height())},drawSubTexture:function(a,b,c,d,f,h,e){var g=this._stateList,i=a.root,b=this.transformQuad(b,c,h,e),c=i.width,i=i.height,d=(a.rootX+d)/c,f=(a.rootY+f)/i,h=d+h/c,e=f+e/i,c=g.alpha,a=this._batcher.prepareDrawTexture(this._renderTarget,g.blendMode,g.scissor,a),g=this._batcher.data;g[a]=b[0];g[++a]=b[1];g[++a]=d;g[++a]=f;g[++a]=c;g[++a]=b[2];g[++a]=
b[3];g[++a]=h;g[++a]=f;g[++a]=c;g[++a]=b[4];g[++a]=b[5];g[++a]=h;g[++a]=e;g[++a]=c;g[++a]=b[6];g[++a]=b[7];g[++a]=d;g[++a]=e;g[++a]=c},fillRect:function(a,b,c,d,f){var h=this._stateList,b=this.transformQuad(b,c,d,f),c=(a&16711680)/16711680,d=(a&65280)/65280,a=(a&255)/255,f=h.alpha,h=this._batcher.prepareFillRect(this._renderTarget,h.blendMode,h.scissor),e=this._batcher.data;e[h]=b[0];e[++h]=b[1];e[++h]=c;e[++h]=d;e[++h]=a;e[++h]=f;e[++h]=b[2];e[++h]=b[3];e[++h]=c;e[++h]=d;e[++h]=a;e[++h]=f;e[++h]=
b[4];e[++h]=b[5];e[++h]=c;e[++h]=d;e[++h]=a;e[++h]=f;e[++h]=b[6];e[++h]=b[7];e[++h]=c;e[++h]=d;e[++h]=a;e[++h]=f},multiplyAlpha:function(a){this._stateList.alpha*=a},setBlendMode:function(a){this._stateList.blendMode=a},applyScissor:function(a,b,c,d){var f=this._stateList,e=S._scratchQuadArray;e[0]=a;e[1]=b;e[2]=a+c;e[3]=b+d;f.matrix.transformArray(e,4,e);this._inverseProjection.transformArray(e,4,e);a=e[0];b=e[1];c=e[2]-a;d=e[3]-b;0>c&&(a+=c,c=-c);0>d&&(b+=d,d=-d);f.applyScissor(a,b,c,d)},willRender:function(){this._batcher.willRender()},
didRender:function(){this._batcher.didRender()},onResize:function(a,b){this._stateList=new fb;var c;c=null!=this._renderTarget?-1:1;this._stateList.matrix.set(2/a,0,0,-2*c/b,-1,c);this._inverseProjection=new T;this._inverseProjection.set(2/a,0,0,2/b,-1,-1);this._inverseProjection.invert()},transformQuad:function(a,b,c,d){var c=a+c,d=b+d,f=S._scratchQuadArray;f[0]=a;f[1]=b;f[2]=c;f[3]=b;f[4]=c;f[5]=d;f[6]=a;f[7]=d;this._stateList.matrix.transformArray(f,8,f);return f},__class__:S};var fb=function(){this.scissor=
this.prev=this.next=null;this.matrix=new T;this.alpha=1;this.blendMode=u.Normal};e["flambe.platform.html._WebGLGraphics.DrawingState"]=fb;fb.__name__=!0;fb.prototype={applyScissor:function(a,b,c,d){if(null!=this.scissor)var f=O.max(this.scissor.x,a),e=O.max(this.scissor.y,b),c=O.min(this.scissor.x+this.scissor.width,a+c),d=O.min(this.scissor.y+this.scissor.height,b+d),a=f,b=e,c=c-f,d=d-e;else this.scissor=new ma;this.scissor.set(Math.round(a),Math.round(b),Math.round(c),Math.round(d))},__class__:fb};
var Ma=function(a,b){var c=this;this._hasGPU=new H(!0);this.gl=b;b.canvas.addEventListener("webglcontextlost",function(a){a.preventDefault();c._hasGPU.set__(!1)},!1);b.canvas.addEventListener("webglcontextrestore",function(){c.init();c._hasGPU.set__(!0)},!1);a.resize.connect(w(this,this.onResize));this.init()};e["flambe.platform.html.WebGLRenderer"]=Ma;Ma.__name__=!0;Ma.__interfaces__=[Aa];Ma.prototype={get_type:function(){return R.WebGL},createTextureFromImage:function(a){if(this.gl.isContextLost())return null;
var b=new ga(this,a.width,a.height);b.uploadImageData(a);return b.createTexture(a.width,a.height)},getCompressedTextureFormats:function(){return[]},createCompressedTexture:function(){this.gl.isContextLost();return null},willRender:function(){this.graphics.willRender()},didRender:function(){this.graphics.didRender()},onResize:function(){var a=this.gl.canvas.width,b=this.gl.canvas.height;this.batcher.resizeBackbuffer(a,b);this.graphics.onResize(a,b)},init:function(){this.batcher=new Db(this.gl);this.graphics=
new S(this.batcher,null);this.onResize()},__class__:Ma};var gb=function(a,b,c){X.call(this,a,b,c)};e["flambe.platform.html.WebGLTexture"]=gb;gb.__name__=!0;gb.__super__=X;gb.prototype=o(X.prototype,{__class__:gb});var ga=function(a,b,c){this.framebuffer=this._graphics=null;this._disposed=!1;this._renderer=a;this.width=O.max(2,Bb.nextPowerOfTwo(b));this.height=O.max(2,Bb.nextPowerOfTwo(c));b=a.gl;this.nativeTexture=b.createTexture();a.batcher.bindTexture(this.nativeTexture);b.texParameteri(3553,10242,
33071);b.texParameteri(3553,10243,33071);b.texParameteri(3553,10240,9729);b.texParameteri(3553,10241,9728)};e["flambe.platform.html.WebGLTextureRoot"]=ga;ga.__name__=!0;ga.__interfaces__=[Xa];ga.drawBorder=function(a,b,c){var d=a.getContext("2d");d.drawImage(a,b-1,0,1,c,b,0,1,c);d.drawImage(a,0,c-1,b,1,0,c,b,1)};ga.__super__=C;ga.prototype=o(C.prototype,{createTexture:function(a,b){return new gb(this,a,b)},uploadImageData:function(a){if(this.width!=a.width||this.height!=a.height){var b=k.createEmptyCanvas(this.width,
this.height);b.getContext("2d").drawImage(a,0,0);ga.drawBorder(b,a.width,a.height);a=b}this._renderer.batcher.bindTexture(this.nativeTexture);this._renderer.gl.texImage2D(3553,0,6408,6408,5121,a)},readPixels:function(a,b,c,d){this.getGraphics();this._renderer.batcher.bindFramebuffer(this);var f=new Uint8Array(4*c*d);this._renderer.gl.readPixels(a,b,c,d,6408,5121,f);a=0;for(b=f.length;a<b;)c=255/f[a+3],f[a]*=c,++a,f[a]*=c,++a,f[a]*=c,a+=2;return qa.ofData(f)},getGraphics:function(){if(null==this._graphics){this._graphics=
new S(this._renderer.batcher,this);this._graphics.onResize(this.width,this.height);var a=this._renderer.gl;this.framebuffer=a.createFramebuffer();this._renderer.batcher.bindFramebuffer(this);a.framebufferTexture2D(36160,36064,3553,this.nativeTexture,0)}return this._graphics},onDisposed:function(){var a=this._renderer.batcher;a.deleteTexture(this);null!=this.framebuffer&&a.deleteFramebuffer(this);this._graphics=this.framebuffer=this.nativeTexture=null},__class__:ga});var M=function(a,b,c){c="#ifdef GL_ES\nprecision mediump float;\n#endif\n"+
c;this._gl=a;this._program=a.createProgram();a.attachShader(this._program,M.createShader(a,35633,b));a.attachShader(this._program,M.createShader(a,35632,c));a.linkProgram(this._program);a.useProgram(this._program)};e["flambe.platform.shader.ShaderGL"]=M;M.__name__=!0;M.createShader=function(a,b,c){b=a.createShader(b);a.shaderSource(b,c);a.compileShader(b);return b};M.prototype={useProgram:function(){this._gl.useProgram(this._program)},prepare:function(){null},getAttribLocation:function(a){return this._gl.getAttribLocation(this._program,
a)},getUniformLocation:function(a){return this._gl.getUniformLocation(this._program,a)},__class__:M};var db=function(a){M.call(this,a,"attribute highp vec2 a_pos;\nattribute mediump vec2 a_uv;\nattribute lowp float a_alpha;\nvarying mediump vec2 v_uv;\nvarying lowp float v_alpha;\nvoid main (void) {\nv_uv = a_uv;\nv_alpha = a_alpha;\ngl_Position = vec4(a_pos, 0, 1);\n}","varying mediump vec2 v_uv;\nvarying lowp float v_alpha;\nuniform lowp sampler2D u_texture;\nuniform mediump vec4 u_region;\nvoid main (void) {\ngl_FragColor = texture2D(u_texture, u_region.xy + mod(v_uv, u_region.zw)) * v_alpha;\n}");
this.a_pos=this.getAttribLocation("a_pos");this.a_uv=this.getAttribLocation("a_uv");this.a_alpha=this.getAttribLocation("a_alpha");this.u_texture=this.getUniformLocation("u_texture");this.u_region=this.getUniformLocation("u_region");this.setTexture(0)};e["flambe.platform.shader.DrawPatternGL"]=db;db.__name__=!0;db.__super__=M;db.prototype=o(M.prototype,{setTexture:function(a){this._gl.uniform1i(this.u_texture,a)},setRegion:function(a,b,c,d){this._gl.uniform4f(this.u_region,a,b,c,d)},prepare:function(){this._gl.enableVertexAttribArray(this.a_pos);
this._gl.enableVertexAttribArray(this.a_uv);this._gl.enableVertexAttribArray(this.a_alpha);this._gl.vertexAttribPointer(this.a_pos,2,5126,!1,20,0);this._gl.vertexAttribPointer(this.a_uv,2,5126,!1,20,8);this._gl.vertexAttribPointer(this.a_alpha,1,5126,!1,20,16)},__class__:db});var cb=function(a){M.call(this,a,"attribute highp vec2 a_pos;\nattribute mediump vec2 a_uv;\nattribute lowp float a_alpha;\nvarying mediump vec2 v_uv;\nvarying lowp float v_alpha;\nvoid main (void) {\nv_uv = a_uv;\nv_alpha = a_alpha;\ngl_Position = vec4(a_pos, 0, 1);\n}",
"varying mediump vec2 v_uv;\nvarying lowp float v_alpha;\nuniform lowp sampler2D u_texture;\nvoid main (void) {\ngl_FragColor = texture2D(u_texture, v_uv) * v_alpha;\n}");this.a_pos=this.getAttribLocation("a_pos");this.a_uv=this.getAttribLocation("a_uv");this.a_alpha=this.getAttribLocation("a_alpha");this.u_texture=this.getUniformLocation("u_texture");this.setTexture(0)};e["flambe.platform.shader.DrawTextureGL"]=cb;cb.__name__=!0;cb.__super__=M;cb.prototype=o(M.prototype,{setTexture:function(a){this._gl.uniform1i(this.u_texture,
a)},prepare:function(){this._gl.enableVertexAttribArray(this.a_pos);this._gl.enableVertexAttribArray(this.a_uv);this._gl.enableVertexAttribArray(this.a_alpha);this._gl.vertexAttribPointer(this.a_pos,2,5126,!1,20,0);this._gl.vertexAttribPointer(this.a_uv,2,5126,!1,20,8);this._gl.vertexAttribPointer(this.a_alpha,1,5126,!1,20,16)},__class__:cb});var eb=function(a){M.call(this,a,"attribute highp vec2 a_pos;\nattribute lowp vec3 a_rgb;\nattribute lowp float a_alpha;\nvarying lowp vec4 v_color;\nvoid main (void) {\nv_color = vec4(a_rgb*a_alpha, a_alpha);\ngl_Position = vec4(a_pos, 0, 1);\n}",
"varying lowp vec4 v_color;\nvoid main (void) {\ngl_FragColor = v_color;\n}");this.a_pos=this.getAttribLocation("a_pos");this.a_rgb=this.getAttribLocation("a_rgb");this.a_alpha=this.getAttribLocation("a_alpha")};e["flambe.platform.shader.FillRectGL"]=eb;eb.__name__=!0;eb.__super__=M;eb.prototype=o(M.prototype,{prepare:function(){this._gl.enableVertexAttribArray(this.a_pos);this._gl.enableVertexAttribArray(this.a_rgb);this._gl.enableVertexAttribArray(this.a_alpha);this._gl.vertexAttribPointer(this.a_pos,
2,5126,!1,24,0);this._gl.vertexAttribPointer(this.a_rgb,3,5126,!1,24,8);this._gl.vertexAttribPointer(this.a_alpha,1,5126,!1,24,20)},__class__:eb});var Eb=function(){this._transitor=null};e["flambe.scene.Director"]=Eb;Eb.__name__=!0;Eb.__super__=r;Eb.prototype=o(r.prototype,{get_name:function(){return"Director_7"},onAdded:function(){this.owner.addChild(this._root)},onRemoved:function(){this.completeTransition();for(var a=0,b=this.scenes;a<b.length;){var c=b[a];++a;c.dispose()}this.scenes=[];this.occludedScenes=
[];this._root.dispose()},onUpdate:function(a){null!=this._transitor&&this._transitor.update(a)&&this.completeTransition()},get_topScene:function(){var a=this.scenes.length;return 0<a?this.scenes[a-1]:null},show:function(a){a=a._compMap.Scene_9;null!=a&&a.shown.emit()},invalidateVisibility:function(){for(var a=this.scenes.length;0<a;){var b=this.scenes[--a]._compMap.Scene_9;if(null==b||b.opaque)break}this.occludedScenes=0<this.scenes.length?this.scenes.slice(a,this.scenes.length-1):[];a=this.get_topScene();
null!=a&&this.show(a)},completeTransition:function(){null!=this._transitor&&(this._transitor.complete(),this._transitor=null,this.invalidateVisibility())},__class__:Eb});var Tb=function(){};e["flambe.scene._Director.Transitor"]=Tb;Tb.__name__=!0;Tb.prototype={update:function(a){return this._transition.update(a)},complete:function(){this._transition.complete();this._onComplete()},__class__:Tb};var Fb=function(){};e["flambe.scene.Scene"]=Fb;Fb.__name__=!0;Fb.__super__=r;Fb.prototype=o(r.prototype,{get_name:function(){return"Scene_9"},
__class__:Fb});var Ub=function(){};e["flambe.scene.Transition"]=Ub;Ub.__name__=!0;Ub.prototype={update:function(){return!0},complete:function(){},__class__:Ub};var R=e["flambe.subsystem.RendererType"]={__ename__:!0,__constructs__:["Stage3D","WebGL","Canvas"]};R.Stage3D=["Stage3D",0];R.Stage3D.toString=m;R.Stage3D.__enum__=R;R.WebGL=["WebGL",1];R.WebGL.toString=m;R.WebGL.__enum__=R;R.Canvas=["Canvas",2];R.Canvas.toString=m;R.Canvas.__enum__=R;var hb=function(){};e["flambe.swf.Symbol"]=hb;hb.__name__=
!0;hb.prototype={__class__:hb};var ib=function(a,b){this._name=a.symbol;var c=a.rect;this.texture=b.subTexture(c[0],c[1],c[2],c[3]);c=a.origin;null!=c?(this.anchorX=c[0],this.anchorY=c[1]):this.anchorY=this.anchorX=0};e["flambe.swf.BitmapSymbol"]=ib;ib.__name__=!0;ib.__interfaces__=[hb];ib.prototype={createSprite:function(){var a=new x(this.texture);a.setAnchor(this.anchorX,this.anchorY);return a},__class__:ib};var kb=function(a,b){this._file=a.getFile(b+"/library.json");var c=JSON.parse(this._file.toString());
this._symbols=new W;this.frameRate=c.frameRate;for(var d=[],f=0,e=c.movies;f<e.length;){var g=e[f];++f;g=new jb(this,g);d.push(g);this._symbols.set(g._name,g)}c=c.textureGroups;(1!=c[0].scaleFactor||1<c.length)&&null;c=c[0].atlases;for(f=0;f<c.length;){var i=c[f];++f;e=a.getTexture(b+"/"+B.removeFileExtension(i.file));g=0;for(i=i.textures;g<i.length;){var j=i[g];++g;j=new ib(j,e);this._symbols.set(j._name,j)}}for(c=0;c<d.length;){e=d[c];++c;f=0;for(e=e.layers;f<e.length;){g=e[f];++f;g=g.keyframes;
i=g.length;for(j=0;j<i;){var k=j++,l=g[k];if(null!=l.symbolName){var m=this._symbols.get(l.symbolName);l.symbol=m}if(l.tweened&&1==l.duration&&k+1<i&&(k=g[k+1],!k.visible||null==k.symbolName))l.visible=!1}}}};e["flambe.swf.Library"]=kb;kb.__name__=!0;kb.prototype={createSprite:function(a,b){null==b&&(b=!0);var c=this._symbols.get(a);if(null==c){if(b)throw B.withFields("Missing symbol",["name",a]);return null}return c.createSprite()},__class__:kb};var ha=function(a){this._oneshotSprite=this._loopingSprite=
null;r.call(this);this._lib=a;this._root=new n;this.movie=new H(null);this.setCache(!0)};e["flambe.swf.MoviePlayer"]=ha;ha.__name__=!0;ha.__super__=r;ha.prototype=o(r.prototype,{get_name:function(){return"MoviePlayer_6"},setCache:function(a){this._cache=a?new W:null;return this},loop:function(a,b){null==b&&(b=!0);if(b||null==this._loopingSprite||this._loopingSprite.symbol._name!=a)this._oneshotSprite=null,this._loopingSprite=this.playFromCache(a);return this},onAdded:function(){this.owner.addChild(this._root)},
onRemoved:function(){this._root.dispose();this._oneshotSprite=this._loopingSprite=null;this.movie.set__(null)},onUpdate:function(a){null!=this._oneshotSprite&&this._oneshotSprite._position+a>this._oneshotSprite.symbol.duration&&(this._oneshotSprite=null,this.setCurrent(this._loopingSprite))},playFromCache:function(a){var b;null!=this._cache?(b=this._cache.get(a),null!=b?b.set_position(0):(b=this.createMovie(a),this._cache.set(a,b))):b=this.createMovie(a);return this.setCurrent(b)},createMovie:function(a){a=
this._lib.createSprite(a,!0);null!=this._decorator&&this._decorator(a);return a},setCurrent:function(a){this._root.add(a);return this.movie.set__(a)},__class__:ha});var Da=function(a){this._looped=null;j.call(this);this.symbol=a;this.speed=new v(1);this._animators=Array(a.layers.length);for(var b=0,c=this._animators.length;b<c;){var d=b++;this._animators[d]=new Gb(a.layers[d])}this._position=this._frame=0;this["goto"](1)};e["flambe.swf.MovieSprite"]=Da;Da.__name__=!0;Da.__super__=j;Da.prototype=o(j.prototype,
{getLayer:function(a,b){null==b&&(b=!0);for(var c=0,d=this._animators;c<d.length;){var f=d[c];++c;if(f.layer.name==a)return f.content}if(b)throw B.withFields("Missing layer",["name",a]);return null},onAdded:function(){j.prototype.onAdded.call(this);for(var a=0,b=this._animators;a<b.length;){var c=b[a];++a;this.owner.addChild(c.content)}},onRemoved:function(){j.prototype.onRemoved.call(this);for(var a=0,b=this._animators;a<b.length;){var c=b[a];++a;this.owner.removeChild(c.content)}},onUpdate:function(a){j.prototype.onUpdate.call(this,
a);this.speed.update(a);switch(this._flags&384){case 0:this._position+=this.speed._value*a;this._position>this.symbol.duration&&(this._position%=this.symbol.duration,null!=this._looped&&this._looped.emit());break;case 256:this._flags&=-257}this["goto"](this._position*this.symbol.frameRate)},"goto":function(a){if(this._frame!=a){if(a<this._frame)for(var b=0,c=this._animators;b<c.length;){var d=c[b];++b;d.needsKeyframeUpdate=!0;d.keyframeIdx=0}b=0;for(c=this._animators;b<c.length;)d=c[b],++b,d.composeFrame(a);
this._frame=a}},set_position:function(a){return this._position=O.clamp(a,0,this.symbol.duration)},set_paused:function(a){this._flags=rb.set(this._flags,128,a);return a},get_looped:function(){null==this._looped&&(this._looped=new V);return this._looped},rewind:function(){this._position=0;this._flags|=256},__class__:Da});var Gb=function(a){this.keyframeIdx=0;this.needsKeyframeUpdate=!1;this.layer=a;this.content=new n;if(a.empty)this._sprites=null;else{this._sprites=Array(a.keyframes.length);for(var b=
0,c=this._sprites.length;b<c;){var d=b++,f=a.keyframes[d];this._sprites[d]=0<d&&a.keyframes[d-1].symbol==f.symbol?this._sprites[d-1]:null==f.symbol?new j:f.symbol.createSprite()}this.content.add(this._sprites[0])}};e["flambe.swf._MovieSprite.LayerAnimator"]=Gb;Gb.__name__=!0;Gb.prototype={composeFrame:function(a){if(null!=this._sprites){var b=this.layer.keyframes,c=b.length-1;if(a>this.layer.frames)this.content._compMap.Sprite_4.set_visible(!1),this.keyframeIdx=c,this.needsKeyframeUpdate=!0;else{for(;this.keyframeIdx<
c&&b[this.keyframeIdx+1].index<=a;)++this.keyframeIdx,this.needsKeyframeUpdate=!0;var d;this.needsKeyframeUpdate?(this.needsKeyframeUpdate=!1,d=this._sprites[this.keyframeIdx],d!=this.content._compMap.Sprite_4&&(Ha.getClass(d)==Da&&d.rewind(),this.content.add(d))):d=this.content._compMap.Sprite_4;var f=b[this.keyframeIdx],e=f.visible&&null!=f.symbol;d.set_visible(e);if(e){var e=f.x,g=f.y,i=f.scaleX,j=f.scaleY,k=f.skewX,l=f.skewY,m=f.alpha;if(f.tweened&&this.keyframeIdx<c){a=(a-f.index)/f.duration;
c=f.ease;if(0!=c){var n;0>c?(n=1-a,n=1-n*n,c=-c):n=a*a;a=c*n+(1-c)*a}b=b[this.keyframeIdx+1];e+=(b.x-e)*a;g+=(b.y-g)*a;i+=(b.scaleX-i)*a;j+=(b.scaleY-j)*a;k+=(b.skewX-k)*a;l+=(b.skewY-l)*a;m+=(b.alpha-m)*a}b=d.getLocalMatrix();a=Math.sin(k);k=Math.cos(k);c=Math.sin(l);l=Math.cos(l);b.set(l*i,c*i,-a*j,k*j,e,g);b.translate(-f.pivotX,-f.pivotY);d.alpha.set__(m)}}}},__class__:Gb};var jb=function(a,b){this._name=b.id;this.frameRate=a.frameRate;this.frames=0;this.layers=Array(b.layers.length);for(var c=
0,d=this.layers.length;c<d;){var f=c++,e=new Hb(b.layers[f]);this.frames=Math.max(e.frames,this.frames);this.layers[f]=e}this.duration=this.frames/this.frameRate};e["flambe.swf.MovieSymbol"]=jb;jb.__name__=!0;jb.__interfaces__=[hb];jb.prototype={createSprite:function(){return new Da(this)},__class__:jb};var Hb=function(a){this.empty=!0;this.name=a.name;var b=null;this.keyframes=Array(a.keyframes.length);for(var c=0,d=this.keyframes.length;c<d;){var f=c++,b=new Ib(a.keyframes[f],b);this.keyframes[f]=
b;this.empty=this.empty&&null==b.symbolName}this.frames=null!=b?b.index+b.duration:0};e["flambe.swf.MovieLayer"]=Hb;Hb.__name__=!0;Hb.prototype={__class__:Hb};var Ib=function(a,b){this.ease=0;this.visible=this.tweened=!0;this.alpha=1;this.skewX=this.skewY=this.pivotX=this.pivotY=0;this.scaleX=this.scaleY=1;this.x=this.y=0;this.symbol=null;this.index=null!=b?b.index+b.duration:0;this.duration=a.duration;this.label=a.label;this.symbolName=a.ref;var c=a.loc;null!=c&&(this.x=c[0],this.y=c[1]);c=a.scale;
null!=c&&(this.scaleX=c[0],this.scaleY=c[1]);c=a.skew;null!=c&&(this.skewX=c[0],this.skewY=c[1]);c=a.pivot;null!=c&&(this.pivotX=c[0],this.pivotY=c[1]);null!=a.alpha&&(this.alpha=a.alpha);null!=a.visible&&(this.visible=a.visible);null!=a.tweened&&(this.tweened=a.tweened);null!=a.ease&&(this.ease=a.ease)};e["flambe.swf.MovieKeyframe"]=Ib;Ib.__name__=!0;Ib.prototype={__class__:Ib};var Qb=function(){};e["flambe.util.Assert"]=Qb;Qb.__name__=!0;Qb.that=function(){};var rb=function(){};e["flambe.util.BitSets"]=
rb;rb.__name__=!0;rb.set=function(a,b,c){return c?a|b:a&~b};var Ta=function(){this.success=new t;this.error=new t;this.progressChanged=new V;this.hasResult=!1;this._total=this._progress=0};e["flambe.util.Promise"]=Ta;Ta.__name__=!0;Ta.prototype={set_result:function(a){if(this.hasResult)throw"Promise result already assigned";this._result=a;this.hasResult=!0;this.success.emit(a);return a},get:function(a){return this.hasResult?(a(this._result),null):this.success.connect(a).once()},set_progress:function(a){this._progress!=
a&&(this._progress=a,this.progressChanged.emit());return a},set_total:function(a){this._total!=a&&(this._total=a,this.progressChanged.emit());return a},__class__:Ta};var V=function(a){A.call(this,a)};e["flambe.util.Signal0"]=V;V.__name__=!0;V.__super__=A;V.prototype=o(A.prototype,{connect:function(a,b){null==b&&(b=!1);return this.connectImpl(a,b)},emit:function(){var a=this;this._head==A.DISPATCHING_SENTINEL?this.defer(function(){a.emitImpl()}):this.emitImpl()},emitImpl:function(){for(var a=this.willEmit(),
b=a;null!=b;)b._listener(),b.stayInList||b.dispose(),b=b._next;this.didEmit(a)},__class__:V});var ob=function(a){this.next=null;this.fn=a};e["flambe.util._SignalBase.Task"]=ob;ob.__name__=!0;ob.prototype={__class__:ob};var B=function(){};e["flambe.util.Strings"]=B;B.__name__=!0;B.getFileExtension=function(a){var b=a.lastIndexOf(".");return 0<b?y.substr(a,b+1,null):null};B.removeFileExtension=function(a){var b=a.lastIndexOf(".");return 0<b?y.substr(a,0,b):a};B.getUrlExtension=function(a){var b=a.lastIndexOf("?");
0<=b&&(a=y.substr(a,0,b));b=a.lastIndexOf("/");0<=b&&(a=y.substr(a,b+1,null));return B.getFileExtension(a)};B.joinPath=function(a,b){0<a.length&&47!=a.charCodeAt(a.length-1)&&(a+="/");return a+b};B.withFields=function(a,b){var c=b.length;if(0<c){for(var a=0<a.length?a+" [":a+"[",d=0;d<c;){0<d&&(a+=", ");var f=b[d],e=b[d+1];if(z.is(e,Error)){var g=e.stack;null!=g&&(e=g)}a+=f+"="+z.string(e);d+=2}a+="]"}return a};var Z=function(){this.h={}};e["haxe.ds.IntMap"]=Z;Z.__name__=!0;Z.__interfaces__=[Kb];
Z.prototype={set:function(a,b){this.h[a]=b},get:function(a){return this.h[a]},exists:function(a){return this.h.hasOwnProperty(a)},remove:function(a){if(!this.h.hasOwnProperty(a))return!1;delete this.h[a];return!0},__class__:Z};var W=function(){this.h={}};e["haxe.ds.StringMap"]=W;W.__name__=!0;W.__interfaces__=[Kb];W.prototype={set:function(a,b){this.h["$"+a]=b},get:function(a){return this.h["$"+a]},keys:function(){var a=[],b;for(b in this.h)this.h.hasOwnProperty(b)&&a.push(b.substr(1));return y.iter(a)},
iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){return this.ref["$"+this.it.next()]}}},__class__:W};var qa=function(a,b){this.length=a;this.b=b};e["haxe.io.Bytes"]=qa;qa.__name__=!0;qa.ofData=function(a){return new qa(a.length,a)};qa.prototype={__class__:qa};var Vb=function(){};e["haxe.io.Eof"]=Vb;Vb.__name__=!0;Vb.prototype={toString:function(){return"Eof"},__class__:Vb};var Pb=function(){};e["haxe.rtti.Meta"]=Pb;Pb.__name__=!0;Pb.getType=
function(a){a=a.__meta__;return null==a||null==a.obj?{}:a.obj};var E=function(){};e["js.Boot"]=E;E.__name__=!0;E.getClass=function(a){return a instanceof Array&&null==a.__enum__?Array:a.__class__};E.__string_rec=function(a,b){if(null==a)return"null";if(5<=b.length)return"<...>";var c=typeof a;if("function"==c&&(a.__name__||a.__ename__))c="object";switch(c){case "object":if(a instanceof Array){if(a.__enum__){if(2==a.length)return a[0];for(var c=a[0]+"(",b=b+"\t",d=2,f=a.length;d<f;)var e=d++,c=2!=
e?c+(","+E.__string_rec(a[e],b)):c+E.__string_rec(a[e],b);return c+")"}c=a.length;d="[";b+="\t";for(f=0;f<c;)e=f++,d+=(0<e?",":"")+E.__string_rec(a[e],b);return d+"]"}try{d=a.toString}catch(g){return"???"}if(null!=d&&d!=Object.toString&&(c=a.toString(),"[object Object]"!=c))return c;c=null;d="{\n";b+="\t";f=null!=a.hasOwnProperty;for(c in a)if(!f||a.hasOwnProperty(c))"prototype"==c||"__class__"==c||"__super__"==c||"__interfaces__"==c||"__properties__"==c||(2!=d.length&&(d+=", \n"),d+=b+c+" : "+E.__string_rec(a[c],
b));b=b.substring(1);return d+("\n"+b+"}");case "function":return"<function>";case "string":return a;default:return""+a}};E.__interfLoop=function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var d=0,f=c.length;d<f;){var e=d++,e=c[e];if(e==b||E.__interfLoop(e,b))return!0}return E.__interfLoop(a.__super__,b)};E.__instanceof=function(a,b){if(null==b)return!1;switch(b){case ac:return(a|0)===a;case Yb:return"number"==typeof a;case Zb:return"boolean"==typeof a;case String:return"string"==
typeof a;case Array:return a instanceof Array&&null==a.__enum__;case bc:return!0;default:if(null!=a){if("function"==typeof b&&(a instanceof b||E.__interfLoop(E.getClass(a),b)))return!0}else return!1;return b==cc&&null!=a.__name__||b==dc&&null!=a.__ename__?!0:a.__enum__==b}};var Nb=function(){};e["js.html._CanvasElement.CanvasUtil"]=Nb;Nb.__name__=!0;Nb.getContextWebGL=function(a,b){for(var c=0,d=["webgl","experimental-webgl"];c<d.length;){var f=d[c];++c;f=a.getContext(f,b);if(null!=f)return f}return null};
var K=function(){this.touched=0;this.speed=0.75;this.fixedSpeed=0.5;this.textEntity=new n;r.call(this)};e["urgame.Balloon"]=K;K.__name__=!0;K.__super__=r;K.prototype=o(r.prototype,{get_name:function(){return"Balloon_1"},onAdded:function(){this.speed=this.fixedSpeed+0.5*Math.random()*this.fixedSpeed;this.answerSprite=new ca(l.font);this.sprite=new x(l.assetPack.getTexture("balloon"));var a=new kb(l.assetPack,"BaloonAnim");this.moviePlayer=new ha(a);this.owner.add(this.moviePlayer);this.moviePlayer.loop("Sway");
this.startAnimAfter=100*Math.random();this.movieSprite=this.moviePlayer.movie._value;this.movieSprite.set_paused(!0);this.swfEntity=this.movieSprite.getLayer("L1");a=j.getBounds(this.owner);this.width=a.width;this.height=a.height;this.owner._compMap.Sprite_4.get_pointerDown().connect(w(this,this.handleTouch)).once();s.popBalloon.connect(w(this,this.mapBalloon))},setSpeed:function(a){this.speed=a},handleTouch:function(a){this.touchPointX=a.viewX;this.touchPointY=a.viewY;D.poppedBalloon=this;this.touched=
1;s.checkAnswer.emit()},mapBalloon:function(){var a=this.touched;if(1==(0>a?4294967296+a:a+0)){this.owner._compMap.Sprite_4.set_visible(!1);if(null==K.particlesArrayCopyForOthers){K.particlesArrayCopyForOthers=[];for(var a=this.height,b=this.width,c=Math.floor(b/3),d=Math.floor(a/3),f=0;f<c;)for(var e=f++,g=0;g<d;){var i=g++,j=this.sprite.texture.readPixels(3*e,3*i,1,1).b;if(0<j.length&&0!=j[j.length-1]){var j=new Ea,k=3*e;j.x=0>k?4294967296+k:k+0;i*=3;j.y=0>i?4294967296+i:i+0;j.acc_x=0;j.acc_y=j.gravity;
i=Math.random()*j.xSpeed;k=Math.random()*j.ySpeed+3;j.x<=0.5*b&&j.y<=0.5*a?(j.vel_x=-i,j.vel_y=-k):j.x>0.5*b&&j.y<=0.5*a?(j.vel_x=i,j.vel_y=-k):j.x<=0.5*b&&j.y>0.5*a?(j.vel_x=-i,j.vel_y=k):j.x>0.5*b&&j.y>0.5*a&&(j.vel_x=i,j.vel_y=k);K.particlesArrayCopyForOthers.push(j)}}}this.createBurst()}},createBurst:function(){var a=new n;null==K.balloonParticles&&(K.balloonParticles=[]);for(var b=0,c=K.particlesArrayCopyForOthers;b<c.length;){var d=c[b];++b;var e;e=0<K.balloonParticles.length?K.balloonParticles.shift():
new x(l.assetPack.getTexture("balloonparticle"));var h=new n,g=new Ea;g.copyFrom(d);g.x+=this.touchPointX-0.5*this.width;g.y+=this.touchPointY-0.5*this.height;var d=Math.random()*g.xSpeed,j=Math.random()*g.ySpeed+3;g.vel_x=0<g.vel_x?d:-d;g.vel_y=0<g.vel_y?j:-j;h.add(e).add(g);h._compMap.Sprite_4.x.set__(g.x);h._compMap.Sprite_4.y.set__(g.y);a.addChild(h)}i.root.addChild(a);s.nextQuestion.emit()},onUpdate:function(){0<this.startAnimAfter&&(this.startAnimAfter--,0>=this.startAnimAfter&&this.movieSprite.set_paused(!1));
var a=this.owner._compMap.Sprite_4.y;a.set__(a._value-this.speed);this.owner._compMap.Sprite_4.y._value<-this.height&&0!=this.speed&&(this.speed=0,K.balloonsPerQ--,0==function(){var a=s.nextQSignalEmitted;return 0>a?4294967296+a:a+0}(this)&&0==function(){var a=K.balloonsPerQ;return 0>a?4294967296+a:a+0}(this)&&(s.nextQSignalEmitted=1,s.nextQuestion.emit()))},addAnswer:function(a){this.answerString=a;this.owner.addChild(this.textEntity.add(this.answerSprite));this.answerSprite.set_text(a);a=j.getBounds(this.textEntity);
this.answerSprite.x.set__(0.5*-a.width);this.answerSprite.y.set__(0.5*-a.height);this.swfEntity.addChild(this.textEntity)},resetTouch:function(){this.touched=0;this.owner._compMap.Sprite_4.get_pointerDown().connect(w(this,this.handleTouch)).once()},reset:function(){this.touched=0;this.speed=this.fixedSpeed+0.5*Math.random()*this.fixedSpeed;this.owner._compMap.Sprite_4.set_visible(!0);this.startAnimAfter=100*Math.random();this.movieSprite.set_paused(!0)},__class__:K});var ra=function(){};e["urgame.Constants"]=
ra;ra.__name__=!0;var D=function(){this.changeInSpeed=0.1;this.balloonSpeed=0.75;this.livesEntity=new n;this.levelUpMarker=10;this.playerScore=this.showNextQuestion=0;r.call(this);this.init()};e["urgame.Game"]=D;D.__name__=!0;D.__super__=r;D.prototype=o(r.prototype,{get_name:function(){return"Game_0"},init:function(){this.currentLevel=1;this.background=new x(l.assetPack.getTexture("background"));i.root.addChild((new n).add(this.background));var a=new kb(l.assetPack,"LevelUpAnim");this.levelUpMoviePlayer=
new ha(a);this.levelUpMoviePlayer.loop("levelupAnim");this.levelUpMovieSprite=this.levelUpMoviePlayer.movie._value;this.levelUpMovieSprite.x.set__(0.5*i._platform.getStage().get_width());this.levelUpMovieSprite.y.set__(0.5*i._platform.getStage().get_height());this.levelUpMovieSprite.set_visible(!1);this.levelUpMovieSprite.set_paused(!0);this.levelUpMoviePlayer.setCache(!0);this.wowAnim=new ha(a);this.wowAnim.loop("WowAnim");this.wowMovieSprite=this.wowAnim.movie._value;this.wowMovieSprite.x.set__(0.5*
i._platform.getStage().get_width());this.wowMovieSprite.y.set__(0.5*i._platform.getStage().get_height());this.wowMovieSprite.set_visible(!1);this.wowMovieSprite.set_paused(!0);this.wowAnim.setCache(!0);this.goodjobAnim=new ha(a);this.goodjobAnim.loop("goodjobAnim");this.goodjobMovieSprite=this.goodjobAnim.movie._value;this.goodjobMovieSprite.x.set__(0.5*i._platform.getStage().get_width());this.goodjobMovieSprite.y.set__(0.5*i._platform.getStage().get_height());this.goodjobMovieSprite.set_visible(!1);
this.goodjobMovieSprite.set_paused(!0);this.goodjobAnim.setCache(!0);var b=a=2;this.operationSelectorEntity=(new n).add(new x(l.assetPack.getTexture("selectOp")));this.operatorImages=[new sa("+",new x(l.assetPack.getTexture("plus"))),new sa("-",new x(l.assetPack.getTexture("minus"))),new sa("x",new x(l.assetPack.getTexture("multiply"))),new sa("div",new x(l.assetPack.getTexture("divide")))];for(var c=0;4>c;){var d=c++,e=this.operatorImages[d].image;e.x.set__(0.5*(i._platform.getStage().get_width()/
b)+i._platform.getStage().get_width()/b*(d/2|0)-0.5*e.texture.get_width());e.y.set__(0.5*(i._platform.getStage().get_height()/a)+i._platform.getStage().get_height()/a*(d%2)-0.5*e.texture.get_height()+ra.padding);this.operationSelectorEntity.addChild((new n).add(e))}a=3;b=5;this.levelSelectorEntity=(new n).addChild((new n).add(new x(l.assetPack.getTexture("LevelSelectBG"))));c=0;for(d=D.maxLevel;c<d;){var e=c++,h=new L;h.updateLevel(""+(e+1));this.levelSelectorEntity.addChild(h.getButton());h.setPosition(e%
b*(i._platform.getStage().get_width()/b)+0.5*(i._platform.getStage().get_width()/b)-0.5*j.getBounds(h.getButton()).width,Math.floor(e/b)*(i._platform.getStage().get_height()/a)+0.5*(i._platform.getStage().get_height()/a)-0.5*j.getBounds(h.getButton()).height)}this.questionArea=new Fa;this.scoreArea=new n;this.scoreSprite=new ca(l.font,""+z.string(function(a){a=a.playerScore;return 0>a?4294967296+a:a+0}(this)));this.gameOverEntity=new n;this.gameOverImage=new x(l.assetPack.getTexture("gameover"));
this.gameOverImage.x.set__(0.5*i._platform.getStage().get_width()-0.5*this.gameOverImage.texture.get_width());this.gameOverImage.y.set__(0.5*i._platform.getStage().get_height()-0.5*this.gameOverImage.texture.get_height());this.gameOverEntity.add(this.gameOverImage);s.startGame.connect(w(this,this.startGameLoop)).once();s.showLevel.connect(w(this,this.drawLevel)).once();s.gameOver.connect(w(this,this.endGame)).once();s.setSign.connect(w(this,this.operatorSelected)).once()},onAdded:function(){this.owner.addChild(this.operationSelectorEntity);
this.owner.addChild((new n).add(this.levelUpMoviePlayer));this.owner.addChild((new n).add(this.goodjobAnim));this.owner.addChild((new n).add(this.wowAnim))},removeAnim:function(){this.movieSprite.set_paused(!0);this.movieSprite.set_visible(!1)},operatorSelected:function(a){this.owner.removeChild(this.operationSelectorEntity);D.operator=a;this.questionArea.loadQuestions()},showLevels:function(){this.owner.addChild(this.levelSelectorEntity)},startGameLoop:function(a){this.currentLevel=z.parseInt(a);
this.hideLevels();this.createLives();this.showScore();this.showQuestion();this.createBalloons()},drawLevel:function(){this.showLevels()},hideLevels:function(){this.owner.removeChild(this.levelSelectorEntity)},createLives:function(){this.lives=new lb;i.root.addChild(this.livesEntity.add(this.lives));this.lives.displayLives()},createBalloons:function(){if(null!=this.currentQuestion){this.currentAnswers=this.currentQuestion.answers;for(var a=i._platform.getStage().get_width()/this.currentAnswers.length,
b=0,c=this.currentAnswers.length;b<c;){var d=b++,e,h;if(1==function(a){a=a.showNextQuestion;return 0>a?4294967296+a:a+0}(this)&&null!=this.balloons&&0<this.balloons.length&&d<this.balloons.length)e=this.balloons[d],h=e._compMap.Balloon_1,h.reset();else{h=new K;e=(new n).add((new j).setXY(i._platform.getStage().get_width(),i._platform.getStage().get_height())).add(h);this.balloons=null==this.balloons?[]:this.balloons;this.balloons.push(e);var g=j.getBounds(e);h.height=g.height;h.width=g.width}h.setSpeed(this.balloonSpeed+
function(a){a=a.currentLevel;return 0>a?4294967296+a:a+0}(this)*this.changeInSpeed);g=e._compMap.Sprite_4;h.addAnswer(this.currentAnswers[d].toString());g.x.set__(Math.random()*(a-2*h.width)+0.5*h.width+a*d);g.y.set__(i._platform.getStage().get_height()+h.height);this.owner.addChild(e,!0)}K.balloonsPerQ=this.currentAnswers.length;this.showNextQuestion=s.nextQSignalEmitted=0;s.nextQuestion.connect(w(this,this.removeBalloons)).once();s.checkAnswer.connect(w(this,this.checkAnswer))}},showScore:function(){var a=
new x(l.assetPack.getTexture("ScoreBoard@2x"));a.scaleX.set__(a.scaleY.set__(0.25));a.x.set__(i._platform.getStage().get_width()-0.25*a.texture.get_width()-ra.padding);a.y.set__(ra.padding);this.scoreArea.addChild((new n).add(a));this.scoreSprite.set_text(""+z.string(function(a){a=a.playerScore;return 0>a?4294967296+a:a+0}(this)));this.scoreSprite.set_align(I.Center);var b=(new n).add(this.scoreSprite);this.scoreArea.addChild(b);b=j.getBounds(b);this.scoreSprite.x.set__(a.x._value+0.125*a.texture.get_width());
this.scoreSprite.y.set__(a.y._value+0.125*a.texture.get_height()-0.5*b.height);this.owner.addChild(this.scoreArea)},showQuestion:function(){this.currentQuestion=this.questionArea.displayNextQ();if(null!=this.currentQuestion)if(null==this.questionAreaEntity){this.questionAreaEntity=null==this.questionAreaEntity?new n:this.questionAreaEntity;var a=new x(l.assetPack.getTexture("QuestionBoard@2x"));a.x.set__(0.5*i._platform.getStage().get_width()-0.5*a.texture.get_width());a.y.set__(i._platform.getStage().get_height()-
a.texture.get_height());this.questionAreaEntity.add(a);this.questionEntity=new n;this.questionSprite=new ca(l.font,this.currentQuestion.question);this.questionSprite.set_align(I.Center);this.questionEntity.addChild((new n).add(this.questionSprite));this.questionSprite.x.set__(0.5*a.texture.get_width());this.questionSprite.y.set__(0.5*a.texture.get_height()-0.5*j.getBounds(this.questionEntity).height);this.questionAreaEntity.addChild(this.questionEntity);this.owner.addChild(this.questionAreaEntity)}else this.questionSprite.set_text(this.currentQuestion.question)},
removeBalloons:function(){for(var a=0,b=this.balloons.length;a<b;)this.owner.removeChild(this.balloons[a++]);this.showNextQuestion=1;this.showQuestion();this.createBalloons()},updateScore:function(){this.scoreSprite.set_text(""+z.string(function(a){a=a.playerScore;return 0>a?4294967296+a:a+0}(this)))},checkAnswer:function(){if(null!=D.poppedBalloon)if(D.poppedBalloon.answerString==this.currentQuestion.correctAnswer){this.playerScore++;if(0==function(a){a=function(a){a=a.playerScore;return 0>a?4294967296+
a:a+0}(a)%function(a){a=a.levelUpMarker;return 0>a?4294967296+a:a+0}(a)|0;return 0>a?4294967296+a:a+0}(this)&&function(a){var a=a.currentLevel,c=D.maxLevel,d=0>c;return d!=0>a?d:c>a}(this))this.currentLevel++,this.moviePlayer=this.levelUpMoviePlayer,this.movieSprite=this.moviePlayer.movie._value,this.movieSprite.get_looped().connect(w(this,this.removeAnim)).once(),this.movieSprite.set_paused(!1),this.movieSprite.set_visible(!0);else{var a=Math.random();0.15>a?(this.moviePlayer=this.goodjobAnim,this.movieSprite=
this.moviePlayer.movie._value,this.movieSprite.get_looped().connect(w(this,this.removeAnim)).once(),this.movieSprite.set_paused(!1),this.movieSprite.set_visible(!0)):0.85<a&&(this.moviePlayer=this.wowAnim,this.movieSprite=this.moviePlayer.movie._value,this.movieSprite.get_looped().connect(w(this,this.removeAnim)).once(),this.movieSprite.set_paused(!1),this.movieSprite.set_visible(!0))}this.updateScore();s.popBalloon.emit();D.poppedBalloon.resetTouch();D.poppedBalloon=null;this.correctAnswerSound=
null==this.correctAnswerSound?l.assetPack.getSound("sounds/sound"):this.correctAnswerSound;this.correctAnswerSound.play()}else this.wrongAnswerSound=null==this.wrongAnswerSound?l.assetPack.getSound("sounds/slip"):this.wrongAnswerSound,this.wrongAnswerSound.play(),D.poppedBalloon.resetTouch(),D.poppedBalloon=null,this.lives.dropLife();null},endGame:function(){this.owner.dispose();i.root.addChild(this.gameOverEntity)},__class__:D});var L=function(){null==L.levelDown&&(L.levelDown=new x(l.assetPack.getTexture("LevelButtonDown")));
null==L.levelText&&(L.levelText=new ca(l.font));this.buttonEntity=new n;this.levelUp=new x(l.assetPack.getTexture("LevelButtonUp"));this.buttonEntity.add(this.levelUp);this.levelTextEntity=new n;L.levelText=new ca(l.font);L.levelText.set_align(I.Center);this.buttonEntity.addChild(this.levelTextEntity.add(L.levelText));this.downEntity=(new n).add(L.levelDown);this.buttonEntity._compMap.Sprite_4.get_pointerDown().connect(w(this,this.handleTouchDown)).once();this.buttonEntity._compMap.Sprite_4.get_pointerUp().connect(w(this,
this.handleTouchUp)).once()};e["urgame.LevelItem"]=L;L.__name__=!0;L.prototype={setPosition:function(a,b){this.levelUp.x.set__(a);this.levelUp.y.set__(b)},updateLevel:function(a){L.levelText.set_text(this.level=a);L.levelText.set_align(I.Center);L.levelText.x.set__(0.25*-j.getBounds(this.levelTextEntity).width+this.levelUp.x._value+0.5*this.levelUp.texture.get_width());L.levelText.y.set__(0.5*-j.getBounds(this.levelTextEntity).height+this.levelUp.y._value+0.5*this.levelUp.texture.get_height())},handleTouchDown:function(){this.buttonEntity.addChild(this.downEntity);
s.startGame.emit(this.level)},handleTouchUp:function(){this.buttonEntity.removeChild(this.downEntity);L.levelText.set_text("")},getButton:function(){return this.buttonEntity},__class__:L};var lb=function(){this.acc_y=0.2;this.speed=[];this.livesArray=[];this.numberOfLives=5;r.call(this)};e["urgame.Lives"]=lb;lb.__name__=!0;lb.__super__=r;lb.prototype=o(r.prototype,{get_name:function(){return"Lives_5"},displayLives:function(){this.currentLife=0;this.container=new n;for(var a=0,b=this.numberOfLives;a<
b;){var c=a++;this.speed[c]=0.5;var d=new x(l.assetPack.getTexture("TamamaSmall@2x"));d.scaleX.set__(d.scaleY.set__(0.25));d.x.set__(function(a){var b=d.texture.get_width(),a=(a.numberOfLives-c-1)*b;return 0.25*(0>a?4294967296+a:a+0)}(this)+ra.padding);d.y.set__(ra.padding);this.livesArray.push(d);this.owner.addChild((new n).add(d))}},dropLife:function(){this.speed[this.currentLife++]=0.5;(function(a){a=a.currentLife;return 0>a?4294967296+a:a+0})(this)==function(a){a=a.numberOfLives;return 0>a?4294967296+
a:a+0}(this)&&s.gameOver.emit()},onAdded:function(){},onUpdate:function(){for(var a=0,b=this.currentLife;a<b;){var c=a++,d=this.livesArray[c].y;d.set__(d._value+this.speed[c]);this.speed[c]+=this.acc_y}},__class__:lb});var l=function(){};e["urgame.Main"]=l;l.__name__=!0;l.main=function(){i.init();var a=new n;a.add(new wa(16777215,i._platform.getStage().get_width(),2));a._compMap.Sprite_4.x.set__(0);a._compMap.Sprite_4.y.set__(0.5*i._platform.getStage().get_height()-0.5*j.getBounds(a).height);i.root.addChild(a);
var b=N.fromAssets("bootstrap"),c=i._platform.loadAssetPack(b);c.progressChanged.connect(function(){a.add(new wa(255,c._progress/c._total*i._platform.getStage().get_width(),2));a._compMap.Sprite_4.x.set__(0);a._compMap.Sprite_4.y.set__(0.5*i._platform.getStage().get_height()-0.5*j.getBounds(a).height)});c.get(l.onSuccess)};l.onSuccess=function(a){l.assetPack=a;l.font=new na(l.assetPack,"fonts/Arial");l.init()};l.init=function(){l.gameBehaviour=new D;l.game=new n;l.game.add(l.gameBehaviour);i.root.addChild(l.game)};
var sa=function(a,b){this.operation=a;this.image=b;this.image.get_pointerDown().connect(w(this,this.operatorSelected))};e["urgame.Operator"]=sa;sa.__name__=!0;sa.prototype={operatorSelected:function(){s.setSign.emit(this.operation)},__class__:sa};var Ea=function(){this.gravity=0.5;this.ySpeed=7;this.xSpeed=5;r.call(this)};e["urgame.Particle"]=Ea;Ea.__name__=!0;Ea.__super__=r;Ea.prototype=o(r.prototype,{get_name:function(){return"Particle_2"},copyFrom:function(a){this.x=a.x;this.y=a.y;this.vel_x=a.vel_x;
this.vel_y=a.vel_y;this.acc_x=a.acc_x;this.acc_y=a.acc_y;this.rotation=a.rotation;this.stopMoving=0},onAdded:function(){this.sprite=this.owner._compMap.Sprite_4},onUpdate:function(){var a=this.stopMoving;if(0==(0>a?4294967296+a:a+0))this.sprite.x._value>i._platform.getStage().get_width()||this.sprite.y._value>i._platform.getStage().get_height()?(this.stopMoving=1,K.balloonParticles.push(z.instance(this.owner._compMap.Sprite_4,x)),i.root.removeChild(this.owner)):(a=this.sprite.x,a.set__(a._value+this.vel_x),
a=this.sprite.y,a.set__(a._value+this.vel_y),this.vel_x+=this.acc_x,this.vel_y+=this.acc_y)},__class__:Ea});var Jb=function(){};e["urgame.Question"]=Jb;Jb.__name__=!0;Jb.prototype={__class__:Jb};var Fa=function(){this.fileName=1;this.questionIndex=0};e["urgame.QuestionArea"]=Fa;Fa.__name__=!0;Fa.prototype={loadQuestions:function(){var a=N.fromAssets("JSON");i._platform.loadAssetPack(a).get(w(this,this.onSuccess))},onSuccess:function(a){Fa.questionPack=a;this.getQuestions();s.showLevel.emit()},getQuestions:function(){this.allQuestions=
JSON.parse(Fa.questionPack.getFile("Op"+D.operator+"/"+this.fileName+".json").toString());this.createQuestions()},createQuestions:function(){this.questions=null==this.questions?[]:this.questions;for(var a=0,b=this.allQuestions.length;a<b;){var c=a++,d=new Jb;d.question=this.allQuestions[c].question;d.correctAnswer=this.allQuestions[c].correct;d.answers=[];for(var e=0,h=this.allQuestions[c].answers.length;e<h;){var g=e++;d.answers.push(this.allQuestions[c].answers[g])}this.questions.push(d)}},displayNextQ:function(){if(function(a){var b=
a.questionIndex,a=a.questions.length,c=0>a;return c!=0>b?c:a>b}(this))return this.questions[this.questionIndex++];return function(a){var a=a.fileName,b=D.maxLevel,c=0>b;return c!=0>a?c:b>a}(this)?(this.fileName++,this.getQuestions(),this.questions[this.questionIndex++]):null},__class__:Fa};var s=function(){};e["urgame.Signals"]=s;s.__name__=!0;var $b=0;Math.NaN=Number.NaN;Math.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY;Math.POSITIVE_INFINITY=Number.POSITIVE_INFINITY;e.Math=Math;Math.isFinite=function(a){return isFinite(a)};
Math.isNaN=function(a){return isNaN(a)};String.prototype.__class__=e.String=String;String.__name__=!0;e.Array=Array;Array.__name__=!0;Date.prototype.__class__=e.Date=Date;Date.__name__=["Date"];var ac=e.Int={__name__:["Int"]},bc=e.Dynamic={__name__:["Dynamic"]},Yb=e.Float=Number;Yb.__name__=["Float"];var Zb=e.Bool=Boolean;Zb.__ename__=["Bool"];var cc=e.Class={__name__:["Class"]},dc={};aa.instance=new aa;A.DISPATCHING_SENTINEL=new la(null,null);i.root=new n;i.uncaughtError=new t;i.hidden=new H(!1);
i.volume=new v(1);i._platform=aa.instance;i._calledInit=!1;N.__meta__={obj:{assets:[{JSON:[{bytes:568,md5:"cefb54552e3554681ce03add97560df9",name:"Op+/1.json"},{bytes:671,md5:"762dee5ed1ea2d822857b048ba540fb5",name:"Op+/10.json"},{bytes:687,md5:"111da35fb3a466d5275893528bf4e3a9",name:"Op+/11.json"},{bytes:687,md5:"a85d8af052208b56f6040ac5bb41523c",name:"Op+/12.json"},{bytes:687,md5:"ae8f45105819976019013e229735c50a",name:"Op+/13.json"},{bytes:683,md5:"a5dd85d58da727c091bb720378f6ddfe",name:"Op+/14.json"},
{bytes:691,md5:"19d7236ff13ea2bc08e2d2b31adb0247",name:"Op+/15.json"},{bytes:622,md5:"f8ce14f99db19fdccf93ae0c8f448d8c",name:"Op+/2.json"},{bytes:622,md5:"f9154d655bdcf3847ca8064a2bcd596d",name:"Op+/3.json"},{bytes:613,md5:"85b0f84180f821be2f801c9a77a75b74",name:"Op+/4.json"},{bytes:617,md5:"8ce5762e92663deb88bb336e8bf4d56a",name:"Op+/5.json"},{bytes:659,md5:"988121b843a7f2c7ba60f64d8137a7b6",name:"Op+/6.json"},{bytes:675,md5:"6dae6c0b78c5dc695c8c26e31d5c1423",name:"Op+/7.json"},{bytes:671,md5:"b13a0467e132e3b5cdd6e207f8e77646",
name:"Op+/8.json"},{bytes:675,md5:"ea16fc4350374fbfd2ff280807cee04d",name:"Op+/9.json"},{bytes:560,md5:"1484956c95af66d231044d5a0cb220a0",name:"Op-/1.json"},{bytes:602,md5:"309b22797ede5183839a48ea4a9c0489",name:"Op-/10.json"},{bytes:599,md5:"7c8bcca427fbb8852ab5b637c5405d3c",name:"Op-/11.json"},{bytes:602,md5:"aa16a9b738c10ca90591c27ba973b150",name:"Op-/12.json"},{bytes:614,md5:"003a2dcf060db3e596f3a4f73bfa0241",name:"Op-/13.json"},{bytes:614,md5:"625ff53779e784dff301fa39ed13670f",name:"Op-/14.json"},
{bytes:611,md5:"a53993d0421bf20522fa76818678fdea",name:"Op-/15.json"},{bytes:582,md5:"2b5fbe00891ac39f3fa8765704bca886",name:"Op-/2.json"},{bytes:593,md5:"f7999ebc1d217ecc5cfc040edf482468",name:"Op-/3.json"},{bytes:589,md5:"f3d855f0cf4a53222a22f5182430c8ba",name:"Op-/4.json"},{bytes:598,md5:"51810f80ad0d89a1a4462a0ff24a93f9",name:"Op-/5.json"},{bytes:598,md5:"a2bcb73de2bbec640878d26ec42d03fb",name:"Op-/6.json"},{bytes:589,md5:"349991744bbe9e1f8fab1812cf71b2aa",name:"Op-/7.json"},{bytes:581,md5:"5b65fe3c54fe04488a517cc181f9387e",
name:"Op-/8.json"},{bytes:589,md5:"c81a34384199c4591e16c458d5fa3a33",name:"Op-/9.json"},{bytes:565,md5:"3666b7276e529d39c70b6f42980c5dc7",name:"Opdiv/1.json"},{bytes:575,md5:"c3e5cac86ef03cd38e3cc41648f1a4fe",name:"Opdiv/10.json"},{bytes:569,md5:"aa118fcf99734f3b08695850a5a969f7",name:"Opdiv/11.json"},{bytes:571,md5:"d9978660fe4992ac86edf910e5d71bbb",name:"Opdiv/12.json"},{bytes:571,md5:"4985b831886435e18291dd8a44feedb5",name:"Opdiv/13.json"},{bytes:572,md5:"a36a700c8cc0130607dd67c7d5a3ff59",name:"Opdiv/14.json"},
{bytes:568,md5:"eca5f62eebe915e9c852412e28a65ccc",name:"Opdiv/15.json"},{bytes:586,md5:"385499d5d81bc3fe9d64596e5e742f1c",name:"Opdiv/2.json"},{bytes:564,md5:"21aa4eb6f2759b45c6c7db43ca557aed",name:"Opdiv/3.json"},{bytes:568,md5:"33a91ed1e8b426ef05980a99f4c5e9b5",name:"Opdiv/4.json"},{bytes:572,md5:"842a69bc8a1c33413d3160513b696448",name:"Opdiv/5.json"},{bytes:570,md5:"b3e4b2de8cc3794a15d0447e0915f6ca",name:"Opdiv/6.json"},{bytes:581,md5:"7c71b9b7292422848c32e478e73766ea",name:"Opdiv/7.json"},{bytes:574,
md5:"af5e71b362a55e7eeecf7d8828923026",name:"Opdiv/8.json"},{bytes:568,md5:"b2aadb37ee55d491057f4ad2f05b6a2f",name:"Opdiv/9.json"},{bytes:596,md5:"399da59b6590d78b79ec45cf1b616df7",name:"Opx/1.json"},{bytes:671,md5:"9e008258ed795521e7dc158b2cd77818",name:"Opx/10.json"},{bytes:679,md5:"c0094b9e379b54e7f903581e35063a56",name:"Opx/11.json"},{bytes:675,md5:"cecffe42caafde6d304fb1c0fe093a1b",name:"Opx/12.json"},{bytes:667,md5:"c7b69144c2a0f536cd98d04b8fa495b6",name:"Opx/13.json"},{bytes:667,md5:"39513ca4debae6af12e120bb8b979192",
name:"Opx/14.json"},{bytes:679,md5:"241018aa56ece590eab0afd18a20bc9d",name:"Opx/15.json"},{bytes:596,md5:"60874c399c404a9cfe2bfc28d91a1f41",name:"Opx/2.json"},{bytes:611,md5:"54c9c83ad136d66c31de2c3eb679f721",name:"Opx/3.json"},{bytes:640,md5:"0402d5b5443ae1ab90a1a982bf331e21",name:"Opx/4.json"},{bytes:665,md5:"de015d2cab568db6755c907a4d0c8ccb",name:"Opx/5.json"},{bytes:671,md5:"da3b0ef69b0c05110ba2187d942f41ec",name:"Opx/6.json"},{bytes:667,md5:"01da54fc7ac0407e62c5eab7306300b8",name:"Opx/7.json"},
{bytes:671,md5:"d8ab8ab90dc580f8c627c4439c3dab24",name:"Opx/8.json"},{bytes:667,md5:"b28eb562b8c82ce3ea26f0365d3e0b90",name:"Opx/9.json"}],bootstrap:[{bytes:174759,md5:"0d9b2688c0519c631582fed77694938c",name:"background.png"},{bytes:14362,md5:"e1596bccd504f6c6a78888500ba6ffbb",name:"balloon.png"},{bytes:2797,md5:"a50625a21376f53b87e52b128aa96d4c",name:"balloonparticle.png"},{bytes:14821,md5:"c501b67d6ac761a60eeba5b8e80ef7c4",name:"BaloonAnim/atlas0.png"},{bytes:22686,md5:"d4f2560824c38a30982d4f8d7bf2593e",
name:"BaloonAnim/library.json"},{bytes:32,md5:"84e2cc9cd070375d953c0bcf19696cc1",name:"BaloonAnim/md5"},{bytes:1,md5:"003d62073d0b493a14427a45413fc595",name:"BaloonAnim/version"},{bytes:1588,md5:"16ab12f694c973d8db16ec8f888ee65b",name:"divide.png"},{bytes:744,md5:"abe48661625426bc379b115b1b1c163f",name:"fonts/Arial.bmfc"},{bytes:62781,md5:"a846e319f4a9656b1e1c364e100d9878",name:"fonts/Arial.fnt"},{bytes:51674,md5:"c8c5ade18141e62cd89a7a7df421bf07",name:"fonts/Arial_0.png"},{bytes:7701,md5:"519b3c48412a582296c9076f874a1d83",
name:"gameover.png"},{bytes:6225,md5:"c49af1eec5af7129d0dc037ecb0f8684",name:"LevelButtonDown.png"},{bytes:4280,md5:"1dafd479245c82ce6a71a82e67b3a6b4",name:"LevelButtonUp.png"},{bytes:5085,md5:"086dce3cac319d1f33b725967ac1a431",name:"LevelSelectBG.png"},{bytes:4571,md5:"205458a6fd96a9b1e8e8713be1d796c2",name:"LevelUpAnim/atlas0.png"},{bytes:1630,md5:"7302f2af7ca73396e847b89290d6a9be",name:"LevelUpAnim/atlas1.png"},{bytes:19550,md5:"f5e6f6c5f864af93e559b4de48c44146",name:"LevelUpAnim/library.json"},
{bytes:32,md5:"c5ee5823b9fb9ab8f27cae5236677f76",name:"LevelUpAnim/md5"},{bytes:1,md5:"003d62073d0b493a14427a45413fc595",name:"LevelUpAnim/version"},{bytes:177,md5:"34aa952e523de26afaf946fb86b11e58",name:"minus.png"},{bytes:1598,md5:"c087f156485a65886030c0effa6bb3c3",name:"multiply.png"},{bytes:552,md5:"9193714cd7db458ab094f67e0d92f376",name:"plus.png"},{bytes:10428,md5:"644e80c0ef3c9f60d786f503caea8b89",name:"QuestionBoard@2x.png"},{bytes:11621,md5:"efe0b06b7ab09b2aba72c9f3188fe2c7",name:"ScoreBoard@2x.png"},
{bytes:5664,md5:"7bbb77bc85faa4162a4994f1acf86565",name:"selectOp.png"},{bytes:11572,md5:"02f99231f1b810e18a11a879da857ef9",name:"sounds/slip.wav"},{bytes:22478,md5:"b08f472c1455045ac1c20711a7d5ab6a",name:"sounds/sound.wav"},{bytes:17674,md5:"545dcca886b73d01fad95ef4256883e5",name:"TamamaSmall@2x.png"}]}]}};N._supportsCrossOrigin=function(){var a;a=0<=window.navigator.userAgent.indexOf("Linux; U; Android")?!1:null!=(new XMLHttpRequest).withCredentials;a||null;return a}();j._scratchPoint=new Pa;na.NEWLINE=
new Qa(10);P._sharedEvent=new ub;F._sharedEvent=new vb;ka.CANVAS_TEXTURES=(new $("(iPhone|iPod|iPad)","")).match(window.navigator.userAgent);p._mediaRefCount=0;p._detectBlobSupport=!0;k.VENDOR_PREFIXES=["webkit","moz","ms","o","khtml"];k.SHOULD_HIDE_MOBILE_BROWSER=window.top==window&&(new $("Mobile(/.*)? Safari","")).match(window.navigator.userAgent);q._detectSupport=!0;S._scratchMatrix=new T;ra.padding=10;D.maxLevel=15;s.showLevel=new V;s.gameOver=new V;s.checkAnswer=new V;s.popBalloon=new V;s.startGame=
new t;s.setSign=new t;s.nextQuestion=new V;s.nextQSignalEmitted=0;l.main()})();
