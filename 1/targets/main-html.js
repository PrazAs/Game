/** Cooked with Flambe, https://getflambe.com */
'use strict';(function(){function n(a,b){function c(){}c.prototype=a;var d=new c,f;for(f in b)d[f]=b[f];b.toString!==Object.prototype.toString&&(d.toString=b.toString);return d}function Wb(a){return a instanceof Array?function(){return x.iter(a)}:"function"==typeof a.iterator?B(a,a.iterator):a.iterator}function B(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=$b++);var c;null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__];null==c&&(c=function(){return c.method.apply(c.scope,
arguments)},c.scope=a,c.method=b,a.hx__closures__[b.__id__]=c);return c}var e={},m=function(){return E.__string_rec(this,"")},$=function(a,b){b=b.split("u").join("");this.r=RegExp(a,b)};e.EReg=$;$.__name__=!0;$.prototype={match:function(a){this.r.global&&(this.r.lastIndex=0);this.r.m=this.r.exec(a);this.r.s=a;return null!=this.r.m},matched:function(a){if(null!=this.r.m&&0<=a&&a<this.r.m.length)return this.r.m[a];throw"EReg::matched";},matchedPos:function(){if(null==this.r.m)throw"No string matched";
return{pos:this.r.m.index,len:this.r.m[0].length}},__class__:$};var x=function(){};e.HxOverrides=x;x.__name__=!0;x.cca=function(a,b){var c=a.charCodeAt(b);return c!=c?void 0:c};x.substr=function(a,b,c){if(null!=b&&0!=b&&null!=c&&0>c)return"";null==c&&(c=a.length);0>b?(b=a.length+b,0>b&&(b=0)):0>c&&(c=a.length+c-b);return a.substr(b,c)};x.remove=function(a,b){var c=a.indexOf(b);if(-1==c)return!1;a.splice(c,1);return!0};x.iter=function(a){return{cur:0,arr:a,hasNext:function(){return this.cur<this.arr.length},
next:function(){return this.arr[this.cur++]}}};var Fa=function(){};e.Lambda=Fa;Fa.__name__=!0;Fa.array=function(a){for(var b=[],a=Wb(a)();a.hasNext();){var c=a.next();b.push(c)}return b};Fa.count=function(a,b){var c=0;if(null==b)for(var d=Wb(a)();d.hasNext();)d.next(),c++;else for(d=Wb(a)();d.hasNext();){var f=d.next();b(f)&&c++}return c};var Kb=function(){};e.IMap=Kb;Kb.__name__=!0;Math.__name__=!0;var sa=function(){};e.Reflect=sa;sa.__name__=!0;sa.field=function(a,b){try{return a[b]}catch(c){return null}};
var y=function(){};e.Std=y;y.__name__=!0;y.is=function(a,b){return E.__instanceof(a,b)};y.instance=function(a,b){return a instanceof b?a:null};y.string=function(a){return E.__string_rec(a,"")};y["int"]=function(a){return a|0};y.parseInt=function(a){var b=parseInt(a,10);if(0==b&&(120==x.cca(a,1)||88==x.cca(a,1)))b=parseInt(a);return isNaN(b)?null:b};var lb=function(){};e.StringTools=lb;lb.__name__=!0;lb.startsWith=function(a,b){return a.length>=b.length&&x.substr(a,0,b.length)==b};var Ga=function(){};
e.Type=Ga;Ga.__name__=!0;Ga.getClass=function(a){return null==a?null:a instanceof Array&&null==a.__enum__?Array:a.__class__};Ga.resolveClass=function(a){a=e[a];return null==a||!a.__name__?null:a};Ga.resolveEnum=function(a){a=e[a];return null==a||!a.__ename__?null:a};var Y=function(){};e["flambe.util.Disposable"]=Y;Y.__name__=!0;Y.prototype={__class__:Y};var r=function(){this._flags=0;this.owner=this.next=null};e["flambe.Component"]=r;r.__name__=!0;r.__interfaces__=[Y];r.prototype={onAdded:function(){},
onRemoved:function(){},onStart:function(){},onStop:function(){},onUpdate:function(){},dispose:function(){null!=this.owner&&this.owner.remove(this)},get_name:function(){return null},__class__:r};var o=function(){this.parent=this.firstChild=this.next=this.firstComponent=null;this._compMap={}};e["flambe.Entity"]=o;o.__name__=!0;o.__interfaces__=[Y];o.prototype={add:function(a){null!=a.owner&&a.owner.remove(a);var b=a.get_name(),c=this._compMap[b];null!=c&&this.remove(c);this._compMap[b]=a;b=null;for(c=
this.firstComponent;null!=c;)b=c,c=c.next;null!=b?b.next=a:this.firstComponent=a;a.owner=this;a.next=null;a.onAdded();return this},remove:function(a){for(var b=null,c=this.firstComponent;null!=c;){var d=c.next;if(c==a)return null==b?this.firstComponent=d:(b.owner=this,b.next=d),delete this._compMap[c.get_name()],0!=(c._flags&1)&&(c.onStop(),c._flags&=-2),c.onRemoved(),c.owner=null,c.next=null,!0;b=c;c=d}return!1},addChild:function(a,b){null==b&&(b=!0);null!=a.parent&&a.parent.removeChild(a);a.parent=
this;if(b){for(var c=null,d=this.firstChild;null!=d;)c=d,d=d.next;null!=c?c.next=a:this.firstChild=a}else a.next=this.firstChild,this.firstChild=a;return this},removeChild:function(a){for(var b=null,c=this.firstChild;null!=c;){var d=c.next;if(c==a){null==b?this.firstChild=d:b.next=d;c.parent=null;c.next=null;break}b=c;c=d}},disposeChildren:function(){for(;null!=this.firstChild;)this.firstChild.dispose()},dispose:function(){for(null!=this.parent&&this.parent.removeChild(this);null!=this.firstComponent;)this.firstComponent.dispose();
this.disposeChildren()},__class__:o};var Lb=function(){};e["flambe.util.PackageLog"]=Lb;Lb.__name__=!0;var mb=function(){};e["flambe.platform.Platform"]=mb;mb.__name__=!0;mb.prototype={__class__:mb};var aa=function(){};e["flambe.platform.html.HtmlPlatform"]=aa;aa.__name__=!0;aa.__interfaces__=[mb];aa.prototype={init:function(){var a=this;k.fixAndroidMath();var b=null;try{b=window.flambe.canvas}catch(c){}b.setAttribute("tabindex","0");b.style.outlineStyle="none";b.style.webkitTapHighlightColor="transparent";
b.setAttribute("moz-opaque","true");this._stage=new ha(b);this._pointer=new F;this._mouse=new Ha(this._pointer,b);this._renderer=this.createRenderer(b);this.mainLoop=new ia;this.musicPlaying=!1;this._canvas=b;this._container=b.parentElement;this._container.style.overflow="hidden";this._container.style.position="relative";this._container.style.msTouchAction="none";var d=0,f=function(c){if(!(1E3>c.timeStamp-d)){var f=b.getBoundingClientRect(),h=a.getX(c,f),f=a.getY(c,f);switch(c.type){case "mousedown":c.target==
b&&(c.preventDefault(),a._mouse.submitDown(h,f,c.button),b.focus());break;case "mousemove":a._mouse.submitMove(h,f);break;case "mouseup":a._mouse.submitUp(h,f,c.button);break;case "mousewheel":case "DOMMouseScroll":a._mouse.submitScroll(h,f,"mousewheel"==c.type?c.wheelDelta/40:-c.detail)&&c.preventDefault()}}};window.addEventListener("mousedown",f,!1);window.addEventListener("mousemove",f,!1);window.addEventListener("mouseup",f,!1);b.addEventListener("mousewheel",f,!1);b.addEventListener("DOMMouseScroll",
f,!1);b.addEventListener("contextmenu",function(a){a.preventDefault()},!1);var h="undefined"!=typeof window.ontouchstart,f="msMaxTouchPoints"in window.navigator&&1<window.navigator.msMaxTouchPoints;if(h||f){var Mb=new Ia(this._pointer,h?4:window.navigator.msMaxTouchPoints);this._touch=Mb;f=function(b){var c;c=h?b.changedTouches:[b];var f=b.target.getBoundingClientRect();d=b.timeStamp;switch(b.type){case "touchstart":case "MSPointerDown":case "pointerdown":b.preventDefault();k.SHOULD_HIDE_MOBILE_BROWSER&&
k.hideMobileBrowser();for(b=0;b<c.length;){var e=c[b];++b;var G=a.getX(e,f),g=a.getY(e,f);Mb.submitDown((h?e.identifier:e.pointerId)|0,G,g)}break;case "touchmove":case "MSPointerMove":case "pointermove":b.preventDefault();for(b=0;b<c.length;)e=c[b],++b,G=a.getX(e,f),g=a.getY(e,f),Mb.submitMove((h?e.identifier:e.pointerId)|0,G,g);break;case "touchend":case "touchcancel":case "MSPointerUp":case "pointerup":for(b=0;b<c.length;)e=c[b],++b,G=a.getX(e,f),g=a.getY(e,f),Mb.submitUp((h?e.identifier:e.pointerId)|
0,G,g)}};h?(b.addEventListener("touchstart",f,!1),b.addEventListener("touchmove",f,!1),b.addEventListener("touchend",f,!1),b.addEventListener("touchcancel",f,!1)):(b.addEventListener("MSPointerDown",f,!1),b.addEventListener("MSPointerMove",f,!1),b.addEventListener("MSPointerUp",f,!1))}else this._touch=new Ja;var e=window.onerror;window.onerror=function(a,b,c){j.uncaughtError.emit(a);return null!=e?e(a,b,c):!1};var Ka=k.loadExtension("hidden",window.document);null!=Ka.value?(f=function(){j.hidden.set__(sa.field(window.document,
Ka.field))},f(null),window.document.addEventListener(Ka.prefix+"visibilitychange",f,!1)):(f=function(a){j.hidden.set__("pagehide"==a.type)},window.addEventListener("pageshow",f,!1),window.addEventListener("pagehide",f,!1));j.hidden.get_changed().connect(function(b){b||(a._skipFrame=!0)});this._skipFrame=!1;this._lastUpdate=Date.now();var g=k.loadExtension("requestAnimationFrame").value;if(null!=g){var i=window.performance,l=null!=i&&k.polyfill("now",i);l?this._lastUpdate=i.now():null;var m=null,m=
function(c){a.update(l?i.now():c);g(m,b)};g(m,b)}else window.setInterval(function(){a.update(Date.now())},16);ta.info("Initialized HTML platform",["renderer",this._renderer.get_type()])},loadAssetPack:function(a){return(new p(this,a)).promise},getStage:function(){return this._stage},update:function(a){var b=(a-this._lastUpdate)/1E3;this._lastUpdate=a;j.hidden._value||(this._skipFrame?this._skipFrame=!1:(this.mainLoop.update(b),this.mainLoop.render(this._renderer)))},getPointer:function(){return this._pointer},
getRenderer:function(){return this._renderer},getX:function(a,b){return(a.clientX-b.left)*this._stage.get_width()/b.width},getY:function(a,b){return(a.clientY-b.top)*this._stage.get_height()/b.height},createRenderer:function(a){try{var b=Nb.getContextWebGL(a,{alpha:!1,depth:!1,failIfMajorPerformanceCaveat:!0});if(null!=b)if(k.detectSlowDriver(b))null;else return new La(this._stage,b)}catch(c){}return new ja(a)},__class__:aa};var H=function(a,b){this._value=a;this._changed=null!=b?new ua(b):null};
e["flambe.util.Value"]=H;H.__name__=!0;H.prototype={watch:function(a){a(this._value,this._value);return this.get_changed().connect(a)},set__:function(a){var b=this._value;a!=b&&(this._value=a,null!=this._changed&&this._changed.emit(a,b));return a},get_changed:function(){null==this._changed&&(this._changed=new ua);return this._changed},__class__:H};var ka=function(a,b){this._next=null;this._signal=a;this._listener=b;this.stayInList=!0};e["flambe.util.SignalConnection"]=ka;ka.__name__=!0;ka.__interfaces__=
[Y];ka.prototype={once:function(){this.stayInList=!1;return this},dispose:function(){null!=this._signal&&(this._signal.disconnect(this),this._signal=null)},__class__:ka};var z=function(a){this._head=null!=a?new ka(this,a):null;this._deferredTasks=null};e["flambe.util.SignalBase"]=z;z.__name__=!0;z.prototype={connectImpl:function(a,b){var c=this,d=new ka(this,a);this._head==z.DISPATCHING_SENTINEL?this.defer(function(){c.listAdd(d,b)}):this.listAdd(d,b);return d},disconnect:function(a){var b=this;this._head==
z.DISPATCHING_SENTINEL?this.defer(function(){b.listRemove(a)}):this.listRemove(a)},defer:function(a){for(var b=null,c=this._deferredTasks;null!=c;)b=c,c=c.next;a=new nb(a);null!=b?b.next=a:this._deferredTasks=a},willEmit:function(){var a=this._head;this._head=z.DISPATCHING_SENTINEL;return a},didEmit:function(a){this._head=a;a=this._deferredTasks;for(this._deferredTasks=null;null!=a;)a.fn(),a=a.next},listAdd:function(a,b){if(b)a._next=this._head,this._head=a;else{for(var c=null,d=this._head;null!=
d;)c=d,d=d._next;null!=c?c._next=a:this._head=a}},listRemove:function(a){for(var b=null,c=this._head;null!=c;){if(c==a){a=c._next;null==b?this._head=a:b._next=a;break}b=c;c=c._next}},__class__:z};var ua=function(a){z.call(this,a)};e["flambe.util.Signal2"]=ua;ua.__name__=!0;ua.__super__=z;ua.prototype=n(z.prototype,{connect:function(a,b){null==b&&(b=!1);return this.connectImpl(a,b)},emit:function(a,b){var c=this;this._head==z.DISPATCHING_SENTINEL?this.defer(function(){c.emitImpl(a,b)}):this.emitImpl(a,
b)},emitImpl:function(a,b){for(var c=this.willEmit(),d=c;null!=d;)d._listener(a,b),d.stayInList||d.dispose(),d=d._next;this.didEmit(c)},__class__:ua});var t=function(a){z.call(this,a)};e["flambe.util.Signal1"]=t;t.__name__=!0;t.__super__=z;t.prototype=n(z.prototype,{connect:function(a,b){null==b&&(b=!1);return this.connectImpl(a,b)},emit:function(a){var b=this;this._head==z.DISPATCHING_SENTINEL?this.defer(function(){b.emitImpl(a)}):this.emitImpl(a)},emitImpl:function(a){for(var b=this.willEmit(),
c=b;null!=c;)c._listener(a),c.stayInList||c.dispose(),c=c._next;this.didEmit(b)},__class__:t});var v=function(a,b){this._behavior=null;H.call(this,a,b)};e["flambe.animation.AnimatedFloat"]=v;v.__name__=!0;v.__super__=H;v.prototype=n(H.prototype,{set__:function(a){this._behavior=null;return H.prototype.set__.call(this,a)},update:function(a){null!=this._behavior&&(H.prototype.set__.call(this,this._behavior.update(a)),this._behavior.isComplete()&&(this._behavior=null))},__class__:v});var j=function(){};
e["flambe.System"]=j;j.__name__=!0;j.init=function(){j._calledInit||(j._platform.init(),j._calledInit=!0)};var ta=function(){};e["flambe.Log"]=ta;ta.__name__=!0;ta.info=function(){null};ta.__super__=Lb;ta.prototype=n(Lb.prototype,{__class__:ta});var ob=function(){this._realDt=0};e["flambe.SpeedAdjuster"]=ob;ob.__name__=!0;ob.__super__=r;ob.prototype=n(r.prototype,{get_name:function(){return"SpeedAdjuster_8"},onUpdate:function(a){0<this._realDt&&(a=this._realDt,this._realDt=0);this.scale.update(a)},
__class__:ob});var Ob=function(){};e["flambe.animation.Behavior"]=Ob;Ob.__name__=!0;Ob.prototype={__class__:Ob};var da=function(){};e["flambe.asset.Asset"]=da;da.__name__=!0;da.__interfaces__=[Y];da.prototype={__class__:da};var g=e["flambe.asset.AssetFormat"]={__ename__:!0,__constructs__:"WEBP,JXR,PNG,JPG,GIF,DDS,PVR,PKM,MP3,M4A,OPUS,OGG,WAV,Data".split(",")};g.WEBP=["WEBP",0];g.WEBP.toString=m;g.WEBP.__enum__=g;g.JXR=["JXR",1];g.JXR.toString=m;g.JXR.__enum__=g;g.PNG=["PNG",2];g.PNG.toString=m;g.PNG.__enum__=
g;g.JPG=["JPG",3];g.JPG.toString=m;g.JPG.__enum__=g;g.GIF=["GIF",4];g.GIF.toString=m;g.GIF.__enum__=g;g.DDS=["DDS",5];g.DDS.toString=m;g.DDS.__enum__=g;g.PVR=["PVR",6];g.PVR.toString=m;g.PVR.__enum__=g;g.PKM=["PKM",7];g.PKM.toString=m;g.PKM.__enum__=g;g.MP3=["MP3",8];g.MP3.toString=m;g.MP3.__enum__=g;g.M4A=["M4A",9];g.M4A.toString=m;g.M4A.__enum__=g;g.OPUS=["OPUS",10];g.OPUS.toString=m;g.OPUS.__enum__=g;g.OGG=["OGG",11];g.OGG.toString=m;g.OGG.__enum__=g;g.WAV=["WAV",12];g.WAV.toString=m;g.WAV.__enum__=
g;g.Data=["Data",13];g.Data.toString=m;g.Data.__enum__=g;var pb=function(a,b,c,d){this.name=a;this.url=b;this.format=c;this.bytes=d};e["flambe.asset.AssetEntry"]=pb;pb.__name__=!0;pb.prototype={__class__:pb};var Ma=function(){};e["flambe.asset.AssetPack"]=Ma;Ma.__name__=!0;Ma.__interfaces__=[Y];Ma.prototype={__class__:Ma};var Na=function(){};e["flambe.asset.File"]=Na;Na.__name__=!0;Na.__interfaces__=[da];Na.prototype={__class__:Na};var N=function(){this._localBase=this._remoteBase=null;this._entries=
[]};e["flambe.asset.Manifest"]=N;N.__name__=!0;N.fromAssets=function(a,b){null==b&&(b=!0);var c=sa.field(Pb.getType(N).assets[0],a);if(null==c){if(b)throw A.withFields("Missing asset pack",["name",a]);return null}var d=new N;d.set_localBase("assets");for(var f=0;f<c.length;){var h=c[f];++f;var e=h.name,G=a+"/"+e+"?v="+y.string(h.md5),Ka=N.inferFormat(e);Ka!=g.Data&&(e=A.removeFileExtension(e));d.add(e,G,h.bytes,Ka)}return d};N.inferFormat=function(a){a=A.getUrlExtension(a);if(null!=a)switch(a.toLowerCase()){case "gif":return g.GIF;
case "jpg":case "jpeg":return g.JPG;case "jxr":case "wdp":return g.JXR;case "png":return g.PNG;case "webp":return g.WEBP;case "dds":return g.DDS;case "pvr":return g.PVR;case "pkm":return g.PKM;case "m4a":return g.M4A;case "mp3":return g.MP3;case "ogg":return g.OGG;case "opus":return g.OPUS;case "wav":return g.WAV}else null;return g.Data};N.prototype={add:function(a,b,c,d){null==c&&(c=0);null==d&&(d=N.inferFormat(b));a=new pb(a,b,d,c);this._entries.push(a);return a},iterator:function(){return x.iter(this._entries)},
getFullURL:function(a){var b;b=null!=this.get_remoteBase()&&N._supportsCrossOrigin?this.get_remoteBase():this.get_localBase();return null!=b?A.joinPath(b,a.url):a.url},get_localBase:function(){return this._localBase},set_localBase:function(a){null!=a&&Qb.that(!lb.startsWith(a,"http://")&&!lb.startsWith(a,"https://"),"localBase must be a path on the same domain, NOT starting with http(s)://",null);return this._localBase=a},get_remoteBase:function(){return this._remoteBase},__class__:N};var u=e["flambe.display.BlendMode"]=
{__ename__:!0,__constructs__:"Normal,Add,Multiply,Screen,Mask,Copy".split(",")};u.Normal=["Normal",0];u.Normal.toString=m;u.Normal.__enum__=u;u.Add=["Add",1];u.Add.toString=m;u.Add.__enum__=u;u.Multiply=["Multiply",2];u.Multiply.toString=m;u.Multiply.__enum__=u;u.Screen=["Screen",3];u.Screen.toString=m;u.Screen.__enum__=u;u.Mask=["Mask",4];u.Mask.toString=m;u.Mask.__enum__=u;u.Copy=["Copy",5];u.Copy.toString=m;u.Copy.__enum__=u;var Oa=function(a,b){null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b};
e["flambe.math.Point"]=Oa;Oa.__name__=!0;Oa.prototype={__class__:Oa};var i=function(){this.blendMode=this.scissor=null;var a=this;r.call(this);this._flags|=54;this._localMatrix=new T;var b=function(){a._flags|=24};this.x=new v(0,b);this.y=new v(0,b);this.rotation=new v(0,b);this.scaleX=new v(1,b);this.scaleY=new v(1,b);this.anchorX=new v(0,b);this.anchorY=new v(0,b);this.alpha=new v(1)};e["flambe.display.Sprite"]=i;i.__name__=!0;i.hitTest=function(a,b,c){var d=a._compMap.Sprite_4;if(null!=d){if(6!=
(d._flags&6))return null;d.getLocalMatrix().inverseTransform(b,c,i._scratchPoint)&&(b=i._scratchPoint.x,c=i._scratchPoint.y);var f=d.scissor;if(null!=f&&!f.contains(b,c))return null}a=i.hitTestBackwards(a.firstChild,b,c);return null!=a?a:null!=d&&d.containsLocal(b,c)?d:null};i.getBounds=function(a,b){null==b&&(b=new la);b.set(1.79769313486231E308,1.79769313486231E308,-1.79769313486231E308,-1.79769313486231E308);i.getBoundsImpl(a,null,b);b.width-=b.x;b.height-=b.y;return b};i.render=function(a,b){var c=
a._compMap.Sprite_4;if(null!=c){var d=c.alpha._value;if(0==(c._flags&2)||0>=d)return;b.save();1>d&&b.multiplyAlpha(d);null!=c.blendMode&&b.setBlendMode(c.blendMode);var d=c.getLocalMatrix(),f=d.m02,h=d.m12;0!=(c._flags&32)&&(f=Math.round(f),h=Math.round(h));b.transform(d.m00,d.m10,d.m01,d.m11,f,h);d=c.scissor;null!=d&&b.applyScissor(d.x,d.y,d.width,d.height);c.draw(b)}d=a._compMap.Director_7;if(null!=d){d=d.occludedScenes;for(f=0;f<d.length;)h=d[f],++f,i.render(h,b)}for(d=a.firstChild;null!=d;)f=
d.next,i.render(d,b),d=f;null!=c&&b.restore()};i.hitTestBackwards=function(a,b,c){if(null!=a){var d=i.hitTestBackwards(a.next,b,c);return null!=d?d:i.hitTest(a,b,c)}return null};i.getBoundsImpl=function(a,b,c){var d=a._compMap.Sprite_4;if(null!=d){var b=null!=b?T.multiply(b,d.getLocalMatrix()):d.getLocalMatrix(),f=d.getNaturalWidth(),d=d.getNaturalHeight();0<f&&0<d&&(i.extendRect(b,0,0,c),i.extendRect(b,f,0,c),i.extendRect(b,f,d,c),i.extendRect(b,0,d,c))}f=a._compMap.Director_7;if(null!=f)for(var f=
f.occludedScenes,d=0,h=f.length;d<h;)i.getBoundsImpl(f[d],b,c),++d;for(a=a.firstChild;null!=a;)f=a.next,i.getBoundsImpl(a,b,c),a=f};i.extendRect=function(a,b,c,d){a=a.transform(b,c,i._scratchPoint);b=a.x;c=a.y;b<d.x&&(d.x=b);c<d.y&&(d.y=c);b>d.width&&(d.width=b);c>d.height&&(d.height=c)};i.__super__=r;i.prototype=n(r.prototype,{get_name:function(){return"Sprite_4"},getNaturalWidth:function(){return 0},getNaturalHeight:function(){return 0},containsLocal:function(a,b){return 0<=a&&a<this.getNaturalWidth()&&
0<=b&&b<this.getNaturalHeight()},getLocalMatrix:function(){0!=(this._flags&8)&&(this._flags&=-9,this._localMatrix.compose(this.x._value,this.y._value,this.scaleX._value,this.scaleY._value,3.141592653589793*this.rotation._value/180),this._localMatrix.translate(-this.anchorX._value,-this.anchorY._value));return this._localMatrix},setAnchor:function(a,b){this.anchorX.set__(a);this.anchorY.set__(b);return this},setXY:function(a,b){this.x.set__(a);this.y.set__(b);return this},onAdded:function(){0!=(this._flags&
64)&&this.connectHover()},onRemoved:function(){null!=this._hoverConnection&&(this._hoverConnection.dispose(),this._hoverConnection=null)},onUpdate:function(a){this.x.update(a);this.y.update(a);this.rotation.update(a);this.scaleX.update(a);this.scaleY.update(a);this.alpha.update(a);this.anchorX.update(a);this.anchorY.update(a)},draw:function(){},getParentSprite:function(){if(null==this.owner)return null;for(var a=this.owner.parent;null!=a;){var b=a._compMap.Sprite_4;if(null!=b)return b;a=a.parent}return null},
get_pointerDown:function(){null==this._pointerDown&&(this._pointerDown=new t);return this._pointerDown},get_pointerUp:function(){null==this._pointerUp&&(this._pointerUp=new t);return this._pointerUp},connectHover:function(){var a=this;null==this._hoverConnection&&(this._hoverConnection=j._platform.getPointer().move.connect(function(b){for(var c=b.hit;null!=c;){if(c==a)return;c=c.getParentSprite()}null!=a._pointerOut&&0!=(a._flags&64)&&a._pointerOut.emit(b);a._flags&=-65;a._hoverConnection.dispose();
a._hoverConnection=null}))},set_visible:function(a){this._flags=qb.set(this._flags,2,a);return a},onPointerDown:function(a){this.onHover(a);null!=this._pointerDown&&this._pointerDown.emit(a)},onPointerMove:function(a){this.onHover(a);null!=this._pointerMove&&this._pointerMove.emit(a)},onHover:function(a){if(0==(this._flags&64)&&(this._flags|=64,null!=this._pointerIn||null!=this._pointerOut))null!=this._pointerIn&&this._pointerIn.emit(a),this.connectHover()},onPointerUp:function(a){switch(a.source[1]){case 1:null!=
this._pointerOut&&0!=(this._flags&64)&&this._pointerOut.emit(a),this._flags&=-65,null!=this._hoverConnection&&(this._hoverConnection.dispose(),this._hoverConnection=null)}null!=this._pointerUp&&this._pointerUp.emit(a)},__class__:i});var va=function(a,b,c){i.call(this);this.color=a;this.width=new v(b);this.height=new v(c)};e["flambe.display.FillSprite"]=va;va.__name__=!0;va.__super__=i;va.prototype=n(i.prototype,{draw:function(a){a.fillRect(this.color,0,0,this.width._value,this.height._value)},getNaturalWidth:function(){return this.width._value},
getNaturalHeight:function(){return this.height._value},onUpdate:function(a){i.prototype.onUpdate.call(this,a);this.width.update(a);this.height.update(a)},__class__:va});var Pa=function(a){this._kernings=null;this.xOffset=this.yOffset=this.xAdvance=0;this.page=null;this.x=this.y=this.width=this.height=0;this.charCode=a};e["flambe.display.Glyph"]=Pa;Pa.__name__=!0;Pa.prototype={draw:function(a,b,c){0<this.width&&a.drawSubTexture(this.page,b+this.xOffset,c+this.yOffset,this.x,this.y,this.width,this.height)},
getKerning:function(a){return null!=this._kernings?y["int"](this._kernings.get(a)):0},setKerning:function(a,b){null==this._kernings&&(this._kernings=new Z);this._kernings.set(a,b)},__class__:Pa};var ma=function(a,b){this.name=b;this._pack=a;this._file=a.getFile(b+".fnt");this.reload()};e["flambe.display.Font"]=ma;ma.__name__=!0;ma.prototype={layoutText:function(a,b,c,d,f){null==f&&(f=0);null==d&&(d=0);null==c&&(c=0);null==b&&(b=I.Left);return new ea(this,a,b,c,d,f)},reload:function(){this._glyphs=
new Z;this._glyphs.set(ma.NEWLINE.charCode,ma.NEWLINE);for(var a=new na(this._file.toString()),b=new Z,c=this.name.lastIndexOf("/"),c=0<=c?x.substr(this.name,0,c+1):"",d=a.keywords();d.hasNext();)switch(d.next()){case "info":for(var f=a.pairs();f.hasNext();){var h=f.next();switch(h.key){case "size":this.size=h.getInt()}}break;case "common":for(f=a.pairs();f.hasNext();)switch(h=f.next(),h.key){case "lineHeight":this.lineHeight=h.getInt()}break;case "page":for(var f=0,h=null,e=a.pairs();e.hasNext();){var G=
e.next();switch(G.key){case "id":f=G.getInt();break;case "file":h=G.getString()}}h=this._pack.getTexture(c+A.removeFileExtension(h));b.set(f,h);break;case "char":f=null;for(h=a.pairs();h.hasNext();)switch(e=h.next(),e.key){case "id":f=new Pa(e.getInt());break;case "x":f.x=e.getInt();break;case "y":f.y=e.getInt();break;case "width":f.width=e.getInt();break;case "height":f.height=e.getInt();break;case "page":e=e.getInt();f.page=b.get(e);break;case "xoffset":f.xOffset=e.getInt();break;case "yoffset":f.yOffset=
e.getInt();break;case "xadvance":f.xAdvance=e.getInt()}this._glyphs.set(f.charCode,f);break;case "kerning":f=null;e=h=0;for(G=a.pairs();G.hasNext();){var g=G.next();switch(g.key){case "first":f=this._glyphs.get(g.getInt());break;case "second":h=g.getInt();break;case "amount":e=g.getInt()}}null!=f&&0!=e&&f.setKerning(h,e)}},__class__:ma};var I=e["flambe.display.TextAlign"]={__ename__:!0,__constructs__:["Left","Center","Right"]};I.Left=["Left",0];I.Left.toString=m;I.Left.__enum__=I;I.Center=["Center",
1];I.Center.toString=m;I.Center.__enum__=I;I.Right=["Right",2];I.Right.toString=m;I.Right.__enum__=I;var ea=function(a,b,c,d,f,h){this.lines=0;var e=this;this._font=a;this._glyphs=[];this._offsets=[];this._lineOffset=Math.round(a.lineHeight+h);this.bounds=new la;for(var G=[],h=b.length,g=0;g<h;){var i=g++,i=b.charCodeAt(i),i=a._glyphs.get(i);null!=i?this._glyphs.push(i):null}for(var b=-1,j=0,k=0,a=a._glyphs.get(10),h=function(){e.bounds.width=O.max(e.bounds.width,j);e.bounds.height+=k;G[e.lines]=
j;k=j=0;++e.lines},g=0;g<this._glyphs.length;){i=this._glyphs[g];this._offsets[g]=Math.round(j);var l=0<d&&j+i.width>d;l||i==a?(l&&(0<=b?(this._glyphs[b]=a,j=this._offsets[b],g=b):this._glyphs.splice(g,0,a)),b=-1,k=this._lineOffset,h()):(32==i.charCode&&(b=g),j+=i.xAdvance+f,k=O.max(k,i.height+i.yOffset),g+1<this._glyphs.length&&(j+=i.getKerning(this._glyphs[g+1].charCode)));++g}h();f=0;a=ea.getAlignOffset(c,G[0],d);b=1.79769313486231E308;h=-1.79769313486231E308;i=g=0;for(l=this._glyphs.length;i<
l;){var m=this._glyphs[i];10==m.charCode&&(f+=this._lineOffset,++g,a=ea.getAlignOffset(c,G[g],d));this._offsets[i]+=a;var n=f+m.yOffset;b<n||(b=n);h=O.max(h,n+m.height);++i}this.bounds.x=ea.getAlignOffset(c,this.bounds.width,d);this.bounds.y=b;this.bounds.height=h-b};e["flambe.display.TextLayout"]=ea;ea.__name__=!0;ea.getAlignOffset=function(a,b,c){switch(a[1]){case 0:return 0;case 2:return c-b;case 1:return Math.round((c-b)/2)}};ea.prototype={draw:function(a){for(var b=0,c=0,d=this._glyphs.length;c<
d;){var f=this._glyphs[c];10==f.charCode?b+=this._lineOffset:f.draw(a,this._offsets[c],b);++c}},__class__:ea};var na=function(a){this._configText=a;this._keywordPattern=new $("([A-Za-z]+)(.*)","");this._pairPattern=new $('([A-Za-z]+)=("[^"]*"|[^\\s]+)',"")};e["flambe.display._Font.ConfigParser"]=na;na.__name__=!0;na.advance=function(a,b){var c=b.matchedPos();return x.substr(a,c.pos+c.len,a.length)};na.prototype={keywords:function(){var a=this,b=this._configText;return{next:function(){b=na.advance(b,
a._keywordPattern);a._pairText=a._keywordPattern.matched(2);return a._keywordPattern.matched(1)},hasNext:function(){return a._keywordPattern.match(b)}}},pairs:function(){var a=this,b=this._pairText;return{next:function(){b=na.advance(b,a._pairPattern);return new rb(a._pairPattern.matched(1),a._pairPattern.matched(2))},hasNext:function(){return a._pairPattern.match(b)}}},__class__:na};var rb=function(a,b){this.key=a;this._value=b};e["flambe.display._Font.ConfigPair"]=rb;rb.__name__=!0;rb.prototype=
{getInt:function(){return y.parseInt(this._value)},getString:function(){return 34!=this._value.charCodeAt(0)?null:x.substr(this._value,1,this._value.length-2)},__class__:rb};var sb=function(){};e["flambe.display.Graphics"]=sb;sb.__name__=!0;sb.prototype={__class__:sb};var w=function(a){i.call(this);this.texture=a};e["flambe.display.ImageSprite"]=w;w.__name__=!0;w.__super__=i;w.prototype=n(i.prototype,{draw:function(a){null!=this.texture&&a.drawTexture(this.texture,0,0)},getNaturalWidth:function(){return null!=
this.texture?this.texture.get_width():0},getNaturalHeight:function(){return null!=this.texture?this.texture.get_height():0},__class__:w});var ba=e["flambe.display.Orientation"]={__ename__:!0,__constructs__:["Portrait","Landscape"]};ba.Portrait=["Portrait",0];ba.Portrait.toString=m;ba.Portrait.__enum__=ba;ba.Landscape=["Landscape",1];ba.Landscape.toString=m;ba.Landscape.__enum__=ba;var Qa=function(){};e["flambe.display.Texture"]=Qa;Qa.__name__=!0;Qa.__interfaces__=[da];Qa.prototype={__class__:Qa};
var Rb=function(){};e["flambe.display.SubTexture"]=Rb;Rb.__name__=!0;Rb.__interfaces__=[Qa];var ca=function(a,b){null==b&&(b="");this._layout=null;var c=this;i.call(this);this._font=a;this._text=b;this._align=I.Left;this._flags|=128;var d=function(){c._flags|=128};this.wrapWidth=new v(0,d);this.letterSpacing=new v(0,d);this.lineSpacing=new v(0,d)};e["flambe.display.TextSprite"]=ca;ca.__name__=!0;ca.__super__=i;ca.prototype=n(i.prototype,{draw:function(a){this.updateLayout();this._layout.draw(a)},
getNaturalWidth:function(){this.updateLayout();return 0<this.wrapWidth._value?this.wrapWidth._value:this._layout.bounds.width},getNaturalHeight:function(){this.updateLayout();var a=this._layout.lines*(this._font.lineHeight+this.lineSpacing._value),b=this._layout.bounds.height;return a>b?a:b},containsLocal:function(a,b){this.updateLayout();return this._layout.bounds.contains(a,b)},set_text:function(a){a!=this._text&&(this._text=a,this._flags|=128);return a},set_align:function(a){a!=this._align&&(this._align=
a,this._flags|=128);return a},updateLayout:function(){0!=(this._flags&128)&&(this._flags&=-129,this._layout=this._font.layoutText(this._text,this._align,this.wrapWidth._value,this.letterSpacing._value,this.lineSpacing._value))},onUpdate:function(a){i.prototype.onUpdate.call(this,a);this.wrapWidth.update(a);this.letterSpacing.update(a);this.lineSpacing.update(a)},__class__:ca});var J=e["flambe.input.MouseButton"]={__ename__:!0,__constructs__:["Left","Middle","Right","Unknown"]};J.Left=["Left",0];J.Left.toString=
m;J.Left.__enum__=J;J.Middle=["Middle",1];J.Middle.toString=m;J.Middle.__enum__=J;J.Right=["Right",2];J.Right.toString=m;J.Right.__enum__=J;J.Unknown=function(a){a=["Unknown",3,a];a.__enum__=J;a.toString=m;return a};var U=e["flambe.input.MouseCursor"]={__ename__:!0,__constructs__:["Default","Button","None"]};U.Default=["Default",0];U.Default.toString=m;U.Default.__enum__=U;U.Button=["Button",1];U.Button.toString=m;U.Button.__enum__=U;U.None=["None",2];U.None.toString=m;U.None.__enum__=U;var tb=function(){this.init(0,
0,0,null)};e["flambe.input.MouseEvent"]=tb;tb.__name__=!0;tb.prototype={init:function(a,b,c,d){this.id=a;this.viewX=b;this.viewY=c;this.button=d},__class__:tb};var Ra=e["flambe.input.EventSource"]={__ename__:!0,__constructs__:["Mouse","Touch"]};Ra.Mouse=function(a){a=["Mouse",0,a];a.__enum__=Ra;a.toString=m;return a};Ra.Touch=function(a){a=["Touch",1,a];a.__enum__=Ra;a.toString=m;return a};var ub=function(){this.init(0,0,0,null,null)};e["flambe.input.PointerEvent"]=ub;ub.__name__=!0;ub.prototype=
{init:function(a,b,c,d,f){this.id=a;this.viewX=b;this.viewY=c;this.hit=d;this.source=f;this._stopped=!1},__class__:ub};var vb=function(a){this.id=a;this._source=Ra.Touch(this)};e["flambe.input.TouchPoint"]=vb;vb.__name__=!0;vb.prototype={init:function(a,b){this.viewX=a;this.viewY=b},__class__:vb};var O=function(){};e["flambe.math.FMath"]=O;O.__name__=!0;O.max=function(a,b){return a>b?a:b};O.min=function(a,b){return a<b?a:b};O.clamp=function(a,b,c){return a<b?b:a>c?c:a};var T=function(){this.identity()};
e["flambe.math.Matrix"]=T;T.__name__=!0;T.multiply=function(a,b,c){null==c&&(c=new T);var d=a.m00*b.m00+a.m01*b.m10,f=a.m00*b.m01+a.m01*b.m11,h=a.m00*b.m02+a.m01*b.m12+a.m02;c.m00=d;c.m01=f;c.m02=h;d=a.m10*b.m00+a.m11*b.m10;f=a.m10*b.m01+a.m11*b.m11;h=a.m10*b.m02+a.m11*b.m12+a.m12;c.m10=d;c.m11=f;c.m12=h;return c};T.prototype={set:function(a,b,c,d,f,h){this.m00=a;this.m01=c;this.m02=f;this.m10=b;this.m11=d;this.m12=h},identity:function(){this.set(1,0,0,1,0,0)},compose:function(a,b,c,d,f){var h=Math.sin(f),
f=Math.cos(f);this.set(f*c,h*c,-h*d,f*d,a,b)},translate:function(a,b){this.m02+=this.m00*a+this.m01*b;this.m12+=this.m11*b+this.m10*a},invert:function(){var a=this.determinant();if(0==a)return!1;this.set(this.m11/a,-this.m01/a,-this.m10/a,this.m00/a,(this.m01*this.m12-this.m11*this.m02)/a,(this.m10*this.m02-this.m00*this.m12)/a);return!0},transform:function(a,b,c){null==c&&(c=new Oa);c.x=a*this.m00+b*this.m01+this.m02;c.y=a*this.m10+b*this.m11+this.m12;return c},transformArray:function(a,b,c){for(var d=
0;d<b;){var f=a[d],h=a[d+1];c[d++]=f*this.m00+h*this.m01+this.m02;c[d++]=f*this.m10+h*this.m11+this.m12}},determinant:function(){return this.m00*this.m11-this.m01*this.m10},inverseTransform:function(a,b,c){var d=this.determinant();if(0==d)return!1;a-=this.m02;b-=this.m12;c.x=(a*this.m11-b*this.m01)/d;c.y=(b*this.m00-a*this.m10)/d;return!0},clone:function(a){null==a&&(a=new T);a.set(this.m00,this.m10,this.m01,this.m11,this.m02,this.m12);return a},__class__:T};var la=function(a,b,c,d){null==d&&(d=0);
null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.set(a,b,c,d)};e["flambe.math.Rectangle"]=la;la.__name__=!0;la.prototype={set:function(a,b,c,d){this.x=a;this.y=b;this.width=c;this.height=d},contains:function(a,b){a-=this.x;if(0<=this.width){if(0>a||a>this.width)return!1}else if(0<a||a<this.width)return!1;b-=this.y;if(0<=this.height){if(0>b||b>this.height)return!1}else if(0<b||b<this.height)return!1;return!0},clone:function(a){null==a&&(a=new la);a.set(this.x,this.y,this.width,this.height);return a},
equals:function(a){return this.x==a.x&&this.y==a.y&&this.width==a.width&&this.height==a.height},__class__:la};var C=function(){this._disposed=!1};e["flambe.platform.BasicAsset"]=C;C.__name__=!0;C.__interfaces__=[da];C.prototype={dispose:function(){this._disposed||(this._disposed=!0,this.onDisposed())},onDisposed:function(){null},__class__:C};var fa=function(a,b){var c=this;this.manifest=b;this._platform=a;this.promise=new Sa;this._bytesLoaded=new V;this._pack=new Ta(b,this);var d=Fa.array(b);if(0==
d.length)this.handleSuccess();else{for(var f=new V,h=0;h<d.length;){var e=d[h];++h;var g=f.get(e.name);null==g&&(g=[],f.set(e.name,g));g.push(e)}this._assetsRemaining=Fa.count(f);for(d=f.iterator();d.hasNext();)f=[d.next()],this.pickBestEntry(f[0],function(a){return function(d){if(null!=d){var f=b.getFullURL(d);try{c.loadEntry(f,d)}catch(h){c.handleError(d,"Unexpected error: "+y.string(h))}f=c.promise;f.set_total(f._total+d.bytes)}else d=a[0][0],fa.isAudio(d.format)?c.handleLoad(d,Q.getInstance()):
c.handleError(d,"Could not find a supported format to load")}}(f))}};e["flambe.platform.BasicAssetPackLoader"]=fa;fa.__name__=!0;fa.isAudio=function(a){switch(a[1]){case 8:case 9:case 10:case 11:case 12:return!0;default:return!1}};fa.prototype={onDisposed:function(){},pickBestEntry:function(a,b){this.getAssetFormats(function(c){for(var d=0;d<c.length;){var f=c[d];++d;for(var h=0;h<a.length;){var e=a[h];++h;if(e.format==f){b(e);return}}}b(null)})},loadEntry:function(){null},getAssetFormats:function(){null},
handleLoad:function(a,b){if(!this._pack.disposed){this.handleProgress(a,a.bytes);var c;switch(a.format[1]){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:c=this._pack.textures;break;case 8:case 9:case 10:case 11:case 12:c=this._pack.sounds;break;case 13:c=this._pack.files}c.set(a.name,b);this._assetsRemaining-=1;0==this._assetsRemaining&&this.handleSuccess()}},handleProgress:function(a,b){this._bytesLoaded.set(a.name,b);for(var c=0,d=this._bytesLoaded.iterator();d.hasNext();)var f=d.next(),
c=c+f;this.promise.set_progress(c)},handleSuccess:function(){this.promise.set_result(this._pack)},handleError:function(a,b){this.promise.error.emit(A.withFields(b,["url",a.url]))},handleTextureError:function(a){this.handleError(a,"Failed to create texture. Is the GPU context unavailable?")},__class__:fa};var Ta=function(a,b){this.disposed=!1;this._manifest=a;this.loader=b;this.textures=new V;this.sounds=new V;this.files=new V};e["flambe.platform._BasicAssetPackLoader.BasicAssetPack"]=Ta;Ta.__name__=
!0;Ta.__interfaces__=[Ma];Ta.prototype={getTexture:function(a,b){null==b&&(b=!0);var c=this.textures.get(a);if(null==c&&b)throw A.withFields("Missing texture",["name",a]);return c},getSound:function(a,b){null==b&&(b=!0);var c=this.sounds.get(a);if(null==c&&b)throw A.withFields("Missing sound",["name",a]);return c},getFile:function(a,b){null==b&&(b=!0);var c=this.files.get(a);if(null==c&&b)throw A.withFields("Missing file",["name",a]);return c},dispose:function(){if(!this.disposed){this.disposed=!0;
for(var a=this.textures.iterator();a.hasNext();)a.next().dispose();this.textures=null;for(a=this.sounds.iterator();a.hasNext();)a.next().dispose();this.sounds=null;for(a=this.files.iterator();a.hasNext();)a.next().dispose();this.files=null;this.loader.onDisposed()}},__class__:Ta};var wa=function(a){this._disposed=!1;this._content=a};e["flambe.platform.BasicFile"]=wa;wa.__name__=!0;wa.__interfaces__=[Na];wa.__super__=C;wa.prototype=n(C.prototype,{toString:function(){return this._content},onDisposed:function(){this._content=
null},__class__:wa});var Xb=function(){};e["flambe.subsystem.MouseSystem"]=Xb;Xb.__name__=!0;var P=function(a){this._pointer=a;this._source=Ra.Mouse(P._sharedEvent);this.down=new t;this.move=new t;this.up=new t;this.scroll=new t;this._y=this._x=0;this._cursor=U.Default;this._buttonStates=new Z};e["flambe.platform.BasicMouse"]=P;P.__name__=!0;P.__interfaces__=[Xb];P.prototype={submitDown:function(a,b,c){this._buttonStates.exists(c)||(this._buttonStates.set(c,!0),this.prepare(a,b,wb.toButton(c)),this._pointer.submitDown(a,
b,this._source),this.down.emit(P._sharedEvent))},submitMove:function(a,b){this.prepare(a,b,null);this._pointer.submitMove(a,b,this._source);this.move.emit(P._sharedEvent)},submitUp:function(a,b,c){this._buttonStates.exists(c)&&(this._buttonStates.remove(c),this.prepare(a,b,wb.toButton(c)),this._pointer.submitUp(a,b,this._source),this.up.emit(P._sharedEvent))},submitScroll:function(a,b,c){this._x=a;this._y=b;if(null==this.scroll._head)return!1;this.scroll.emit(c);return!0},prepare:function(a,b,c){this._x=
a;this._y=b;P._sharedEvent.init(P._sharedEvent.id+1,a,b,c)},__class__:P};var xb=function(){};e["flambe.subsystem.PointerSystem"]=xb;xb.__name__=!0;xb.prototype={__class__:xb};var F=function(a,b,c){null==c&&(c=!1);null==b&&(b=0);null==a&&(a=0);this.down=new t;this.move=new t;this.up=new t;this._x=a;this._y=b;this._isDown=c};e["flambe.platform.BasicPointer"]=F;F.__name__=!0;F.__interfaces__=[xb];F.prototype={submitDown:function(a,b,c){if(!this._isDown){this.submitMove(a,b,c);this._isDown=!0;var d=[],
f=i.hitTest(j.root,a,b);if(null!=f){var h=f.owner;do{var e=h._compMap.Sprite_4;null!=e&&d.push(e);h=h.parent}while(null!=h)}this.prepare(a,b,f,c);for(a=0;a<d.length;)if(b=d[a],++a,b.onPointerDown(F._sharedEvent),F._sharedEvent._stopped)return;this.down.emit(F._sharedEvent)}},submitMove:function(a,b,c){if(!(a==this._x&&b==this._y)){var d=[],f=i.hitTest(j.root,a,b);if(null!=f){var h=f.owner;do{var e=h._compMap.Sprite_4;null!=e&&d.push(e);h=h.parent}while(null!=h)}this.prepare(a,b,f,c);for(a=0;a<d.length;)if(b=
d[a],++a,b.onPointerMove(F._sharedEvent),F._sharedEvent._stopped)return;this.move.emit(F._sharedEvent)}},submitUp:function(a,b,c){if(this._isDown){this.submitMove(a,b,c);this._isDown=!1;var d=[],f=i.hitTest(j.root,a,b);if(null!=f){var h=f.owner;do{var e=h._compMap.Sprite_4;null!=e&&d.push(e);h=h.parent}while(null!=h)}this.prepare(a,b,f,c);for(a=0;a<d.length;)if(b=d[a],++a,b.onPointerUp(F._sharedEvent),F._sharedEvent._stopped)return;this.up.emit(F._sharedEvent)}},prepare:function(a,b,c,d){this._x=
a;this._y=b;F._sharedEvent.init(F._sharedEvent.id+1,a,b,c,d)},__class__:F};var W=function(a,b,c){this._x=this._y=0;this._parent=null;this.rootX=this.rootY=0;this._disposed=!1;this.root=a;this._width=b;this._height=c};e["flambe.platform.BasicTexture"]=W;W.__name__=!0;W.__interfaces__=[Rb];W.__super__=C;W.prototype=n(C.prototype,{readPixels:function(a,b,c,d){return this.root.readPixels(this.rootX+a,this.rootY+b,c,d)},subTexture:function(a,b,c,d){c=this.root.createTexture(c,d);c._parent=this;c._x=a;
c._y=b;c.rootX=this.rootX+a;c.rootY=this.rootY+b;return c},onDisposed:function(){null==this._parent&&this.root.dispose()},get_width:function(){return this._width},get_height:function(){return this._height},__class__:W});var Sb=function(){};e["flambe.subsystem.TouchSystem"]=Sb;Sb.__name__=!0;var Ia=function(a,b){null==b&&(b=4);this._pointer=a;this._maxPoints=b;this._pointMap=new Z;this._points=[];this.down=new t;this.move=new t;this.up=new t};e["flambe.platform.BasicTouch"]=Ia;Ia.__name__=!0;Ia.__interfaces__=
[Sb];Ia.prototype={submitDown:function(a,b,c){if(!this._pointMap.exists(a)){var d=new vb(a);d.init(b,c);this._pointMap.set(a,d);this._points.push(d);null==this._pointerTouch&&(this._pointerTouch=d,this._pointer.submitDown(b,c,d._source));this.down.emit(d)}},submitMove:function(a,b,c){a=this._pointMap.get(a);null!=a&&(a.init(b,c),this._pointerTouch==a&&this._pointer.submitMove(b,c,a._source),this.move.emit(a))},submitUp:function(a,b,c){var d=this._pointMap.get(a);null!=d&&(d.init(b,c),this._pointMap.remove(a),
x.remove(this._points,d),this._pointerTouch==d&&(this._pointerTouch=null,this._pointer.submitUp(b,c,d._source)),this.up.emit(d))},__class__:Ia};var oa=function(){};e["flambe.sound.Sound"]=oa;oa.__name__=!0;oa.__interfaces__=[da];oa.prototype={__class__:oa};var Q=function(){this._disposed=!1;this._playback=new Ua(this)};e["flambe.platform.DummySound"]=Q;Q.__name__=!0;Q.__interfaces__=[oa];Q.getInstance=function(){null==Q._instance&&(Q._instance=new Q);return Q._instance};Q.__super__=C;Q.prototype=
n(C.prototype,{play:function(){return this._playback},onDisposed:function(){},__class__:Q});var Va=function(){};e["flambe.sound.Playback"]=Va;Va.__name__=!0;Va.__interfaces__=[Y];var Ua=function(a){this._sound=a;this.volume=new v(0);this._complete=new H(!0)};e["flambe.platform.DummyPlayback"]=Ua;Ua.__name__=!0;Ua.__interfaces__=[Va];Ua.prototype={dispose:function(){},__class__:Ua};var Ja=function(){this.down=new t;this.move=new t;this.up=new t};e["flambe.platform.DummyTouch"]=Ja;Ja.__name__=!0;Ja.__interfaces__=
[Sb];Ja.prototype={__class__:Ja};var xa=function(){this._entries=[]};e["flambe.platform.EventGroup"]=xa;xa.__name__=!0;xa.__interfaces__=[Y];xa.prototype={addListener:function(a,b,c){a.addEventListener(b,c,!1);this._entries.push(new yb(a,b,c))},addDisposingListener:function(a,b,c){var d=this;this.addListener(a,b,function(a){d.dispose();c(a)})},dispose:function(){for(var a=0,b=this._entries;a<b.length;){var c=b[a];++a;c.dispatcher.removeEventListener(c.type,c.listener,!1)}this._entries=[]},__class__:xa};
var yb=function(a,b,c){this.dispatcher=a;this.type=b;this.listener=c};e["flambe.platform._EventGroup.Entry"]=yb;yb.__name__=!0;yb.prototype={__class__:yb};var ya=function(){};e["flambe.platform.InternalGraphics"]=ya;ya.__name__=!0;ya.__interfaces__=[sb];ya.prototype={__class__:ya};var zb=function(){};e["flambe.subsystem.RendererSystem"]=zb;zb.__name__=!0;zb.prototype={__class__:zb};var za=function(){};e["flambe.platform.InternalRenderer"]=za;za.__name__=!0;za.__interfaces__=[zb];za.prototype={__class__:za};
var ia=function(){this._tickables=[]};e["flambe.platform.MainLoop"]=ia;ia.__name__=!0;ia.updateEntity=function(a,b){var c=a._compMap.SpeedAdjuster_8;if(null!=c&&(c._realDt=b,b*=c.scale._value,0>=b)){c.onUpdate(b);return}for(c=a.firstComponent;null!=c;){var d=c.next;0==(c._flags&1)&&(c._flags|=1,c.onStart());c.onUpdate(b);c=d}for(c=a.firstChild;null!=c;)d=c.next,ia.updateEntity(c,b),c=d};ia.prototype={update:function(a){if(!(0>=a)){1<a&&(a=1);for(var b=0;b<this._tickables.length;){var c=this._tickables[b];
null==c||c.update(a)?this._tickables.splice(b,1):++b}j.volume.update(a);ia.updateEntity(j.root,a)}},render:function(a){var b=a.graphics;null!=b&&(a.willRender(),i.render(j.root,b),a.didRender())},addTickable:function(a){this._tickables.push(a)},__class__:ia};var Ab=function(){};e["flambe.platform.MathUtil"]=Ab;Ab.__name__=!0;Ab.nextPowerOfTwo=function(a){for(var b=1;b<a;)b<<=1;return b};var wb=function(){};e["flambe.platform.MouseCodes"]=wb;wb.__name__=!0;wb.toButton=function(a){switch(a){case 0:return J.Left;
case 1:return J.Middle;case 2:return J.Right}return J.Unknown(a)};var Wa=function(){};e["flambe.platform.TextureRoot"]=Wa;Wa.__name__=!0;Wa.prototype={__class__:Wa};var Xa=function(){};e["flambe.platform.Tickable"]=Xa;Xa.__name__=!0;Xa.prototype={__class__:Xa};var Ya=function(a,b){this._firstDraw=!1;this._canvasCtx=a.getContext("2d",{alpha:b})};e["flambe.platform.html.CanvasGraphics"]=Ya;Ya.__name__=!0;Ya.__interfaces__=[ya];Ya.prototype={save:function(){this._canvasCtx.save()},transform:function(a,
b,c,d,f,h){this._canvasCtx.transform(a,b,c,d,f,h)},restore:function(){this._canvasCtx.restore()},drawTexture:function(a,b,c){this.drawSubTexture(a,b,c,0,0,a.get_width(),a.get_height())},drawSubTexture:function(a,b,c,d,f,h,e){this._firstDraw?(this._firstDraw=!1,this._canvasCtx.globalCompositeOperation="copy",this.drawSubTexture(a,b,c,d,f,h,e),this._canvasCtx.globalCompositeOperation="source-over"):this._canvasCtx.drawImage(a.root.image,a.rootX+d|0,a.rootY+f|0,h|0,e|0,b|0,c|0,h|0,e|0)},fillRect:function(a,
b,c,d,f){if(this._firstDraw)this._firstDraw=!1,this._canvasCtx.globalCompositeOperation="copy",this.fillRect(a,b,c,d,f),this._canvasCtx.globalCompositeOperation="source-over";else{for(a=(16777215&a).toString(16);6>a.length;)a="0"+y.string(a);this._canvasCtx.fillStyle="#"+y.string(a);this._canvasCtx.fillRect(b|0,c|0,d|0,f|0)}},multiplyAlpha:function(a){this._canvasCtx.globalAlpha*=a},setBlendMode:function(a){var b;switch(a[1]){case 0:b="source-over";break;case 1:b="lighter";break;case 2:b="multiply";
break;case 3:b="screen";break;case 4:b="destination-in";break;case 5:b="copy"}this._canvasCtx.globalCompositeOperation=b},applyScissor:function(a,b,c,d){this._canvasCtx.beginPath();this._canvasCtx.rect(a|0,b|0,c|0,d|0);this._canvasCtx.clip()},willRender:function(){this._firstDraw=!0},didRender:function(){},onResize:function(){},__class__:Ya};var ja=function(a){this.graphics=new Ya(a,!1);this._hasGPU=new H(!0)};e["flambe.platform.html.CanvasRenderer"]=ja;ja.__name__=!0;ja.__interfaces__=[za];ja.prototype=
{get_type:function(){return R.Canvas},createTextureFromImage:function(a){a=new Aa(ja.CANVAS_TEXTURES?k.createCanvas(a):a);return a.createTexture(a.width,a.height)},getCompressedTextureFormats:function(){return[]},createCompressedTexture:function(){return null},willRender:function(){this.graphics.willRender()},didRender:function(){this.graphics.didRender()},__class__:ja};var Za=function(a,b,c){W.call(this,a,b,c)};e["flambe.platform.html.CanvasTexture"]=Za;Za.__name__=!0;Za.__super__=W;Za.prototype=
n(W.prototype,{__class__:Za});var Aa=function(a){this._graphics=null;this._disposed=!1;this.image=a;this.width=a.width;this.height=a.height};e["flambe.platform.html.CanvasTextureRoot"]=Aa;Aa.__name__=!0;Aa.__interfaces__=[Wa];Aa.__super__=C;Aa.prototype=n(C.prototype,{createTexture:function(a,b){return new Za(this,a,b)},readPixels:function(a,b,c,d){a=this.getContext2d().getImageData(a,b,c,d).data;return pa.ofData(a)},getContext2d:function(){E.__instanceof(this.image,HTMLCanvasElement)||(this.image=
k.createCanvas(this.image));return this.image.getContext("2d")},onDisposed:function(){this._graphics=this.image=null},__class__:Aa});var p=function(a,b){fa.call(this,a,b)};e["flambe.platform.html.HtmlAssetPackLoader"]=p;p.__name__=!0;p.detectImageFormats=function(a){var b=[g.PNG,g.JPG,g.GIF],c=2,d;d=window.document.createElement("img");d.onload=d.onerror=function(){1==d.width&&b.unshift(g.WEBP);--c;0==c&&a(b)};d.src="data:image/webp;base64,UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==";var f;f=
window.document.createElement("img");f.onload=f.onerror=function(){1==f.width&&b.unshift(g.JXR);--c;0==c&&a(b)};f.src="data:image/vnd.ms-photo;base64,SUm8AQgAAAAFAAG8AQAQAAAASgAAAIC8BAABAAAAAQAAAIG8BAABAAAAAQAAAMC8BAABAAAAWgAAAMG8BAABAAAAHwAAAAAAAAAkw91vA07+S7GFPXd2jckNV01QSE9UTwAZAYBxAAAAABP/gAAEb/8AAQAAAQAAAA=="};p.detectAudioFormats=function(){var a;a=window.document.createElement("audio");if(null==a||null==B(a,a.canPlayType))return[];var b=new $("\\b(iPhone|iPod|iPad|Android|Windows Phone)\\b",
""),c=window.navigator.userAgent;if(!q.get_supported()&&b.match(c))return[];for(var b=[{format:g.M4A,mimeType:"audio/mp4; codecs=mp4a"},{format:g.MP3,mimeType:"audio/mpeg"},{format:g.OPUS,mimeType:"audio/ogg; codecs=opus"},{format:g.OGG,mimeType:"audio/ogg; codecs=vorbis"},{format:g.WAV,mimeType:"audio/wav"}],c=[],d=0;d<b.length;){var f=b[d];++d;var h="";try{h=a.canPlayType(f.mimeType)}catch(e){}""!=h&&c.push(f.format)}return c};p.supportsBlob=function(){if(p._detectBlobSupport){p._detectBlobSupport=
!1;if((new $("\\bSilk\\b","")).match(window.navigator.userAgent)||null==window.Blob)return!1;var a=new XMLHttpRequest;a.open("GET",".",!0);if(""!=a.responseType)return!1;a.responseType="blob";if("blob"!=a.responseType)return!1;p._URL=k.loadExtension("URL").value}return null!=p._URL&&null!=p._URL.createObjectURL};p.__super__=fa;p.prototype=n(fa.prototype,{loadEntry:function(a,b){var c=this;switch(b.format[1]){case 0:case 1:case 2:case 3:case 4:var d;d=window.document.createElement("img");var f=new xa;
f.addDisposingListener(d,"load",function(){p.supportsBlob()&&p._URL.revokeObjectURL(d.src);var a=c._platform.getRenderer().createTextureFromImage(d);null!=a?c.handleLoad(b,a):c.handleTextureError(b)});f.addDisposingListener(d,"error",function(){c.handleError(b,"Failed to load image")});p.supportsBlob()?this.download(a,b,"blob",function(a){d.src=p._URL.createObjectURL(a)}):d.src=a;break;case 5:case 6:case 7:this.download(a,b,"arraybuffer",function(){var a=c._platform.getRenderer().createCompressedTexture(b.format,
null);null!=a?c.handleLoad(b,a):c.handleTextureError(b)});break;case 8:case 9:case 10:case 11:case 12:if(q.get_supported())this.download(a,b,"arraybuffer",function(a){q.ctx.decodeAudioData(a,function(a){c.handleLoad(b,new q(a))},function(){c.handleLoad(b,Q.getInstance())})});else{var h;h=window.document.createElement("audio");h.preload="auto";var e=++p._mediaRefCount;null==p._mediaElements&&(p._mediaElements=new Z);p._mediaElements.set(e,h);f=new xa;f.addDisposingListener(h,"canplaythrough",function(){p._mediaElements.remove(e);
c.handleLoad(b,new Ba(h))});f.addDisposingListener(h,"error",function(){p._mediaElements.remove(e);var a=h.error.code;3==a||4==a?c.handleLoad(b,Q.getInstance()):c.handleError(b,"Failed to load audio: "+h.error.code)});f.addListener(h,"progress",function(){if(0<h.buffered.length&&0<h.duration){var a=h.buffered.end(0)/h.duration;c.handleProgress(b,a*b.bytes|0)}});h.src=a;h.load()}break;case 13:this.download(a,b,"text",function(a){c.handleLoad(b,new wa(a))})}},getAssetFormats:function(a){var b=this;
null==p._supportedFormats&&(p._supportedFormats=new Sa,p.detectImageFormats(function(a){p._supportedFormats.set_result(b._platform.getRenderer().getCompressedTextureFormats().concat(a).concat(p.detectAudioFormats()).concat([g.Data]))}));p._supportedFormats.get(a)},download:function(a,b,c,d){var f=this,h=null,e=null,g=0,i=!1,j=function(){i&&(i=!1,window.clearInterval(g))},k=3,l=function(){--k;return 0<=k?(e(),!0):!1},e=function(){j();null!=h&&h.abort();h=new XMLHttpRequest;h.open("GET",a,!0);h.responseType=
c;var e=0;h.onprogress=function(a){i||(i=!0,g=window.setInterval(function(){4!=h.readyState&&5E3<Date.now()-e&&!l()&&(j(),f.handleError(b,"Download stalled"))},1E3));e=Date.now();f.handleProgress(b,a.loaded)};h.onerror=function(){if(0!=h.status||!l())j(),f.handleError(b,"HTTP error "+h.status)};h.onload=function(){var a=h.response;null==a&&(a=h.responseText);j();d(a)};h.send()};e()},__class__:p});var Ha=function(a,b){P.call(this,a);this._canvas=b};e["flambe.platform.html.HtmlMouse"]=Ha;Ha.__name__=
!0;Ha.__super__=P;Ha.prototype=n(P.prototype,{__class__:Ha});var Ba=function(a){this._disposed=!1;this.audioElement=a};e["flambe.platform.html.HtmlSound"]=Ba;Ba.__name__=!0;Ba.__interfaces__=[oa];Ba.__super__=C;Ba.prototype=n(C.prototype,{play:function(a){null==a&&(a=1);return new $a(this,a,!1)},onDisposed:function(){this.audioElement=null},__class__:Ba});var $a=function(a,b,c){var d=this;this._sound=a;this._tickableAdded=!1;this._clonedElement=window.document.createElement("audio");this._clonedElement.loop=
c;this._clonedElement.src=a.audioElement.src;this.volume=new v(b,function(){d.updateVolume()});this.updateVolume();this._complete=new H(!1);this.playAudio();j.hidden._value&&this.set_paused(!0)};e["flambe.platform.html._HtmlSound.HtmlPlayback"]=$a;$a.__name__=!0;$a.__interfaces__=[Xa,Va];$a.prototype={set_paused:function(a){this._clonedElement.paused!=a&&(a?this._clonedElement.pause():this.playAudio());return a},update:function(a){this.volume.update(a);this._complete.set__(this._clonedElement.ended);
return this._complete._value||this._clonedElement.paused?(this._tickableAdded=!1,this._volumeBinding.dispose(),this._hideBinding.dispose(),!0):!1},dispose:function(){this.set_paused(!0);this._complete.set__(!0)},playAudio:function(){var a=this;this._clonedElement.play();this._tickableAdded||(aa.instance.mainLoop.addTickable(this),this._tickableAdded=!0,this._volumeBinding=j.volume.get_changed().connect(function(){a.updateVolume()}),this._hideBinding=j.hidden.get_changed().connect(function(b){b?(a._wasPaused=
a._clonedElement.paused,a.set_paused(!0)):a.set_paused(a._wasPaused)}))},updateVolume:function(){this._clonedElement.volume=j.volume._value*this.volume._value},__class__:$a};var Bb=function(){};e["flambe.subsystem.StageSystem"]=Bb;Bb.__name__=!0;Bb.prototype={__class__:Bb};var ha=function(a){var b=this;this._canvas=a;this.resize=new X;this.scaleFactor=ha.computeScaleFactor();1!=this.scaleFactor&&(k.setVendorStyle(this._canvas,"transform-origin","top left"),k.setVendorStyle(this._canvas,"transform",
"scale("+1/this.scaleFactor+")"));k.SHOULD_HIDE_MOBILE_BROWSER&&(window.addEventListener("orientationchange",function(){k.callLater(B(b,b.hideMobileBrowser),200)},!1),this.hideMobileBrowser());window.addEventListener("resize",B(this,this.onWindowResize),!1);this.onWindowResize(null);this.orientation=new H(null);null!=window.orientation&&(window.addEventListener("orientationchange",B(this,this.onOrientationChange),!1),this.onOrientationChange(null));this.fullscreen=new H(!1);k.addVendorListener(window.document,
"fullscreenchange",function(){b.updateFullscreen()},!1);this.updateFullscreen()};e["flambe.platform.html.HtmlStage"]=ha;ha.__name__=!0;ha.__interfaces__=[Bb];ha.computeScaleFactor=function(){var a=window.devicePixelRatio;null==a&&(a=1);var b=window.document.createElement("canvas").getContext("2d"),b=k.loadExtension("backingStorePixelRatio",b).value;null==b&&(b=1);a/=b;b=window.screen.height;return 1136<a*window.screen.width||1136<a*b?1:a};ha.prototype={get_width:function(){return this._canvas.width},
get_height:function(){return this._canvas.height},onWindowResize:function(){var a=this._canvas.parentElement.getBoundingClientRect();this.resizeCanvas(a.width,a.height)},resizeCanvas:function(a,b){var c=this.scaleFactor*a,d=this.scaleFactor*b;if(this._canvas.width==c&&this._canvas.height==d)return!1;this._canvas.width=c|0;this._canvas.height=d|0;this.resize.emit();return!0},hideMobileBrowser:function(){var a=this,b=window.document.documentElement.style;b.height=window.innerHeight+100+"px";b.width=
window.innerWidth+"px";b.overflow="visible";k.callLater(function(){k.hideMobileBrowser();k.callLater(function(){b.height=window.innerHeight+"px";a.onWindowResize(null)},100)})},onOrientationChange:function(){this.orientation.set__(k.orientation(window.orientation))},updateFullscreen:function(){this.fullscreen.set__(!0==k.loadFirstExtension(["fullscreen","fullScreen","isFullScreen"],window.document).value)},__class__:ha};var k=function(){};e["flambe.platform.html.HtmlUtil"]=k;k.__name__=!0;k.callLater=
function(a,b){null==b&&(b=0);window.setTimeout(a,b)};k.hideMobileBrowser=function(){window.scrollTo(1,0)};k.loadExtension=function(a,b){null==b&&(b=window);var c=sa.field(b,a);if(null!=c)return{prefix:"",field:a,value:c};for(var c=a.charAt(0).toUpperCase()+x.substr(a,1,null),d=0,f=k.VENDOR_PREFIXES;d<f.length;){var h=f[d];++d;var e=h+c,g=sa.field(b,e);if(null!=g)return{prefix:h,field:e,value:g}}return{prefix:null,field:null,value:null}};k.loadFirstExtension=function(a,b){for(var c=0;c<a.length;){var d=
a[c];++c;d=k.loadExtension(d,b);if(null!=d.field)return d}return{prefix:null,field:null,value:null}};k.polyfill=function(a,b){null==b&&(b=window);var c=k.loadExtension(a,b).value;if(null==c)return!1;b[a]=c;return!0};k.setVendorStyle=function(a,b,c){for(var a=a.style,d=0,f=k.VENDOR_PREFIXES;d<f.length;){var h=f[d];++d;a.setProperty("-"+h+"-"+b,c)}a.setProperty(b,c)};k.addVendorListener=function(a,b,c,d){for(var f=0,h=k.VENDOR_PREFIXES;f<h.length;){var e=h[f];++f;a.addEventListener(e+b,c,d)}a.addEventListener(b,
c,d)};k.orientation=function(a){switch(a){case -90:case 90:return ba.Landscape;default:return ba.Portrait}};k.createEmptyCanvas=function(a,b){var c;c=window.document.createElement("canvas");c.width=a;c.height=b;return c};k.createCanvas=function(a){var b=k.createEmptyCanvas(a.width,a.height),c=b.getContext("2d");c.save();c.globalCompositeOperation="copy";c.drawImage(a,0,0);c.restore();return b};k.detectSlowDriver=function(a){if(0<=window.navigator.platform.indexOf("Win")&&null!=window.chrome){for(var b=
0,a=a.getSupportedExtensions();b<a.length;){var c=a[b];++b;if(0<=c.indexOf("WEBGL_compressed_texture"))return!1}return!0}return!1};k.fixAndroidMath=function(){if(0<=window.navigator.userAgent.indexOf("Linux; U; Android 4")){var a=Math.sin,b=Math.cos;Math.sin=function(b){return 0==b?0:a(b)};Math.cos=function(a){return 0==a?1:b(a)}}};var q=function(a){this._disposed=!1;this.buffer=a};e["flambe.platform.html.WebAudioSound"]=q;q.__name__=!0;q.__interfaces__=[oa];q.get_supported=function(){if(q._detectSupport){q._detectSupport=
!1;var a=k.loadExtension("AudioContext").value;null!=a&&(q.ctx=new a,q.gain=q.createGain(),q.gain.connect(q.ctx.destination),j.volume.watch(function(a){q.gain.gain.value=a}))}return null!=q.ctx};q.createGain=function(){return null!=q.ctx.createGain?q.ctx.createGain():q.ctx.createGainNode()};q.start=function(a,b){null!=a.start?a.start(b):a.noteOn(b)};q.__super__=C;q.prototype=n(C.prototype,{play:function(a){null==a&&(a=1);return new ab(this,a,!1)},get_duration:function(){return this.buffer.duration},
onDisposed:function(){this.buffer=null},__class__:q});var ab=function(a,b,c){var d=this;this._sound=a;this._head=q.gain;this._complete=new H(!1);this._sourceNode=q.ctx.createBufferSource();this._sourceNode.buffer=a.buffer;this._sourceNode.loop=c;this._sourceNode.onended=function(){d._complete.set__(!0)};q.start(this._sourceNode,0);this.playAudio();this.volume=new v(b,function(a){d.setVolume(a)});1!=b&&this.setVolume(b);j.hidden._value&&this.set_paused(!0)};e["flambe.platform.html._WebAudioSound.WebAudioPlayback"]=
ab;ab.__name__=!0;ab.__interfaces__=[Xa,Va];ab.prototype={set_paused:function(a){a!=0<=this._pausedAt&&(a?(this._sourceNode.disconnect(),this._pausedAt=this.get_position()):this.playAudio());return a},get_position:function(){return this._complete._value?this._sound.get_duration():0<=this._pausedAt?this._pausedAt:(q.ctx.currentTime-this._startedAt)%this._sound.get_duration()},update:function(a){this.volume.update(a);3==this._sourceNode.playbackState&&this._complete.set__(!0);return this._complete._value||
0<=this._pausedAt?(this._tickableAdded=!1,this._hideBinding.dispose(),!0):!1},dispose:function(){this.set_paused(!0);this._complete.set__(!0)},setVolume:function(a){null==this._gainNode&&(this._gainNode=q.createGain(),this.insertNode(this._gainNode));this._gainNode.gain.value=a},insertNode:function(a){0<=this._pausedAt||(this._sourceNode.disconnect(),this._sourceNode.connect(a));a.connect(this._head);this._head=a},playAudio:function(){var a=this;this._sourceNode.connect(this._head);this._startedAt=
q.ctx.currentTime;this._pausedAt=-1;this._tickableAdded||(aa.instance.mainLoop.addTickable(this),this._tickableAdded=!0,this._hideBinding=j.hidden.get_changed().connect(function(b){b?(a._wasPaused=0<=a._pausedAt,a.set_paused(!0)):a.set_paused(a._wasPaused)}))},__class__:ab};var Cb=function(a){this._quads=this._maxQuads=this._dataOffset=this._backbufferWidth=this._backbufferHeight=0;this._pendingSetScissor=!1;this._lastBlendMode=this._lastRenderTarget=this._lastShader=this._lastTexture=this._lastScissor=
this._currentBlendMode=this._currentShader=this._currentTexture=this._currentRenderTarget=null;this._gl=a;a.clearColor(0,0,0,0);a.enable(3042);a.pixelStorei(37441,1);this._vertexBuffer=a.createBuffer();a.bindBuffer(34962,this._vertexBuffer);this._quadIndexBuffer=a.createBuffer();a.bindBuffer(34963,this._quadIndexBuffer);this._drawTextureShader=new bb(a);this._drawPatternShader=new cb(a);this._fillRectShader=new db(a);this.resize(16)};e["flambe.platform.html.WebGLBatcher"]=Cb;Cb.__name__=!0;Cb.prototype=
{resizeBackbuffer:function(a,b){this._gl.viewport(0,0,a,b);this._backbufferWidth=a;this._backbufferHeight=b},willRender:function(){},didRender:function(){this.flush()},bindTexture:function(a){this.flush();this._currentTexture=this._lastTexture=null;this._gl.bindTexture(3553,a)},deleteTexture:function(a){null!=this._lastTexture&&this._lastTexture.root==a&&(this.flush(),this._currentTexture=this._lastTexture=null);this._gl.deleteTexture(a.nativeTexture)},bindFramebuffer:function(a){a!=this._lastRenderTarget&&
(this.flush(),this.bindRenderTarget(a))},deleteFramebuffer:function(a){a==this._lastRenderTarget&&(this.flush(),this._currentRenderTarget=this._lastRenderTarget=null);this._gl.deleteFramebuffer(a.framebuffer)},prepareDrawTexture:function(a,b,c,d){d!=this._lastTexture&&(this.flush(),this._lastTexture=d);return this.prepareQuad(5,a,b,c,this._drawTextureShader)},prepareFillRect:function(a,b,c){return this.prepareQuad(6,a,b,c,this._fillRectShader)},prepareQuad:function(a,b,c,d,f){b!=this._lastRenderTarget&&
(this.flush(),this._lastRenderTarget=b);c!=this._lastBlendMode&&(this.flush(),this._lastBlendMode=c);f!=this._lastShader&&(this.flush(),this._lastShader=f);if(null!=d||null!=this._lastScissor)if(null==d||null==this._lastScissor||!this._lastScissor.equals(d))this.flush(),this._lastScissor=null!=d?d.clone(this._lastScissor):null,this._pendingSetScissor=!0;this._quads>=this._maxQuads&&this.resize(2*this._maxQuads);++this._quads;b=this._dataOffset;this._dataOffset+=4*a;return b},flush:function(){if(!(1>
this._quads)){this._lastRenderTarget!=this._currentRenderTarget&&this.bindRenderTarget(this._lastRenderTarget);if(this._lastBlendMode!=this._currentBlendMode){switch(this._lastBlendMode[1]){case 0:this._gl.blendFunc(1,771);break;case 1:this._gl.blendFunc(1,1);break;case 2:this._gl.blendFunc(774,771);break;case 3:this._gl.blendFunc(1,769);break;case 4:this._gl.blendFunc(0,770);break;case 5:this._gl.blendFunc(1,0)}this._currentBlendMode=this._lastBlendMode}this._pendingSetScissor&&(null!=this._lastScissor?
(this._gl.enable(3089),this._gl.scissor(this._lastScissor.x|0,this._lastScissor.y|0,this._lastScissor.width|0,this._lastScissor.height|0)):this._gl.disable(3089),this._pendingSetScissor=!1);this._lastTexture!=this._currentTexture&&(this._gl.bindTexture(3553,this._lastTexture.root.nativeTexture),this._currentTexture=this._lastTexture);this._lastShader!=this._currentShader&&(this._lastShader.useProgram(),this._lastShader.prepare(),this._currentShader=this._lastShader);if(this._lastShader==this._drawPatternShader){var a=
this._lastTexture,b=a.root;this._drawPatternShader.setRegion(a.rootX/b.width,a.rootY/b.height,a._width/b.width,a._height/b.height)}this._gl.bufferData(34962,this.data.subarray(0,this._dataOffset),35040);this._gl.drawElements(4,6*this._quads,5123,0);this._dataOffset=this._quads=0}},resize:function(a){this.flush();if(!(1024<a)){this._maxQuads=a;this.data=new Float32Array(24*a);this._gl.bufferData(34962,4*this.data.length,35040);for(var b=new Uint16Array(6*a),c=0;c<a;){var d=c++;b[6*d]=4*d;b[6*d+1]=
4*d+1;b[6*d+2]=4*d+2;b[6*d+3]=4*d+2;b[6*d+4]=4*d+3;b[6*d+5]=4*d}this._gl.bufferData(34963,b,35044)}},bindRenderTarget:function(a){null!=a?(this._gl.bindFramebuffer(36160,a.framebuffer),this._gl.viewport(0,0,a.width,a.height)):(this._gl.bindFramebuffer(36160,null),this._gl.viewport(0,0,this._backbufferWidth,this._backbufferHeight));this._lastRenderTarget=this._currentRenderTarget=a},__class__:Cb};var S=function(a,b){this._inverseProjection=this._stateList=null;null==S._scratchQuadArray&&(S._scratchQuadArray=
new Float32Array(8));this._batcher=a;this._renderTarget=b};e["flambe.platform.html.WebGLGraphics"]=S;S.__name__=!0;S.__interfaces__=[ya];S.prototype={save:function(){var a=this._stateList,b=this._stateList.next;null==b&&(b=new eb,b.prev=a,a.next=b);a.matrix.clone(b.matrix);b.alpha=a.alpha;b.blendMode=a.blendMode;b.scissor=null!=a.scissor?a.scissor.clone(b.scissor):null;this._stateList=b},transform:function(a,b,c,d,f,h){var e=this._stateList;S._scratchMatrix.set(a,b,c,d,f,h);T.multiply(e.matrix,S._scratchMatrix,
e.matrix)},restore:function(){this._stateList=this._stateList.prev},drawTexture:function(a,b,c){this.drawSubTexture(a,b,c,0,0,a.get_width(),a.get_height())},drawSubTexture:function(a,b,c,d,f,h,e){var g=this._stateList,i=a.root,b=this.transformQuad(b,c,h,e),c=i.width,i=i.height,d=(a.rootX+d)/c,f=(a.rootY+f)/i,h=d+h/c,e=f+e/i,c=g.alpha,a=this._batcher.prepareDrawTexture(this._renderTarget,g.blendMode,g.scissor,a),g=this._batcher.data;g[a]=b[0];g[++a]=b[1];g[++a]=d;g[++a]=f;g[++a]=c;g[++a]=b[2];g[++a]=
b[3];g[++a]=h;g[++a]=f;g[++a]=c;g[++a]=b[4];g[++a]=b[5];g[++a]=h;g[++a]=e;g[++a]=c;g[++a]=b[6];g[++a]=b[7];g[++a]=d;g[++a]=e;g[++a]=c},fillRect:function(a,b,c,d,f){var h=this._stateList,b=this.transformQuad(b,c,d,f),c=(a&16711680)/16711680,d=(a&65280)/65280,a=(a&255)/255,f=h.alpha,h=this._batcher.prepareFillRect(this._renderTarget,h.blendMode,h.scissor),e=this._batcher.data;e[h]=b[0];e[++h]=b[1];e[++h]=c;e[++h]=d;e[++h]=a;e[++h]=f;e[++h]=b[2];e[++h]=b[3];e[++h]=c;e[++h]=d;e[++h]=a;e[++h]=f;e[++h]=
b[4];e[++h]=b[5];e[++h]=c;e[++h]=d;e[++h]=a;e[++h]=f;e[++h]=b[6];e[++h]=b[7];e[++h]=c;e[++h]=d;e[++h]=a;e[++h]=f},multiplyAlpha:function(a){this._stateList.alpha*=a},setBlendMode:function(a){this._stateList.blendMode=a},applyScissor:function(a,b,c,d){var f=this._stateList,e=S._scratchQuadArray;e[0]=a;e[1]=b;e[2]=a+c;e[3]=b+d;f.matrix.transformArray(e,4,e);this._inverseProjection.transformArray(e,4,e);a=e[0];b=e[1];c=e[2]-a;d=e[3]-b;0>c&&(a+=c,c=-c);0>d&&(b+=d,d=-d);f.applyScissor(a,b,c,d)},willRender:function(){this._batcher.willRender()},
didRender:function(){this._batcher.didRender()},onResize:function(a,b){this._stateList=new eb;var c;c=null!=this._renderTarget?-1:1;this._stateList.matrix.set(2/a,0,0,-2*c/b,-1,c);this._inverseProjection=new T;this._inverseProjection.set(2/a,0,0,2/b,-1,-1);this._inverseProjection.invert()},transformQuad:function(a,b,c,d){var c=a+c,d=b+d,f=S._scratchQuadArray;f[0]=a;f[1]=b;f[2]=c;f[3]=b;f[4]=c;f[5]=d;f[6]=a;f[7]=d;this._stateList.matrix.transformArray(f,8,f);return f},__class__:S};var eb=function(){this.scissor=
this.prev=this.next=null;this.matrix=new T;this.alpha=1;this.blendMode=u.Normal};e["flambe.platform.html._WebGLGraphics.DrawingState"]=eb;eb.__name__=!0;eb.prototype={applyScissor:function(a,b,c,d){if(null!=this.scissor)var f=O.max(this.scissor.x,a),e=O.max(this.scissor.y,b),c=O.min(this.scissor.x+this.scissor.width,a+c),d=O.min(this.scissor.y+this.scissor.height,b+d),a=f,b=e,c=c-f,d=d-e;else this.scissor=new la;this.scissor.set(Math.round(a),Math.round(b),Math.round(c),Math.round(d))},__class__:eb};
var La=function(a,b){var c=this;this._hasGPU=new H(!0);this.gl=b;b.canvas.addEventListener("webglcontextlost",function(a){a.preventDefault();c._hasGPU.set__(!1)},!1);b.canvas.addEventListener("webglcontextrestore",function(){c.init();c._hasGPU.set__(!0)},!1);a.resize.connect(B(this,this.onResize));this.init()};e["flambe.platform.html.WebGLRenderer"]=La;La.__name__=!0;La.__interfaces__=[za];La.prototype={get_type:function(){return R.WebGL},createTextureFromImage:function(a){if(this.gl.isContextLost())return null;
var b=new ga(this,a.width,a.height);b.uploadImageData(a);return b.createTexture(a.width,a.height)},getCompressedTextureFormats:function(){return[]},createCompressedTexture:function(){this.gl.isContextLost();return null},willRender:function(){this.graphics.willRender()},didRender:function(){this.graphics.didRender()},onResize:function(){var a=this.gl.canvas.width,b=this.gl.canvas.height;this.batcher.resizeBackbuffer(a,b);this.graphics.onResize(a,b)},init:function(){this.batcher=new Cb(this.gl);this.graphics=
new S(this.batcher,null);this.onResize()},__class__:La};var fb=function(a,b,c){W.call(this,a,b,c)};e["flambe.platform.html.WebGLTexture"]=fb;fb.__name__=!0;fb.__super__=W;fb.prototype=n(W.prototype,{__class__:fb});var ga=function(a,b,c){this.framebuffer=this._graphics=null;this._disposed=!1;this._renderer=a;this.width=O.max(2,Ab.nextPowerOfTwo(b));this.height=O.max(2,Ab.nextPowerOfTwo(c));b=a.gl;this.nativeTexture=b.createTexture();a.batcher.bindTexture(this.nativeTexture);b.texParameteri(3553,10242,
33071);b.texParameteri(3553,10243,33071);b.texParameteri(3553,10240,9729);b.texParameteri(3553,10241,9728)};e["flambe.platform.html.WebGLTextureRoot"]=ga;ga.__name__=!0;ga.__interfaces__=[Wa];ga.drawBorder=function(a,b,c){var d=a.getContext("2d");d.drawImage(a,b-1,0,1,c,b,0,1,c);d.drawImage(a,0,c-1,b,1,0,c,b,1)};ga.__super__=C;ga.prototype=n(C.prototype,{createTexture:function(a,b){return new fb(this,a,b)},uploadImageData:function(a){if(this.width!=a.width||this.height!=a.height){var b=k.createEmptyCanvas(this.width,
this.height);b.getContext("2d").drawImage(a,0,0);ga.drawBorder(b,a.width,a.height);a=b}this._renderer.batcher.bindTexture(this.nativeTexture);this._renderer.gl.texImage2D(3553,0,6408,6408,5121,a)},readPixels:function(a,b,c,d){this.getGraphics();this._renderer.batcher.bindFramebuffer(this);var f=new Uint8Array(4*c*d);this._renderer.gl.readPixels(a,b,c,d,6408,5121,f);a=0;for(b=f.length;a<b;)c=255/f[a+3],f[a]*=c,++a,f[a]*=c,++a,f[a]*=c,a+=2;return pa.ofData(f)},getGraphics:function(){if(null==this._graphics){this._graphics=
new S(this._renderer.batcher,this);this._graphics.onResize(this.width,this.height);var a=this._renderer.gl;this.framebuffer=a.createFramebuffer();this._renderer.batcher.bindFramebuffer(this);a.framebufferTexture2D(36160,36064,3553,this.nativeTexture,0)}return this._graphics},onDisposed:function(){var a=this._renderer.batcher;a.deleteTexture(this);null!=this.framebuffer&&a.deleteFramebuffer(this);this._graphics=this.framebuffer=this.nativeTexture=null},__class__:ga});var M=function(a,b,c){c="#ifdef GL_ES\nprecision mediump float;\n#endif\n"+
c;this._gl=a;this._program=a.createProgram();a.attachShader(this._program,M.createShader(a,35633,b));a.attachShader(this._program,M.createShader(a,35632,c));a.linkProgram(this._program);a.useProgram(this._program)};e["flambe.platform.shader.ShaderGL"]=M;M.__name__=!0;M.createShader=function(a,b,c){b=a.createShader(b);a.shaderSource(b,c);a.compileShader(b);return b};M.prototype={useProgram:function(){this._gl.useProgram(this._program)},prepare:function(){null},getAttribLocation:function(a){return this._gl.getAttribLocation(this._program,
a)},getUniformLocation:function(a){return this._gl.getUniformLocation(this._program,a)},__class__:M};var cb=function(a){M.call(this,a,"attribute highp vec2 a_pos;\nattribute mediump vec2 a_uv;\nattribute lowp float a_alpha;\nvarying mediump vec2 v_uv;\nvarying lowp float v_alpha;\nvoid main (void) {\nv_uv = a_uv;\nv_alpha = a_alpha;\ngl_Position = vec4(a_pos, 0, 1);\n}","varying mediump vec2 v_uv;\nvarying lowp float v_alpha;\nuniform lowp sampler2D u_texture;\nuniform mediump vec4 u_region;\nvoid main (void) {\ngl_FragColor = texture2D(u_texture, u_region.xy + mod(v_uv, u_region.zw)) * v_alpha;\n}");
this.a_pos=this.getAttribLocation("a_pos");this.a_uv=this.getAttribLocation("a_uv");this.a_alpha=this.getAttribLocation("a_alpha");this.u_texture=this.getUniformLocation("u_texture");this.u_region=this.getUniformLocation("u_region");this.setTexture(0)};e["flambe.platform.shader.DrawPatternGL"]=cb;cb.__name__=!0;cb.__super__=M;cb.prototype=n(M.prototype,{setTexture:function(a){this._gl.uniform1i(this.u_texture,a)},setRegion:function(a,b,c,d){this._gl.uniform4f(this.u_region,a,b,c,d)},prepare:function(){this._gl.enableVertexAttribArray(this.a_pos);
this._gl.enableVertexAttribArray(this.a_uv);this._gl.enableVertexAttribArray(this.a_alpha);this._gl.vertexAttribPointer(this.a_pos,2,5126,!1,20,0);this._gl.vertexAttribPointer(this.a_uv,2,5126,!1,20,8);this._gl.vertexAttribPointer(this.a_alpha,1,5126,!1,20,16)},__class__:cb});var bb=function(a){M.call(this,a,"attribute highp vec2 a_pos;\nattribute mediump vec2 a_uv;\nattribute lowp float a_alpha;\nvarying mediump vec2 v_uv;\nvarying lowp float v_alpha;\nvoid main (void) {\nv_uv = a_uv;\nv_alpha = a_alpha;\ngl_Position = vec4(a_pos, 0, 1);\n}",
"varying mediump vec2 v_uv;\nvarying lowp float v_alpha;\nuniform lowp sampler2D u_texture;\nvoid main (void) {\ngl_FragColor = texture2D(u_texture, v_uv) * v_alpha;\n}");this.a_pos=this.getAttribLocation("a_pos");this.a_uv=this.getAttribLocation("a_uv");this.a_alpha=this.getAttribLocation("a_alpha");this.u_texture=this.getUniformLocation("u_texture");this.setTexture(0)};e["flambe.platform.shader.DrawTextureGL"]=bb;bb.__name__=!0;bb.__super__=M;bb.prototype=n(M.prototype,{setTexture:function(a){this._gl.uniform1i(this.u_texture,
a)},prepare:function(){this._gl.enableVertexAttribArray(this.a_pos);this._gl.enableVertexAttribArray(this.a_uv);this._gl.enableVertexAttribArray(this.a_alpha);this._gl.vertexAttribPointer(this.a_pos,2,5126,!1,20,0);this._gl.vertexAttribPointer(this.a_uv,2,5126,!1,20,8);this._gl.vertexAttribPointer(this.a_alpha,1,5126,!1,20,16)},__class__:bb});var db=function(a){M.call(this,a,"attribute highp vec2 a_pos;\nattribute lowp vec3 a_rgb;\nattribute lowp float a_alpha;\nvarying lowp vec4 v_color;\nvoid main (void) {\nv_color = vec4(a_rgb*a_alpha, a_alpha);\ngl_Position = vec4(a_pos, 0, 1);\n}",
"varying lowp vec4 v_color;\nvoid main (void) {\ngl_FragColor = v_color;\n}");this.a_pos=this.getAttribLocation("a_pos");this.a_rgb=this.getAttribLocation("a_rgb");this.a_alpha=this.getAttribLocation("a_alpha")};e["flambe.platform.shader.FillRectGL"]=db;db.__name__=!0;db.__super__=M;db.prototype=n(M.prototype,{prepare:function(){this._gl.enableVertexAttribArray(this.a_pos);this._gl.enableVertexAttribArray(this.a_rgb);this._gl.enableVertexAttribArray(this.a_alpha);this._gl.vertexAttribPointer(this.a_pos,
2,5126,!1,24,0);this._gl.vertexAttribPointer(this.a_rgb,3,5126,!1,24,8);this._gl.vertexAttribPointer(this.a_alpha,1,5126,!1,24,20)},__class__:db});var Db=function(){this._transitor=null};e["flambe.scene.Director"]=Db;Db.__name__=!0;Db.__super__=r;Db.prototype=n(r.prototype,{get_name:function(){return"Director_7"},onAdded:function(){this.owner.addChild(this._root)},onRemoved:function(){this.completeTransition();for(var a=0,b=this.scenes;a<b.length;){var c=b[a];++a;c.dispose()}this.scenes=[];this.occludedScenes=
[];this._root.dispose()},onUpdate:function(a){null!=this._transitor&&this._transitor.update(a)&&this.completeTransition()},get_topScene:function(){var a=this.scenes.length;return 0<a?this.scenes[a-1]:null},show:function(a){a=a._compMap.Scene_9;null!=a&&a.shown.emit()},invalidateVisibility:function(){for(var a=this.scenes.length;0<a;){var b=this.scenes[--a]._compMap.Scene_9;if(null==b||b.opaque)break}this.occludedScenes=0<this.scenes.length?this.scenes.slice(a,this.scenes.length-1):[];a=this.get_topScene();
null!=a&&this.show(a)},completeTransition:function(){null!=this._transitor&&(this._transitor.complete(),this._transitor=null,this.invalidateVisibility())},__class__:Db});var Tb=function(){};e["flambe.scene._Director.Transitor"]=Tb;Tb.__name__=!0;Tb.prototype={update:function(a){return this._transition.update(a)},complete:function(){this._transition.complete();this._onComplete()},__class__:Tb};var Eb=function(){};e["flambe.scene.Scene"]=Eb;Eb.__name__=!0;Eb.__super__=r;Eb.prototype=n(r.prototype,{get_name:function(){return"Scene_9"},
__class__:Eb});var Ub=function(){};e["flambe.scene.Transition"]=Ub;Ub.__name__=!0;Ub.prototype={update:function(){return!0},complete:function(){},__class__:Ub};var R=e["flambe.subsystem.RendererType"]={__ename__:!0,__constructs__:["Stage3D","WebGL","Canvas"]};R.Stage3D=["Stage3D",0];R.Stage3D.toString=m;R.Stage3D.__enum__=R;R.WebGL=["WebGL",1];R.WebGL.toString=m;R.WebGL.__enum__=R;R.Canvas=["Canvas",2];R.Canvas.toString=m;R.Canvas.__enum__=R;var gb=function(){};e["flambe.swf.Symbol"]=gb;gb.__name__=
!0;gb.prototype={__class__:gb};var hb=function(a,b){this._name=a.symbol;var c=a.rect;this.texture=b.subTexture(c[0],c[1],c[2],c[3]);c=a.origin;null!=c?(this.anchorX=c[0],this.anchorY=c[1]):this.anchorY=this.anchorX=0};e["flambe.swf.BitmapSymbol"]=hb;hb.__name__=!0;hb.__interfaces__=[gb];hb.prototype={createSprite:function(){var a=new w(this.texture);a.setAnchor(this.anchorX,this.anchorY);return a},__class__:hb};var Fb=function(a,b){this._file=a.getFile(b+"/library.json");var c=JSON.parse(this._file.toString());
this._symbols=new V;this.frameRate=c.frameRate;for(var d=[],f=0,e=c.movies;f<e.length;){var g=e[f];++f;g=new ib(this,g);d.push(g);this._symbols.set(g._name,g)}c=c.textureGroups;(1!=c[0].scaleFactor||1<c.length)&&null;c=c[0].atlases;for(f=0;f<c.length;){var i=c[f];++f;e=a.getTexture(b+"/"+A.removeFileExtension(i.file));g=0;for(i=i.textures;g<i.length;){var j=i[g];++g;j=new hb(j,e);this._symbols.set(j._name,j)}}for(c=0;c<d.length;){e=d[c];++c;f=0;for(e=e.layers;f<e.length;){g=e[f];++f;g=g.keyframes;
i=g.length;for(j=0;j<i;){var k=j++,l=g[k];if(null!=l.symbolName){var m=this._symbols.get(l.symbolName);l.symbol=m}if(l.tweened&&1==l.duration&&k+1<i&&(k=g[k+1],!k.visible||null==k.symbolName))l.visible=!1}}}};e["flambe.swf.Library"]=Fb;Fb.__name__=!0;Fb.prototype={createSprite:function(a,b){null==b&&(b=!0);var c=this._symbols.get(a);if(null==c){if(b)throw A.withFields("Missing symbol",["name",a]);return null}return c.createSprite()},__class__:Fb};var jb=function(a){this._oneshotSprite=this._loopingSprite=
null;r.call(this);this._lib=a;this._root=new o;this.movie=new H(null);this.setCache(!0)};e["flambe.swf.MoviePlayer"]=jb;jb.__name__=!0;jb.__super__=r;jb.prototype=n(r.prototype,{get_name:function(){return"MoviePlayer_3"},setCache:function(a){this._cache=a?new V:null;return this},loop:function(a,b){null==b&&(b=!0);if(b||null==this._loopingSprite||this._loopingSprite.symbol._name!=a)this._oneshotSprite=null,this._loopingSprite=this.playFromCache(a);return this},onAdded:function(){this.owner.addChild(this._root)},
onRemoved:function(){this._root.dispose();this._oneshotSprite=this._loopingSprite=null;this.movie.set__(null)},onUpdate:function(a){null!=this._oneshotSprite&&this._oneshotSprite._position+a>this._oneshotSprite.symbol.duration&&(this._oneshotSprite=null,this.setCurrent(this._loopingSprite))},playFromCache:function(a){var b;null!=this._cache?(b=this._cache.get(a),null!=b?b.set_position(0):(b=this.createMovie(a),this._cache.set(a,b))):b=this.createMovie(a);return this.setCurrent(b)},createMovie:function(a){a=
this._lib.createSprite(a,!0);null!=this._decorator&&this._decorator(a);return a},setCurrent:function(a){this._root.add(a);return this.movie.set__(a)},__class__:jb});var Ca=function(a){this._looped=null;i.call(this);this.symbol=a;this.speed=new v(1);this._animators=Array(a.layers.length);for(var b=0,c=this._animators.length;b<c;){var d=b++;this._animators[d]=new Gb(a.layers[d])}this._position=this._frame=0;this["goto"](1)};e["flambe.swf.MovieSprite"]=Ca;Ca.__name__=!0;Ca.__super__=i;Ca.prototype=n(i.prototype,
{getLayer:function(a,b){null==b&&(b=!0);for(var c=0,d=this._animators;c<d.length;){var f=d[c];++c;if(f.layer.name==a)return f.content}if(b)throw A.withFields("Missing layer",["name",a]);return null},onAdded:function(){i.prototype.onAdded.call(this);for(var a=0,b=this._animators;a<b.length;){var c=b[a];++a;this.owner.addChild(c.content)}},onRemoved:function(){i.prototype.onRemoved.call(this);for(var a=0,b=this._animators;a<b.length;){var c=b[a];++a;this.owner.removeChild(c.content)}},onUpdate:function(a){i.prototype.onUpdate.call(this,
a);this.speed.update(a);switch(this._flags&384){case 0:this._position+=this.speed._value*a;this._position>this.symbol.duration&&(this._position%=this.symbol.duration,null!=this._looped&&this._looped.emit());break;case 256:this._flags&=-257}this["goto"](this._position*this.symbol.frameRate)},"goto":function(a){if(this._frame!=a){if(a<this._frame)for(var b=0,c=this._animators;b<c.length;){var d=c[b];++b;d.needsKeyframeUpdate=!0;d.keyframeIdx=0}b=0;for(c=this._animators;b<c.length;)d=c[b],++b,d.composeFrame(a);
this._frame=a}},set_position:function(a){return this._position=O.clamp(a,0,this.symbol.duration)},set_paused:function(a){this._flags=qb.set(this._flags,128,a);return a},rewind:function(){this._position=0;this._flags|=256},__class__:Ca});var Gb=function(a){this.keyframeIdx=0;this.needsKeyframeUpdate=!1;this.layer=a;this.content=new o;if(a.empty)this._sprites=null;else{this._sprites=Array(a.keyframes.length);for(var b=0,c=this._sprites.length;b<c;){var d=b++,f=a.keyframes[d];this._sprites[d]=0<d&&a.keyframes[d-
1].symbol==f.symbol?this._sprites[d-1]:null==f.symbol?new i:f.symbol.createSprite()}this.content.add(this._sprites[0])}};e["flambe.swf._MovieSprite.LayerAnimator"]=Gb;Gb.__name__=!0;Gb.prototype={composeFrame:function(a){if(null!=this._sprites){var b=this.layer.keyframes,c=b.length-1;if(a>this.layer.frames)this.content._compMap.Sprite_4.set_visible(!1),this.keyframeIdx=c,this.needsKeyframeUpdate=!0;else{for(;this.keyframeIdx<c&&b[this.keyframeIdx+1].index<=a;)++this.keyframeIdx,this.needsKeyframeUpdate=
!0;var d;this.needsKeyframeUpdate?(this.needsKeyframeUpdate=!1,d=this._sprites[this.keyframeIdx],d!=this.content._compMap.Sprite_4&&(Ga.getClass(d)==Ca&&d.rewind(),this.content.add(d))):d=this.content._compMap.Sprite_4;var f=b[this.keyframeIdx],e=f.visible&&null!=f.symbol;d.set_visible(e);if(e){var e=f.x,g=f.y,i=f.scaleX,j=f.scaleY,k=f.skewX,l=f.skewY,m=f.alpha;if(f.tweened&&this.keyframeIdx<c){a=(a-f.index)/f.duration;c=f.ease;if(0!=c){var n;0>c?(n=1-a,n=1-n*n,c=-c):n=a*a;a=c*n+(1-c)*a}b=b[this.keyframeIdx+
1];e+=(b.x-e)*a;g+=(b.y-g)*a;i+=(b.scaleX-i)*a;j+=(b.scaleY-j)*a;k+=(b.skewX-k)*a;l+=(b.skewY-l)*a;m+=(b.alpha-m)*a}b=d.getLocalMatrix();a=Math.sin(k);k=Math.cos(k);c=Math.sin(l);l=Math.cos(l);b.set(l*i,c*i,-a*j,k*j,e,g);b.translate(-f.pivotX,-f.pivotY);d.alpha.set__(m)}}}},__class__:Gb};var ib=function(a,b){this._name=b.id;this.frameRate=a.frameRate;this.frames=0;this.layers=Array(b.layers.length);for(var c=0,d=this.layers.length;c<d;){var f=c++,e=new Hb(b.layers[f]);this.frames=Math.max(e.frames,
this.frames);this.layers[f]=e}this.duration=this.frames/this.frameRate};e["flambe.swf.MovieSymbol"]=ib;ib.__name__=!0;ib.__interfaces__=[gb];ib.prototype={createSprite:function(){return new Ca(this)},__class__:ib};var Hb=function(a){this.empty=!0;this.name=a.name;var b=null;this.keyframes=Array(a.keyframes.length);for(var c=0,d=this.keyframes.length;c<d;){var f=c++,b=new Ib(a.keyframes[f],b);this.keyframes[f]=b;this.empty=this.empty&&null==b.symbolName}this.frames=null!=b?b.index+b.duration:0};e["flambe.swf.MovieLayer"]=
Hb;Hb.__name__=!0;Hb.prototype={__class__:Hb};var Ib=function(a,b){this.ease=0;this.visible=this.tweened=!0;this.alpha=1;this.skewX=this.skewY=this.pivotX=this.pivotY=0;this.scaleX=this.scaleY=1;this.x=this.y=0;this.symbol=null;this.index=null!=b?b.index+b.duration:0;this.duration=a.duration;this.label=a.label;this.symbolName=a.ref;var c=a.loc;null!=c&&(this.x=c[0],this.y=c[1]);c=a.scale;null!=c&&(this.scaleX=c[0],this.scaleY=c[1]);c=a.skew;null!=c&&(this.skewX=c[0],this.skewY=c[1]);c=a.pivot;null!=
c&&(this.pivotX=c[0],this.pivotY=c[1]);null!=a.alpha&&(this.alpha=a.alpha);null!=a.visible&&(this.visible=a.visible);null!=a.tweened&&(this.tweened=a.tweened);null!=a.ease&&(this.ease=a.ease)};e["flambe.swf.MovieKeyframe"]=Ib;Ib.__name__=!0;Ib.prototype={__class__:Ib};var Qb=function(){};e["flambe.util.Assert"]=Qb;Qb.__name__=!0;Qb.that=function(){};var qb=function(){};e["flambe.util.BitSets"]=qb;qb.__name__=!0;qb.set=function(a,b,c){return c?a|b:a&~b};var Sa=function(){this.success=new t;this.error=
new t;this.progressChanged=new X;this.hasResult=!1;this._total=this._progress=0};e["flambe.util.Promise"]=Sa;Sa.__name__=!0;Sa.prototype={set_result:function(a){if(this.hasResult)throw"Promise result already assigned";this._result=a;this.hasResult=!0;this.success.emit(a);return a},get:function(a){return this.hasResult?(a(this._result),null):this.success.connect(a).once()},set_progress:function(a){this._progress!=a&&(this._progress=a,this.progressChanged.emit());return a},set_total:function(a){this._total!=
a&&(this._total=a,this.progressChanged.emit());return a},__class__:Sa};var X=function(a){z.call(this,a)};e["flambe.util.Signal0"]=X;X.__name__=!0;X.__super__=z;X.prototype=n(z.prototype,{connect:function(a,b){null==b&&(b=!1);return this.connectImpl(a,b)},emit:function(){var a=this;this._head==z.DISPATCHING_SENTINEL?this.defer(function(){a.emitImpl()}):this.emitImpl()},emitImpl:function(){for(var a=this.willEmit(),b=a;null!=b;)b._listener(),b.stayInList||b.dispose(),b=b._next;this.didEmit(a)},__class__:X});
var nb=function(a){this.next=null;this.fn=a};e["flambe.util._SignalBase.Task"]=nb;nb.__name__=!0;nb.prototype={__class__:nb};var A=function(){};e["flambe.util.Strings"]=A;A.__name__=!0;A.getFileExtension=function(a){var b=a.lastIndexOf(".");return 0<b?x.substr(a,b+1,null):null};A.removeFileExtension=function(a){var b=a.lastIndexOf(".");return 0<b?x.substr(a,0,b):a};A.getUrlExtension=function(a){var b=a.lastIndexOf("?");0<=b&&(a=x.substr(a,0,b));b=a.lastIndexOf("/");0<=b&&(a=x.substr(a,b+1,null));
return A.getFileExtension(a)};A.joinPath=function(a,b){0<a.length&&47!=a.charCodeAt(a.length-1)&&(a+="/");return a+b};A.withFields=function(a,b){var c=b.length;if(0<c){for(var a=0<a.length?a+" [":a+"[",d=0;d<c;){0<d&&(a+=", ");var f=b[d],e=b[d+1];if(y.is(e,Error)){var g=e.stack;null!=g&&(e=g)}a+=f+"="+y.string(e);d+=2}a+="]"}return a};var Z=function(){this.h={}};e["haxe.ds.IntMap"]=Z;Z.__name__=!0;Z.__interfaces__=[Kb];Z.prototype={set:function(a,b){this.h[a]=b},get:function(a){return this.h[a]},
exists:function(a){return this.h.hasOwnProperty(a)},remove:function(a){if(!this.h.hasOwnProperty(a))return!1;delete this.h[a];return!0},__class__:Z};var V=function(){this.h={}};e["haxe.ds.StringMap"]=V;V.__name__=!0;V.__interfaces__=[Kb];V.prototype={set:function(a,b){this.h["$"+a]=b},get:function(a){return this.h["$"+a]},keys:function(){var a=[],b;for(b in this.h)this.h.hasOwnProperty(b)&&a.push(b.substr(1));return x.iter(a)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},
next:function(){return this.ref["$"+this.it.next()]}}},__class__:V};var pa=function(a,b){this.length=a;this.b=b};e["haxe.io.Bytes"]=pa;pa.__name__=!0;pa.ofData=function(a){return new pa(a.length,a)};pa.prototype={__class__:pa};var Vb=function(){};e["haxe.io.Eof"]=Vb;Vb.__name__=!0;Vb.prototype={toString:function(){return"Eof"},__class__:Vb};var Pb=function(){};e["haxe.rtti.Meta"]=Pb;Pb.__name__=!0;Pb.getType=function(a){a=a.__meta__;return null==a||null==a.obj?{}:a.obj};var E=function(){};e["js.Boot"]=
E;E.__name__=!0;E.getClass=function(a){return a instanceof Array&&null==a.__enum__?Array:a.__class__};E.__string_rec=function(a,b){if(null==a)return"null";if(5<=b.length)return"<...>";var c=typeof a;if("function"==c&&(a.__name__||a.__ename__))c="object";switch(c){case "object":if(a instanceof Array){if(a.__enum__){if(2==a.length)return a[0];for(var c=a[0]+"(",b=b+"\t",d=2,f=a.length;d<f;)var e=d++,c=2!=e?c+(","+E.__string_rec(a[e],b)):c+E.__string_rec(a[e],b);return c+")"}c=a.length;d="[";b+="\t";
for(f=0;f<c;)e=f++,d+=(0<e?",":"")+E.__string_rec(a[e],b);return d+"]"}try{d=a.toString}catch(g){return"???"}if(null!=d&&d!=Object.toString&&(c=a.toString(),"[object Object]"!=c))return c;c=null;d="{\n";b+="\t";f=null!=a.hasOwnProperty;for(c in a)if(!f||a.hasOwnProperty(c))"prototype"==c||"__class__"==c||"__super__"==c||"__interfaces__"==c||"__properties__"==c||(2!=d.length&&(d+=", \n"),d+=b+c+" : "+E.__string_rec(a[c],b));b=b.substring(1);return d+("\n"+b+"}");case "function":return"<function>";
case "string":return a;default:return""+a}};E.__interfLoop=function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var d=0,f=c.length;d<f;){var e=d++,e=c[e];if(e==b||E.__interfLoop(e,b))return!0}return E.__interfLoop(a.__super__,b)};E.__instanceof=function(a,b){if(null==b)return!1;switch(b){case ac:return(a|0)===a;case Yb:return"number"==typeof a;case Zb:return"boolean"==typeof a;case String:return"string"==typeof a;case Array:return a instanceof Array&&null==a.__enum__;
case bc:return!0;default:if(null!=a){if("function"==typeof b&&(a instanceof b||E.__interfLoop(E.getClass(a),b)))return!0}else return!1;return b==cc&&null!=a.__name__||b==dc&&null!=a.__ename__?!0:a.__enum__==b}};var Nb=function(){};e["js.html._CanvasElement.CanvasUtil"]=Nb;Nb.__name__=!0;Nb.getContextWebGL=function(a,b){for(var c=0,d=["webgl","experimental-webgl"];c<d.length;){var f=d[c];++c;f=a.getContext(f,b);if(null!=f)return f}return null};var K=function(){this.touched=0;this.speed=0.75;this.fixedSpeed=
0.5;this.textEntity=new o;r.call(this)};e["urgame.Balloon"]=K;K.__name__=!0;K.__super__=r;K.prototype=n(r.prototype,{get_name:function(){return"Balloon_1"},onAdded:function(){this.speed=this.fixedSpeed+0.5*Math.random()*this.fixedSpeed;this.answerSprite=new ca(l.font);this.sprite=new w(l.assetPack.getTexture("balloon"));var a=new Fb(l.assetPack,"BaloonAnim");this.moviePlayer=new jb(a);this.owner.add(this.moviePlayer);this.moviePlayer.loop("Sway");this.startAnimAfter=100*Math.random();this.movieSprite=
this.moviePlayer.movie._value;this.movieSprite.set_paused(!0);this.swfEntity=this.movieSprite.getLayer("L1");a=i.getBounds(this.owner);this.width=a.width;this.height=a.height;this.owner._compMap.Sprite_4.get_pointerDown().connect(B(this,this.handleTouch)).once();s.popBalloon.connect(B(this,this.mapBalloon))},setSpeed:function(a){this.speed=a},handleTouch:function(a){this.touchPointX=a.viewX;this.touchPointY=a.viewY;D.poppedBalloon=this;this.touched=1;s.checkAnswer.emit()},mapBalloon:function(){var a=
this.touched;if(1==(0>a?4294967296+a:a+0)){this.owner._compMap.Sprite_4.set_visible(!1);if(null==K.particlesArrayCopyForOthers){K.particlesArrayCopyForOthers=[];for(var a=this.height,b=this.width,c=Math.floor(b/3),d=Math.floor(a/3),f=0;f<c;)for(var e=f++,g=0;g<d;){var i=g++,j=this.sprite.texture.readPixels(3*e,3*i,1,1).b;if(0<j.length&&0!=j[j.length-1]){var j=new Da,k=3*e;j.x=0>k?4294967296+k:k+0;i*=3;j.y=0>i?4294967296+i:i+0;j.acc_x=0;j.acc_y=j.gravity;i=Math.random()*j.xSpeed;k=Math.random()*j.ySpeed+
3;j.x<=0.5*b&&j.y<=0.5*a?(j.vel_x=-i,j.vel_y=-k):j.x>0.5*b&&j.y<=0.5*a?(j.vel_x=i,j.vel_y=-k):j.x<=0.5*b&&j.y>0.5*a?(j.vel_x=-i,j.vel_y=k):j.x>0.5*b&&j.y>0.5*a&&(j.vel_x=i,j.vel_y=k);K.particlesArrayCopyForOthers.push(j)}}}this.createBurst()}},createBurst:function(){var a=new o;null==K.balloonParticles&&(K.balloonParticles=[]);for(var b=0,c=K.particlesArrayCopyForOthers;b<c.length;){var d=c[b];++b;var e;e=0<K.balloonParticles.length?K.balloonParticles.shift():new w(l.assetPack.getTexture("balloonparticle"));
var h=new o,g=new Da;g.copyFrom(d);g.x+=this.touchPointX-0.5*this.width;g.y+=this.touchPointY-0.5*this.height;var d=Math.random()*g.xSpeed,i=Math.random()*g.ySpeed+3;g.vel_x=0<g.vel_x?d:-d;g.vel_y=0<g.vel_y?i:-i;h.add(e).add(g);h._compMap.Sprite_4.x.set__(g.x);h._compMap.Sprite_4.y.set__(g.y);a.addChild(h)}j.root.addChild(a);s.nextQuestion.emit()},onUpdate:function(){0<this.startAnimAfter&&(this.startAnimAfter--,0>=this.startAnimAfter&&this.movieSprite.set_paused(!1));var a=this.owner._compMap.Sprite_4.y;
a.set__(a._value-this.speed);this.owner._compMap.Sprite_4.y._value<-this.height&&0!=this.speed&&(this.speed=0,K.balloonsPerQ--,0==function(){var a=s.nextQSignalEmitted;return 0>a?4294967296+a:a+0}(this)&&0==function(){var a=K.balloonsPerQ;return 0>a?4294967296+a:a+0}(this)&&(s.nextQSignalEmitted=1,s.nextQuestion.emit()))},addAnswer:function(a){this.answerString=a;this.owner.addChild(this.textEntity.add(this.answerSprite));this.answerSprite.set_text(a);a=i.getBounds(this.textEntity);this.answerSprite.x.set__(0.5*
-a.width);this.answerSprite.y.set__(0.5*-a.height);this.swfEntity.addChild(this.textEntity)},resetTouch:function(){this.touched=0;this.owner._compMap.Sprite_4.get_pointerDown().connect(B(this,this.handleTouch)).once()},reset:function(){this.touched=0;this.speed=this.fixedSpeed+0.5*Math.random()*this.fixedSpeed;this.owner._compMap.Sprite_4.set_visible(!0);this.startAnimAfter=100*Math.random();this.movieSprite.set_paused(!0)},__class__:K});var qa=function(){};e["urgame.Constants"]=qa;qa.__name__=!0;
var D=function(){this.changeInSpeed=0.1;this.balloonSpeed=0.75;this.livesEntity=new o;this.playerScore=this.showNextQuestion=0;r.call(this);this.init()};e["urgame.Game"]=D;D.__name__=!0;D.__super__=r;D.prototype=n(r.prototype,{get_name:function(){return"Game_0"},init:function(){this.currentLevel=1;this.background=new w(l.assetPack.getTexture("background"));j.root.addChild((new o).add(this.background));var a=2,b=2;this.operationSelectorEntity=(new o).add(new w(l.assetPack.getTexture("selectOp")));
this.operatorImages=[new ra("+",new w(l.assetPack.getTexture("plus"))),new ra("-",new w(l.assetPack.getTexture("minus"))),new ra("x",new w(l.assetPack.getTexture("multiply"))),new ra("div",new w(l.assetPack.getTexture("divide")))];for(var c=0;4>c;){var d=c++,e=this.operatorImages[d].image;e.x.set__(0.5*(j._platform.getStage().get_width()/b)+j._platform.getStage().get_width()/b*(d/2|0)-0.5*e.texture.get_width());e.y.set__(0.5*(j._platform.getStage().get_height()/a)+j._platform.getStage().get_height()/
a*(d%2)-0.5*e.texture.get_height()+qa.padding);this.operationSelectorEntity.addChild((new o).add(e))}a=3;b=5;this.levelSelectorEntity=(new o).addChild((new o).add(new w(l.assetPack.getTexture("LevelSelectBG"))));c=0;for(d=D.maxLevel;c<d;){var e=c++,h=new L;h.updateLevel(""+(e+1));this.levelSelectorEntity.addChild(h.getButton());h.setPosition(e%b*(j._platform.getStage().get_width()/b)+0.5*(j._platform.getStage().get_width()/b)-0.5*i.getBounds(h.getButton()).width,Math.floor(e/b)*(j._platform.getStage().get_height()/
a)+0.5*(j._platform.getStage().get_height()/a)-0.5*i.getBounds(h.getButton()).height)}this.questionArea=new Ea;this.scoreArea=new o;this.scoreSprite=new ca(l.font,""+y.string(function(a){a=a.playerScore;return 0>a?4294967296+a:a+0}(this)));this.gameOverEntity=new o;this.gameOverImage=new w(l.assetPack.getTexture("gameover"));this.gameOverImage.x.set__(0.5*j._platform.getStage().get_width()-0.5*this.gameOverImage.texture.get_width());this.gameOverImage.y.set__(0.5*j._platform.getStage().get_height()-
0.5*this.gameOverImage.texture.get_height());this.gameOverEntity.add(this.gameOverImage);s.startGame.connect(B(this,this.startGameLoop)).once();s.showLevel.connect(B(this,this.drawLevel)).once();s.gameOver.connect(B(this,this.endGame)).once();s.setSign.connect(B(this,this.operatorSelected)).once()},onAdded:function(){this.owner.addChild(this.operationSelectorEntity)},operatorSelected:function(a){this.owner.removeChild(this.operationSelectorEntity);D.operator=a;this.questionArea.loadQuestions()},showLevels:function(){this.owner.addChild(this.levelSelectorEntity)},
startGameLoop:function(a){this.currentLevel=y.parseInt(a);this.hideLevels();this.createLives();this.showScore();this.showQuestion();this.createBalloons()},drawLevel:function(){this.showLevels()},hideLevels:function(){this.owner.removeChild(this.levelSelectorEntity)},createLives:function(){this.lives=new kb;j.root.addChild(this.livesEntity.add(this.lives));this.lives.displayLives()},createBalloons:function(){if(null!=this.currentQuestion){this.currentAnswers=this.currentQuestion.answers;for(var a=
j._platform.getStage().get_width()/this.currentAnswers.length,b=0,c=this.currentAnswers.length;b<c;){var d=b++,e,h;if(1==function(a){a=a.showNextQuestion;return 0>a?4294967296+a:a+0}(this)&&null!=this.balloons&&0<this.balloons.length&&d<this.balloons.length)e=this.balloons[d],h=e._compMap.Balloon_1,h.reset();else{h=new K;e=(new o).add((new i).setXY(j._platform.getStage().get_width(),j._platform.getStage().get_height())).add(h);this.balloons=null==this.balloons?[]:this.balloons;this.balloons.push(e);
var g=i.getBounds(e);h.height=g.height;h.width=g.width}h.setSpeed(this.balloonSpeed+function(a){a=a.currentLevel;return 0>a?4294967296+a:a+0}(this)*this.changeInSpeed);g=e._compMap.Sprite_4;h.addAnswer(this.currentAnswers[d].toString());g.x.set__(Math.random()*(a-2*h.width)+0.5*h.width+a*d);g.y.set__(j._platform.getStage().get_height()+h.height);this.owner.addChild(e,!0)}K.balloonsPerQ=this.currentAnswers.length;this.showNextQuestion=s.nextQSignalEmitted=0;s.nextQuestion.connect(B(this,this.removeBalloons)).once();
s.checkAnswer.connect(B(this,this.checkAnswer))}},showScore:function(){var a=new w(l.assetPack.getTexture("ScoreBoard@2x"));a.scaleX.set__(a.scaleY.set__(0.25));a.x.set__(j._platform.getStage().get_width()-0.25*a.texture.get_width()-qa.padding);a.y.set__(qa.padding);this.scoreArea.addChild((new o).add(a));this.scoreSprite.set_text(""+y.string(function(a){a=a.playerScore;return 0>a?4294967296+a:a+0}(this)));this.scoreSprite.set_align(I.Center);var b=(new o).add(this.scoreSprite);this.scoreArea.addChild(b);
b=i.getBounds(b);this.scoreSprite.x.set__(a.x._value+0.125*a.texture.get_width());this.scoreSprite.y.set__(a.y._value+0.125*a.texture.get_height()-0.5*b.height);this.owner.addChild(this.scoreArea)},showQuestion:function(){this.currentQuestion=this.questionArea.displayNextQ();if(null!=this.currentQuestion)if(null==this.questionAreaEntity){this.questionAreaEntity=null==this.questionAreaEntity?new o:this.questionAreaEntity;var a=new w(l.assetPack.getTexture("QuestionBoard@2x"));a.x.set__(0.5*j._platform.getStage().get_width()-
0.5*a.texture.get_width());a.y.set__(j._platform.getStage().get_height()-a.texture.get_height());this.questionAreaEntity.add(a);this.questionEntity=new o;this.questionSprite=new ca(l.font,this.currentQuestion.question);this.questionSprite.set_align(I.Center);this.questionEntity.addChild((new o).add(this.questionSprite));this.questionSprite.x.set__(0.5*a.texture.get_width());this.questionSprite.y.set__(0.5*a.texture.get_height()-0.5*i.getBounds(this.questionEntity).height);this.questionAreaEntity.addChild(this.questionEntity);
this.owner.addChild(this.questionAreaEntity)}else this.questionSprite.set_text(this.currentQuestion.question)},removeBalloons:function(){for(var a=0,b=this.balloons.length;a<b;)this.owner.removeChild(this.balloons[a++]);this.showNextQuestion=1;this.showQuestion();this.createBalloons()},updateScore:function(){this.scoreSprite.set_text(""+y.string(function(a){a=a.playerScore;return 0>a?4294967296+a:a+0}(this)))},checkAnswer:function(){null!=D.poppedBalloon&&(D.poppedBalloon.answerString==this.currentQuestion.correctAnswer?
(this.playerScore++,0==function(a){a=a.playerScore;a=(0>a?4294967296+a:a+0)%10|0;return 0>a?4294967296+a:a+0}(this)&&function(a){var a=a.currentLevel,b=D.maxLevel,c=0>b;return c!=0>a?c:b>a}(this)&&(this.currentLevel++,null),this.updateScore(),s.popBalloon.emit(),D.poppedBalloon.resetTouch(),D.poppedBalloon=null,this.correctAnswerSound=null==this.correctAnswerSound?l.assetPack.getSound("sounds/sound"):this.correctAnswerSound,this.correctAnswerSound.play()):(this.wrongAnswerSound=null==this.wrongAnswerSound?
l.assetPack.getSound("sounds/slip"):this.wrongAnswerSound,this.wrongAnswerSound.play(),D.poppedBalloon.resetTouch(),D.poppedBalloon=null,this.lives.dropLife()));null},endGame:function(){this.owner.dispose();j.root.addChild(this.gameOverEntity)},__class__:D});var L=function(){null==L.levelDown&&(L.levelDown=new w(l.assetPack.getTexture("LevelButtonDown")));null==L.levelText&&(L.levelText=new ca(l.font));this.buttonEntity=new o;this.levelUp=new w(l.assetPack.getTexture("LevelButtonUp"));this.buttonEntity.add(this.levelUp);
this.levelTextEntity=new o;L.levelText=new ca(l.font);L.levelText.set_align(I.Center);this.buttonEntity.addChild(this.levelTextEntity.add(L.levelText));this.downEntity=(new o).add(L.levelDown);this.buttonEntity._compMap.Sprite_4.get_pointerDown().connect(B(this,this.handleTouchDown)).once();this.buttonEntity._compMap.Sprite_4.get_pointerUp().connect(B(this,this.handleTouchUp)).once()};e["urgame.LevelItem"]=L;L.__name__=!0;L.prototype={setPosition:function(a,b){this.levelUp.x.set__(a);this.levelUp.y.set__(b)},
updateLevel:function(a){L.levelText.set_text(this.level=a);L.levelText.set_align(I.Center);L.levelText.x.set__(0.25*-i.getBounds(this.levelTextEntity).width+this.levelUp.x._value+0.5*this.levelUp.texture.get_width());L.levelText.y.set__(0.5*-i.getBounds(this.levelTextEntity).height+this.levelUp.y._value+0.5*this.levelUp.texture.get_height())},handleTouchDown:function(){this.buttonEntity.addChild(this.downEntity);s.startGame.emit(this.level)},handleTouchUp:function(){this.buttonEntity.removeChild(this.downEntity);
L.levelText.set_text("")},getButton:function(){return this.buttonEntity},__class__:L};var kb=function(){this.acc_y=0.2;this.speed=[];this.livesArray=[];this.numberOfLives=5;r.call(this)};e["urgame.Lives"]=kb;kb.__name__=!0;kb.__super__=r;kb.prototype=n(r.prototype,{get_name:function(){return"Lives_6"},displayLives:function(){this.currentLife=0;this.container=new o;for(var a=0,b=this.numberOfLives;a<b;){var c=a++;this.speed[c]=0.5;var d=new w(l.assetPack.getTexture("TamamaSmall@2x"));d.scaleX.set__(d.scaleY.set__(0.25));
d.x.set__(function(a){var b=d.texture.get_width(),a=(a.numberOfLives-c-1)*b;return 0.25*(0>a?4294967296+a:a+0)}(this)+qa.padding);d.y.set__(qa.padding);this.livesArray.push(d);this.owner.addChild((new o).add(d))}},dropLife:function(){this.speed[this.currentLife++]=0.5;(function(a){a=a.currentLife;return 0>a?4294967296+a:a+0})(this)==function(a){a=a.numberOfLives;return 0>a?4294967296+a:a+0}(this)&&s.gameOver.emit()},onAdded:function(){},onUpdate:function(){for(var a=0,b=this.currentLife;a<b;){var c=
a++,d=this.livesArray[c].y;d.set__(d._value+this.speed[c]);this.speed[c]+=this.acc_y}},__class__:kb});var l=function(){};e["urgame.Main"]=l;l.__name__=!0;l.main=function(){j.init();var a=new o;a.add(new va(16777215,j._platform.getStage().get_width(),2));a._compMap.Sprite_4.x.set__(0);a._compMap.Sprite_4.y.set__(0.5*j._platform.getStage().get_height()-0.5*i.getBounds(a).height);j.root.addChild(a);var b=N.fromAssets("bootstrap"),c=j._platform.loadAssetPack(b);c.progressChanged.connect(function(){a.add(new va(255,
c._progress/c._total*j._platform.getStage().get_width(),2));a._compMap.Sprite_4.x.set__(0);a._compMap.Sprite_4.y.set__(0.5*j._platform.getStage().get_height()-0.5*i.getBounds(a).height)});c.get(l.onSuccess)};l.onSuccess=function(a){l.assetPack=a;l.font=new ma(l.assetPack,"fonts/Arial");l.init()};l.init=function(){l.gameBehaviour=new D;l.game=new o;l.game.add(l.gameBehaviour);j.root.addChild(l.game)};var ra=function(a,b){this.operation=a;this.image=b;this.image.get_pointerDown().connect(B(this,this.operatorSelected))};
e["urgame.Operator"]=ra;ra.__name__=!0;ra.prototype={operatorSelected:function(){s.setSign.emit(this.operation)},__class__:ra};var Da=function(){this.gravity=0.5;this.ySpeed=7;this.xSpeed=5;r.call(this)};e["urgame.Particle"]=Da;Da.__name__=!0;Da.__super__=r;Da.prototype=n(r.prototype,{get_name:function(){return"Particle_2"},copyFrom:function(a){this.x=a.x;this.y=a.y;this.vel_x=a.vel_x;this.vel_y=a.vel_y;this.acc_x=a.acc_x;this.acc_y=a.acc_y;this.rotation=a.rotation;this.stopMoving=0},onAdded:function(){this.sprite=
this.owner._compMap.Sprite_4},onUpdate:function(){var a=this.stopMoving;if(0==(0>a?4294967296+a:a+0))this.sprite.x._value>j._platform.getStage().get_width()||this.sprite.y._value>j._platform.getStage().get_height()?(this.stopMoving=1,K.balloonParticles.push(y.instance(this.owner._compMap.Sprite_4,w)),j.root.removeChild(this.owner)):(a=this.sprite.x,a.set__(a._value+this.vel_x),a=this.sprite.y,a.set__(a._value+this.vel_y),this.vel_x+=this.acc_x,this.vel_y+=this.acc_y)},__class__:Da});var Jb=function(){};
e["urgame.Question"]=Jb;Jb.__name__=!0;Jb.prototype={__class__:Jb};var Ea=function(){this.fileName=1;this.questionIndex=0};e["urgame.QuestionArea"]=Ea;Ea.__name__=!0;Ea.prototype={loadQuestions:function(){var a=N.fromAssets("JSON");j._platform.loadAssetPack(a).get(B(this,this.onSuccess))},onSuccess:function(a){Ea.questionPack=a;this.getQuestions();s.showLevel.emit()},getQuestions:function(){this.allQuestions=JSON.parse(Ea.questionPack.getFile("Op"+D.operator+"/"+this.fileName+".json").toString());
this.createQuestions()},createQuestions:function(){this.questions=null==this.questions?[]:this.questions;for(var a=0,b=this.allQuestions.length;a<b;){var c=a++,d=new Jb;d.question=this.allQuestions[c].question;d.correctAnswer=this.allQuestions[c].correct;d.answers=[];for(var e=0,h=this.allQuestions[c].answers.length;e<h;){var g=e++;d.answers.push(this.allQuestions[c].answers[g])}this.questions.push(d)}},displayNextQ:function(){if(function(a){var b=a.questionIndex,a=a.questions.length,c=0>a;return c!=
0>b?c:a>b}(this))return this.questions[this.questionIndex++];return function(a){var a=a.fileName,b=D.maxLevel,c=0>b;return c!=0>a?c:b>a}(this)?(this.fileName++,this.getQuestions(),this.questions[this.questionIndex++]):null},__class__:Ea};var s=function(){};e["urgame.Signals"]=s;s.__name__=!0;var $b=0;Math.NaN=Number.NaN;Math.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY;Math.POSITIVE_INFINITY=Number.POSITIVE_INFINITY;e.Math=Math;Math.isFinite=function(a){return isFinite(a)};Math.isNaN=function(a){return isNaN(a)};
String.prototype.__class__=e.String=String;String.__name__=!0;e.Array=Array;Array.__name__=!0;Date.prototype.__class__=e.Date=Date;Date.__name__=["Date"];var ac=e.Int={__name__:["Int"]},bc=e.Dynamic={__name__:["Dynamic"]},Yb=e.Float=Number;Yb.__name__=["Float"];var Zb=e.Bool=Boolean;Zb.__ename__=["Bool"];var cc=e.Class={__name__:["Class"]},dc={};aa.instance=new aa;z.DISPATCHING_SENTINEL=new ka(null,null);j.root=new o;j.uncaughtError=new t;j.hidden=new H(!1);j.volume=new v(1);j._platform=aa.instance;
j._calledInit=!1;N.__meta__={obj:{assets:[{JSON:[{bytes:573,md5:"92842153662dd6aaad8be2532ec00368",name:"Op+/1.json"},{bytes:671,md5:"1bf1f5e423802de5ff18ec986379a0ec",name:"Op+/10.json"},{bytes:695,md5:"a8ced97c593e2b9cb2add8f8c675dc1d",name:"Op+/11.json"},{bytes:687,md5:"98ae5000a1ac4fa5e7dbfa649ff64c2e",name:"Op+/12.json"},{bytes:691,md5:"8b08fbe88088787dfb017b5fbc4f3c84",name:"Op+/13.json"},{bytes:695,md5:"4207478b4efe85ecf778b18b5de6c54c",name:"Op+/14.json"},{bytes:695,md5:"6d68be928b7bf420479f948cdcfd41f5",
name:"Op+/15.json"},{bytes:616,md5:"e6e50bd9cb93ae92d8b14882452e92df",name:"Op+/2.json"},{bytes:622,md5:"2867b04fae5d291da6399ee6d5063251",name:"Op+/3.json"},{bytes:613,md5:"ec01bb077a825271cade278c2883886d",name:"Op+/4.json"},{bytes:614,md5:"c0b09273d78a9fde20c669a18355d614",name:"Op+/5.json"},{bytes:657,md5:"8d0993c99fb30b9e26ca9bbfa5058a84",name:"Op+/6.json"},{bytes:671,md5:"4dad79fc6ec0949e810191b605bf480c",name:"Op+/7.json"},{bytes:671,md5:"7773f1fae6df71aaed48f5de458da70e",name:"Op+/8.json"},
{bytes:679,md5:"b18d113209d3d97579e5649402431fd3",name:"Op+/9.json"},{bytes:569,md5:"b491cc2b0a1c62186fd09bedecb3a85c",name:"Op-/1.json"},{bytes:607,md5:"adfcd95bd0b1d92ea017d72a5645cd49",name:"Op-/10.json"},{bytes:608,md5:"2414ed99c863c4ebc119bccbc823ff57",name:"Op-/11.json"},{bytes:608,md5:"e0fcc2ad0c0e2dd6a37a89255ed73931",name:"Op-/12.json"},{bytes:611,md5:"0d999fad6b8e970c08d547ed64ea5331",name:"Op-/13.json"},{bytes:618,md5:"38e300f9dbaaa1e17447846ed96d4be4",name:"Op-/14.json"},{bytes:612,md5:"0fac65a052d5c4d28d482dd64e1e935f",
name:"Op-/15.json"},{bytes:596,md5:"e8af311b60f6c789f5289242b14f98ee",name:"Op-/2.json"},{bytes:585,md5:"7686c9cf8632480bb201b16d3161279b",name:"Op-/3.json"},{bytes:587,md5:"f431884f7951891ac3f939a96ed90e97",name:"Op-/4.json"},{bytes:596,md5:"ffa2ec7e8218b7b39baa0b70826bca41",name:"Op-/5.json"},{bytes:577,md5:"64281588859219f4f62682a45a12420d",name:"Op-/6.json"},{bytes:590,md5:"7c859b31883e074919391fa9e4d7b87b",name:"Op-/7.json"},{bytes:594,md5:"d75b58b4e8fdacbcc072ebb3692be987",name:"Op-/8.json"},
{bytes:602,md5:"ef1792033a5cfeeb29d0e73c487c44f6",name:"Op-/9.json"},{bytes:584,md5:"db76375401f47230bde9e6ac27959b1b",name:"Opdiv/1.json"},{bytes:584,md5:"7a20d402e7aa98dad43145501b0c4824",name:"Opdiv/10.json"},{bytes:583,md5:"030b3332504a2591c38e0cf1b0f29fdf",name:"Opdiv/11.json"},{bytes:589,md5:"6f68f8b12c3acc2c51418c3407929495",name:"Opdiv/12.json"},{bytes:585,md5:"15167e30b6103638fecbc76fe583969f",name:"Opdiv/13.json"},{bytes:586,md5:"e21c2b9c3d2aaf4470126ee9027500ce",name:"Opdiv/14.json"},{bytes:581,
md5:"f5920d4718a94706419ad01f32d80b43",name:"Opdiv/15.json"},{bytes:579,md5:"b95b1db65b36438938b21efb76e7ec7b",name:"Opdiv/2.json"},{bytes:586,md5:"99bb9345ab5b2ce0c60afe0722e4c42f",name:"Opdiv/3.json"},{bytes:581,md5:"5215132abeda879ceddb515b1b791aab",name:"Opdiv/4.json"},{bytes:582,md5:"3ec39d9367cbb67d76d7bed957461b86",name:"Opdiv/5.json"},{bytes:586,md5:"7562371d82a35762da498d52d164c473",name:"Opdiv/6.json"},{bytes:585,md5:"13f7041d7734c7501a71282f4aa6ff11",name:"Opdiv/7.json"},{bytes:588,md5:"604c1d3092f192ea4286bb94ef9adc95",
name:"Opdiv/8.json"},{bytes:581,md5:"e80d716ec9cf37c9c295347f63925b46",name:"Opdiv/9.json"},{bytes:596,md5:"caa7dd3b14047f1ef1711f75a97295c4",name:"Opx/1.json"},{bytes:675,md5:"c358a553a17941409570329b1a89c835",name:"Opx/10.json"},{bytes:667,md5:"5ad876403d6c66f751320e34ea2a1e25",name:"Opx/11.json"},{bytes:671,md5:"d1bc2e4491065ab713f60b2a3c7ed0e0",name:"Opx/12.json"},{bytes:667,md5:"811e7409297d0f72ec90ab49cfc2c451",name:"Opx/13.json"},{bytes:667,md5:"f88a18121ad82520c2faa0ac2ddb55ae",name:"Opx/14.json"},
{bytes:671,md5:"a1b29a11080062ab017cf59a11eed22f",name:"Opx/15.json"},{bytes:604,md5:"acae7e6b77950aeb6b6c40ef02fac582",name:"Opx/2.json"},{bytes:611,md5:"6dc7dbc6abb2ec840995f36cf57316d7",name:"Opx/3.json"},{bytes:635,md5:"4739fe6aacb45e2c81acc12304c2debb",name:"Opx/4.json"},{bytes:660,md5:"2e4f89d19cec7fe89ac174b6009644b4",name:"Opx/5.json"},{bytes:677,md5:"fdd00c72aaf9e5185507277e058357eb",name:"Opx/6.json"},{bytes:671,md5:"5a2841554658c7a9943430c3a1ead6e6",name:"Opx/7.json"},{bytes:675,md5:"7624dff64e7a0b6059d9227650650370",
name:"Opx/8.json"},{bytes:671,md5:"b2443403ce5ec5bd7e08b1974c446459",name:"Opx/9.json"}],bootstrap:[{bytes:174759,md5:"0d9b2688c0519c631582fed77694938c",name:"background.png"},{bytes:14362,md5:"e1596bccd504f6c6a78888500ba6ffbb",name:"balloon.png"},{bytes:2797,md5:"a50625a21376f53b87e52b128aa96d4c",name:"balloonparticle.png"},{bytes:14821,md5:"c501b67d6ac761a60eeba5b8e80ef7c4",name:"BaloonAnim/atlas0.png"},{bytes:22686,md5:"d4f2560824c38a30982d4f8d7bf2593e",name:"BaloonAnim/library.json"},{bytes:32,
md5:"84e2cc9cd070375d953c0bcf19696cc1",name:"BaloonAnim/md5"},{bytes:1,md5:"003d62073d0b493a14427a45413fc595",name:"BaloonAnim/version"},{bytes:7701,md5:"519b3c48412a582296c9076f874a1d83",name:"BaloonAnim.assets/images/Bitmap 1.png.png"},{bytes:1588,md5:"16ab12f694c973d8db16ec8f888ee65b",name:"divide.png"},{bytes:744,md5:"abe48661625426bc379b115b1b1c163f",name:"fonts/Arial.bmfc"},{bytes:62781,md5:"a846e319f4a9656b1e1c364e100d9878",name:"fonts/Arial.fnt"},{bytes:51674,md5:"c8c5ade18141e62cd89a7a7df421bf07",
name:"fonts/Arial_0.png"},{bytes:7701,md5:"519b3c48412a582296c9076f874a1d83",name:"gameover.png"},{bytes:6225,md5:"c49af1eec5af7129d0dc037ecb0f8684",name:"LevelButtonDown.png"},{bytes:4280,md5:"1dafd479245c82ce6a71a82e67b3a6b4",name:"LevelButtonUp.png"},{bytes:5085,md5:"086dce3cac319d1f33b725967ac1a431",name:"LevelSelectBG.png"},{bytes:177,md5:"34aa952e523de26afaf946fb86b11e58",name:"minus.png"},{bytes:1598,md5:"c087f156485a65886030c0effa6bb3c3",name:"multiply.png"},{bytes:552,md5:"9193714cd7db458ab094f67e0d92f376",
name:"plus.png"},{bytes:10428,md5:"644e80c0ef3c9f60d786f503caea8b89",name:"QuestionBoard@2x.png"},{bytes:11621,md5:"efe0b06b7ab09b2aba72c9f3188fe2c7",name:"ScoreBoard@2x.png"},{bytes:5664,md5:"7bbb77bc85faa4162a4994f1acf86565",name:"selectOp.png"},{bytes:11572,md5:"02f99231f1b810e18a11a879da857ef9",name:"sounds/slip.wav"},{bytes:22478,md5:"b08f472c1455045ac1c20711a7d5ab6a",name:"sounds/sound.wav"},{bytes:17674,md5:"545dcca886b73d01fad95ef4256883e5",name:"TamamaSmall@2x.png"}]}]}};N._supportsCrossOrigin=
function(){var a;a=0<=window.navigator.userAgent.indexOf("Linux; U; Android")?!1:null!=(new XMLHttpRequest).withCredentials;a||null;return a}();i._scratchPoint=new Oa;ma.NEWLINE=new Pa(10);P._sharedEvent=new tb;F._sharedEvent=new ub;ja.CANVAS_TEXTURES=(new $("(iPhone|iPod|iPad)","")).match(window.navigator.userAgent);p._mediaRefCount=0;p._detectBlobSupport=!0;k.VENDOR_PREFIXES=["webkit","moz","ms","o","khtml"];k.SHOULD_HIDE_MOBILE_BROWSER=window.top==window&&(new $("Mobile(/.*)? Safari","")).match(window.navigator.userAgent);
q._detectSupport=!0;S._scratchMatrix=new T;qa.padding=10;D.maxLevel=15;s.showLevel=new X;s.gameOver=new X;s.checkAnswer=new X;s.popBalloon=new X;s.startGame=new t;s.setSign=new t;s.nextQuestion=new X;s.nextQSignalEmitted=0;l.main()})();
